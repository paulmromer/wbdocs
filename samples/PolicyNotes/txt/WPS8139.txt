                                                  WPS8139


Policy Research Working Paper                    8139




            Distributional Impact Analysis
               Toolkit and Illustrations of Impacts
              Beyond the Average Treatment Effect

                             Guadalupe Bedoya
                              Luca Bittarello
                              Jonathan Davis
                              Nikolas Mittag




Development Research Group
Impact Evaluation Team
July 2017
Policy Research Working Paper 8139


  Abstract
  Program evaluations often focus on average treatment effects.                      distributions and estimation of the distribution of treatment
  However, average treatment effects miss important aspects                          impacts. The article then discusses extensions to condi-
  of policy evaluation, such as the impact on inequality and                         tional treatment effect heterogeneity, that is, to analyses of
  whether treatment harms some individuals. A growing liter-                         how treatment impacts vary with observed characteristics.
  ature develops methods to evaluate such issues by examining                        The paper offers advice on inference, testing, and power
  the distributional impacts of programs and policies. This                          calculations, which are important when implementing dis-
  toolkit reviews methods to do so, focus-ing on their applica-                      tributional analyses in practice. Finally, the paper illustrates
  tion to randomized control trials. The paper emphasizes two                        select methods using data from two randomized evaluations.
  strands of the literature: estimation of impacts on outcome




  This paper is a product of the Impact Evaluation Team, Development Research Group. It is part of a larger effort by the
  World Bank to provide open access to its research and make a contribution to development policy discussions around the
  world. Policy Research Working Papers are also posted on the Web at http://econ.worldbank.org. The authors may be
  contacted at gbedoya@worldbank.org.




          The Policy Research Working Paper Series disseminates the findings of work in progress to encourage the exchange of ideas about development
          issues. An objective of the series is to get the findings out quickly, even if the presentations are less than fully polished. The papers carry the
          names of the authors and should be cited accordingly. The findings, interpretations, and conclusions expressed in this paper are entirely those
          of the authors. They do not necessarily represent the views of the International Bank for Reconstruction and Development/World Bank and
          its affiliated organizations, or those of the Executive Directors of the World Bank or the governments they represent.


                                                        Produced by the Research Support Team
          Distribuï¿½onal Impact Analysis: Toolkit and Illustraï¿½ons
             of Impacts Beyond the Average Treatment Eï¬€ect


                                  Guadalupe Bedoya (World Bank)
                              Luca Bitarello (Northwestern University)
                               Jonathan Davis (University of Chicago)
                                     Nikolas Mitag (CERGE-EI) *


                                           Advisors:
                           StÃ©phane Bonhomme (University of Chicago)
                                      Sergio Firpo (Insper)




Keywords: Policy Evaluaï¿½on, Distribuï¿½onal Impact Analysis, Heterogeneous Treatment Eï¬€ects, Im-
pacts on Outcome Distribuï¿½ons, Distribuï¿½on of Treatment Eï¬€ects, Random Control Trials.

JEL codes: C18, C21, C54, C93, D39



* We beneï¬ted from the generous advice of Joel L. Horowitz and Andreas Menzel. We thank Arianna Legovini,
David Evans, and Caio Piza for making this toolkit possible. We are grateful to Moussa P. Blimpo and parï¿½ci-
pants at the DIME seminar and the Course on Distribuï¿½onal Impact Analysis held at the World Bank. We also
beneï¬ted from the work and data from â€œThe Impact of High School Financial Educaï¿½on: Experimental Evidence
from Brazilâ€ and â€œParental Human Capital and Eï¬€ecï¿½ve School Management: Evidence from the Gambiaâ€ and
from conversaï¿½ons with members of both teams. We thank Kristoï¬€er BjÃ¤rkefur for assistance with program-
ming. This work was generously supported by the Africa Poverty and Social Impact Analysis (PSIA) and the Im-
pact Evaluaï¿½on to Development Impact (i2i) Trust Funds.
Contents

1.      INTRODUCTION ........................................................................................................... 2
2.     QUESTIONS OF INTEREST AND DEFINITIONS ................................................................ 4
     1. Deï¬niï¿½ons and Notaï¿½on ................................................................................................. 4
     2. Two Uncondiï¿½onal Approaches ...................................................................................... 5
     3. From Uncondiï¿½onal to Condiï¿½onal Analysis ................................................................... 8
3.     IMPACT ON OUTCOME DISTRIBUTIONS ....................................................................... 9
     1. Introducï¿½on ..................................................................................................................... 9
     2. Randomized Control Trials Without Endogenous Selecï¿½on ......................................... 10
     3. Applicaï¿½ons with Selecï¿½on on Observables: Inverse Probability Weighï¿½ng................ 11
     4. Applicaï¿½ons with Selecï¿½on on Unobservables: Instrumental Variables ...................... 12
     5. Interpreï¿½ng Quanï¿½le Eï¬€ects ......................................................................................... 14
4.     DISTRIBUTION OF TREATMENT IMPACTS ................................................................... 15
     1. Introducï¿½on ................................................................................................................... 15
     2. Bounding the Distribuï¿½on of Treatment Eï¬€ects ........................................................... 17
     3. Point Idenï¿½ï¬caï¿½on of Features of the Distribuï¿½on of Treatment Eï¬€ects ..................... 20
     4. Esï¿½maï¿½on Methods ...................................................................................................... 24
5.     DISTRIBUTIONAL IMPACTS AND CONDITIONAL ANALYSES ......................................... 31
     1. Introducï¿½on ................................................................................................................... 31
     2. Subgroup Analysis ......................................................................................................... 32
     3. Condiï¿½onal Average Treatment Eï¬€ects ......................................................................... 33
6.     STATISTICAL INFERENCE AND POWER CALCULATIONS ................................................ 35
     1. Introducï¿½on ................................................................................................................... 35
     2. Staï¿½sï¿½cal Inference ....................................................................................................... 36
     3. Tests of Heterogeneous Treatment Eï¬€ects ................................................................... 40
     4. Power Calculaï¿½ons ........................................................................................................ 41
7.     APPLICATIONS ........................................................................................................... 43
     1. Financial Educaï¿½on RCT in Brazil ................................................................................... 44
     2. School Management RCT in The Gambia ...................................................................... 52
REFERENCES ..................................................................................................................... 59
APPENDIX 1. SIMULATION DETAILS ................................................................................... 62
APPENDIX 2. ESTIMATING CONDITIONAL PROBABILITIES.................................................. 63
APPENDIX 3. RECURSIVELY SOLVING FOR HIGHER ORDER MOMENTS ............................... 64
APPENDIX 4. ADDITIONAL RESULTS FROM APPLICATIONS ................................................ 66
1. Introducï¿½on
Tradiï¿½onal methods to evaluate the impacts of social programs and the vast majority of ap-
plied econometric policy evaluaï¿½ons focus on the analysis of means (Carneiro, Hansen and
Heckman, 2002; Angrist and Pischke, 2009). However, there is also a large and growing liter-
ature on methods to evaluate the eï¬€ects of programs and policies beyond their mean im-
pact. While less frequently applied, these methods can provide informaï¿½on that is valuable
or even necessary in the assessment of the consequences of policies and their desirability.
The purpose of this toolkit is to provide an overview of the quesï¿½ons such methods can ad-
dress and the core approaches that have been developed to answer them, including discus-
sions of the assumpï¿½ons they require, and pracï¿½cal issues in their implementaï¿½on.
     Mean impacts are a natural ï¬rst summary staï¿½sï¿½c to describe the eï¬€ect of a policy. The
mean impact of a policy or intervenï¿½on tells us by how much the outcome would increase
or decrease on average when every member of a parï¿½cular populaï¿½on is exposed to the pol-
icy or intervenï¿½on. Thereby, they provide the central piece in any cost-beneï¬t analysis.
However, a decision-maker usually requires informaï¿½on on the eï¬€ects of a policy beyond its
mean impact. For example, mean impacts allow us to calculate the total gain from a program
or policy, but do not allow us to say anything about the distribuï¿½on of the gain or how the
outcome distribuï¿½on is aï¬€ected by the program beyond changes in its mean. A posiï¿½ve av-
erage program eï¬€ect tells us that a program can generate social surplus, but it may not be
suï¬ƒcient to allow us to judge whether the program is desirable or not if any weight is placed
on distribuï¿½onal concerns, such as whether inequality is aï¬€ected by the program, whether
some people are harmed by the policy or whether a parï¿½cular demographic group beneï¬ts.
     Even a purely welfare-maximizing social planner with no normaï¿½ve concerns for parï¿½cu-
lar demographic groups, inequality or not harming anyone will oï¿½en need informaï¿½on on
program impacts beyond their average. For example, judging a program by its mean impact
assumes that the welfare consequences of the distribuï¿½onal aspects of programs are either
unimportant or are oï¬€set by transfers. As Heckman, Smith and Clements (1997) argue, this
assumpï¿½on is strong. Many outcomes, such as educaï¿½onal atainment and health status,
cannot feasibly be redistributed themselves. In order to redistribute the welfare gains de-
rived from such outcomes, one needs to know the relaï¿½on between the outcomes and indi-
vidual uï¿½lity, which can usually at best be approximated. In pracï¿½ce, transfers may be costly
and implemenï¿½ng the opï¿½mal transfer scheme requires some knowledge of the distribuï¿½on
of gains and losses, i.e., an evaluaï¿½on that goes beyond the mean impact. Finally, some in-
tervenï¿½ons may work well for parï¿½cular subgroups of the target populaï¿½on, such as those
living in urban areas, while there may be beter opï¿½ons for rural populaï¿½ons. Knowing which
groups beneï¬t more or less can help improve the targeï¿½ng of policies and programs and
thereby help allocate limited resources more eï¬€ecï¿½vely.
     The common theme of these issues is that they cannot be addressed by mean impacts
alone. Finding answers requires thinking about the impact of a program or policy as a col-
lecï¿½on of distribuï¿½onal parameters rather than a single scalar parameter such as the mean.
Hence, we refer to these types of analyses as â€œdistribuï¿½onal impact analysisâ€ (DIA). DIA con-
cerns the study of the distribuï¿½onal consequences of intervenï¿½ons due to parï¿½cipantsâ€™ het-
erogeneous responses or parï¿½cipaï¿½on decisions. In parï¿½cular, DIA invesï¿½gates features be-
yond the gross total gain of a program by studying where the gains/losses of a program â€“ if
any â€“ were produced, and who wins or loses as a result of program parï¿½cipaï¿½on. The goal of
this toolkit is to provide guidance for researchers who want to use RCTs to answer quesï¿½ons
                                                                                                2
for which the mean is insuï¬ƒcient as an answer. We focus on RCTs because they allow us to
simplify the exposiï¿½on of the methods through the use of randomizaï¿½on as a staï¿½sï¿½cal so-
luï¿½on to the selecï¿½on problems that are central to impact evaluaï¿½on. Subject to addressing
these selecï¿½on problems, the methods we discuss are applicable to non-experimental anal-
yses as well. 1
     In this toolkit, we study two related approaches to distribuï¿½onal impact analysis. The
ï¬rst approach examines a policyâ€™s impact on the outcome distributions. It concerns diï¬€er-
ences between (staï¿½sï¿½cs of) the distribuï¿½on of outcomes with the policy and the distribu-
ï¿½on of outcomes without it, such as the impact of a policy on the variance or a speciï¬c
quanï¿½le of the outcome distribuï¿½on. The second approach is to examine the distribution of
treatment impacts. This approach answers quesï¿½ons such as what fracï¿½on of the populaï¿½on
is harmed by the policy or what the botom quarï¿½le of the impact of a policy is. It requires
(staï¿½sï¿½cs of) the distribuï¿½on of the policy gains or losses, i.e., the distribuï¿½on of diï¬€erences
between the outcomes of a given individual with the policy and without it. What disï¿½n-
guishes these two approaches is that the ï¬rst focuses on how the intervenï¿½on aï¬€ects the
distribuï¿½on of the outcome in the populaï¿½on (e.g., how would the botom quinï¿½le of ï¬nan-
cial literacy test scores change if we were to provide training on ï¬nancial literacy for the en-
ï¿½re populaï¿½on), but disregards how any parï¿½cular individual is aï¬€ected by the program. The
goal of the second approach is to analyze the distribuï¿½on of these individual treatment
eï¬€ects (e.g., how individual gains from ï¬nancial literacy training vary in the populaï¿½on). Due
to this addiï¿½onal ambiï¿½on, the second approach requires stronger assumpï¿½ons for idenï¿½ï¬-
caï¿½on and esï¿½maï¿½on.
     To simplify the exposiï¿½on, we focus on quesï¿½ons concerning uncondiï¿½onal distribuï¿½onal
impact parameters ï¬rst. That is, we start by discussing quesï¿½ons regarding treatment eï¬€ect
heterogeneity in the enï¿½re populaï¿½on and only introduce addiï¿½onal covariates to make the
underlying assumpï¿½ons hold. In pracï¿½ce, one may also be interested in how treatment im-
pacts diï¬€er between observable sub-populaï¿½ons such as males and females, or how they
vary with conï¿½nuous covariates such as age or income. Therefore, we then review ways to
extend the methods of both approaches to also allow for heterogeneity within observed
subpopulaï¿½ons or along conï¿½nuous covariates. This allows us to answer quesï¿½ons such as
whether men or women are more likely to beneï¬t from a program or whether program im-
pacts are increasing in the baseline outcome. Such condiï¿½onal analyses usually require ad-
diï¿½onal assumpï¿½ons and (oï¿½en substanï¿½ally) larger samples. If this makes them infeasible,
condiï¿½onal means are usually simple to esï¿½mate and can sï¿½ll be informaï¿½ve about hetero-
geneity.
     The beneï¬ts of DIA outlined above beg the quesï¿½on why we do not see more of these
methods applied in pracï¿½ce. Recent studies that esï¿½mate distribuï¿½onal impacts have exam-
ined earnings and employment (e.g., Abadie, Angrist and Imbens, 2002; Lechner, 1999),
safety net programs (e.g., Black et al., 2003; Bitler, Gelbach and Hoynes, 2006), social exper-
iments (e.g., Djebbari and Smith, 2008; Firpo 2007; Heckman, Smith and Clements, 1997)
and educaï¿½on (e.g., Carneiro, Hansen and Heckman, 2003; Cunha, Heckman and Schennach,
2010). However, the literature is sï¿½ll nascent compared to the importance of the topic and
the tools available. There are oï¿½en good reasons to focus primarily on mean impact and the
moï¿½ves to not look beyond it depend on the applicaï¿½on. For example, DIA usually requires


1
 See, among others, the overviews in Chernozhukov and Hansen (2013), Heckman and Vytlacil (2007) and Ab-
bring and Heckman (2007).
                                                                                                           3
larger sample sizes, and many of the methods below are jusï¿½ï¬ed asymptoï¿½cally and are not
necessarily unbiased in ï¬nite samples, which can be problemaï¿½c in applicaï¿½ons with small
samples such as most RCTs. Some methods rely on addiï¿½onal assumpï¿½ons that are reasona-
ble in some applicaï¿½ons, but not in others. However, part of the hesitaï¿½on to apply these
methods also seems to stem from inerï¿½a and the fact that they are relaï¿½vely new or have
only recently become computaï¿½onally feasible. Inerï¿½a may be an obstacle if researchers or
their audiences are more used to and hence comfortable interpreï¿½ng mean impacts and the
condiï¿½ons under which they are valid. To miï¿½gate these issues, we review the pracï¿½cal con-
sideraï¿½ons of staï¿½sï¿½cal inference and power calculaï¿½ons for DIA. Finally, we illustrate select
DIA methods and what can be learned from them by re-analyzing the impacts of a ï¬nancial
literacy program in Brazil and a school management program in The Gambia.
     We focus on the types of quesï¿½ons introduced in the previous paragraphs, but there are
many other parameters of interest, and quesï¿½ons that go beyond mean impacts. The meth-
ods and quesï¿½ons we discuss are not meant to be exhausï¿½ve, but are a selecï¿½on to illustrate
how they can complement analyses of means in assessing the value or desirability of a policy
or program. We intend to provide a set of baseline methods, to discuss common problems
and how to detect them, and to shed light on pracï¿½cal issues such as required sample sizes
and esï¿½maï¿½on of standard errors in (potenï¿½ally dependent) samples. Programs to imple-
ment the methods are available online. 2
     This paper is organized as follows. Part 2 introduces notaï¿½on and disï¿½nguishes the types
of DIA quesï¿½ons we examine: We ï¬rst introduce uncondiï¿½onal analyses of impacts on out-
come distribuï¿½ons and the distribuï¿½on of treatment eï¬€ects. We then point out how these
two approaches extend to quesï¿½ons of condiï¿½onal heterogeneity. Next, we discuss key
methods for each approach. Part 3 considers quesï¿½ons on the impact on outcome distribu-
ï¿½ons. Part 4 considers quesï¿½ons on the distribuï¿½on of treatment eï¬€ects. Part 5 considers
condiï¿½onal analyses to answer quesï¿½ons of how treatment impacts diï¬€er with observables.
Part 6 considers pracï¿½cal consideraï¿½ons for RCTs related to staï¿½sï¿½cal inference and power
calculaï¿½ons. Part 7 presents our applicaï¿½ons.

2. Quesï¿½ons of Interest and Deï¬niï¿½ons
In this part, we introduce notaï¿½on and discuss the similariï¿½es and diï¬€erences between the
two main approaches, impact on the outcome distributions and distribution of treatment
impacts. We then discuss quesï¿½ons that require each approach to be extended to condi-
ï¿½onal analyses. Unless stated otherwise, we consider an RCT with full compliance with
treatment assignment to illustrate each method without concerns about selecï¿½on issues. 3

1. Deï¬niï¿½ons and Notaï¿½on

Suppose we have a sample of í µí±í µí± observaï¿½ons, indexed by í µí±–í µí±– . The sample is randomized into a
treatment group (which received the policy of interest) and a control group (which did not).
The indicator variable í µí±…í µí±… denotes treatment assignment: í µí±…í µí±…í µí±–í µí±– = 0 if observaï¿½on í µí±–í µí±– belongs to
the control group and í µí±…í µí±…í µí±–í µí±– = 1 otherwise. We focus on binary policies to simplify the exposi-

2
 The codes can be found at htps://github.com/worldbank/DIA-toolkit
3
 Technically, this requires treatment status to be independent of counterfactual outcomes; full compliance is
neither necessary nor suï¬ƒcient for independence.
                                                                                                                4
ï¿½on, although most methods in this toolkit extend to more complex intervenï¿½ons. The indi-
cator variable í µí±‡í µí±‡ denotes treatment parï¿½cipaï¿½on: í µí±‡í µí±‡í µí±–í µí±– = 0 if observaï¿½on í µí±–í µí±– did not receive the
treatment and í µí±‡í µí±‡í µí±–í µí±– = 1 otherwise. Full compliance with treatment assignment implies that
everyone in the treatment group parï¿½cipates and no one in the control group parï¿½cipates,
so í µí±‡í µí±‡ = í µí±…í µí±….
     We assume that outcomes are conï¿½nuous. 4 We write í µí±Œí µí±Œ0 for potenï¿½al outcomes without
treatment, with cumulaï¿½ve distribuï¿½on funcï¿½on í µí°¹í µí°¹0 and í µí¼í µí¼-th quanï¿½le í µí±í µí±0 (í µí¼í µí¼). Potenï¿½al out-
comes under treatment are í µí±Œí µí±Œ1 , with CDF í µí°¹í µí°¹1 and í µí¼í µí¼-th quanï¿½le í µí±í µí±1 (í µí¼í µí¼). 5 Each of these potenï¿½al
outcomes is deï¬ned for all individuals, regardless of their treatment status, which allows us
to precisely deï¬ne counterfactuals such as í µí°¹í µí°¹0 ( í µí±¦í µí±¦ âˆ£ í µí±‡í µí±‡ = 1 ), the distribuï¿½on of outcomes for
the treated if they had not received treatment. We observe outcome í µí±Œí µí±Œ, which is í µí±Œí µí±Œ0 if í µí±‡í µí±‡ = 0
and í µí±Œí µí±Œ1 otherwise. Formally, í µí±Œí µí±Œ = (1 âˆ’ í µí±‡í µí±‡)Ã—í µí±Œí µí±Œ0 + í µí±‡í µí±‡Ã—í µí±Œí µí±Œ1 .
     Following the pracï¿½ce of most RCTs, we assume the populaï¿½on of interest is the sub-
populaï¿½on of individuals who apply for the program under evaluaï¿½on. For this reason, esï¿½-
mates from RCTs are oï¿½en considered to be impacts â€œon the treatedâ€ and we follow this
pracï¿½ce. This terminology only depends on what populaï¿½on one considers the available
sample to represent, and not on which individuals from this sample parï¿½cipate or the meth-
ods used. In pracï¿½ce, there is usually a second selecï¿½on step, which is compliance with
treatment assignment. 6 We consider methods to adjust for this second selecï¿½on step in
Secï¿½ons 3.3 and 3.4. These methods can be extended to the methods in Secï¿½ons 4 and 5 or
to correct for selecï¿½ve applicaï¿½on to parï¿½cipate in the RCT. For mean impacts, researchers
oï¿½en setle for intent-to-treat parameters instead, to avoid further assumpï¿½ons. Methodo-
logically, this approach extends to many DIA parameters. However, when analyzing hetero-
geneity, intent-to-treat parameters confound heterogeneity in take-up 7 with heterogeneity
in treatment eï¬€ects. It will usually be more informaï¿½ve to analyze these two sources of het-
erogeneity separately. Compliance with treatment assignment is observed, so heterogeneity
in compliance can be analyzed using the standard methods used to study program take-up.
In this toolkit, we focus on heterogeneity in treatment eï¬€ects, i.e., parameters of treatment
on the treated.

2. Two Uncondiï¿½onal Approaches

In terms of impact on the outcome distributions, consider quesï¿½ons such as:

    â€¢   Does microï¬nance boost average incomes?
        To answer this quesï¿½on, we would esï¿½mate the average treatment eï¬€ect, í µí´¼í µí´¼(í µí±Œí µí±Œ1 ) âˆ’
        í µí´¼í µí´¼(í µí±Œí µí±Œ0 ), or the average treatment eï¬€ect on the treated, í µí´¼í µí´¼(í µí±Œí µí±Œ1 |í µí±‡í µí±‡ = 1) âˆ’ í µí´¼í µí´¼(í µí±Œí µí±Œ0 |í µí±‡í µí±‡ = 1).
    â€¢   Does hospital regulaï¿½on raise minimum levels of paï¿½ent safety?



4
  While these methods can be applied using conï¿½nuous, discrete or binary outcomes, they add litle in the bi-
nary case since the distribuï¿½on has only two points of support and is completely characterized by its mean.
5
  Formally, í µí±í µí±í µí°·í µí°· (í µí¼í µí¼| â‹…) â‰¡ arg infí µí±¥í µí±¥ {P(í µí±Œí µí±Œí µí°·í µí°· â‰¤ í µí±¥í µí±¥| â‹…) â‰¥ í µí¼í µí¼} for í µí¼í µí¼ âˆˆ (0,1).
6
  Consequently, â€œon the treatedâ€ remains slightly ambiguous, as it could also be deï¬ned based on actual
treatment receipt within the given sample or populaï¿½on, i.e., in terms of í µí±‡í µí±‡.
7
  Note that this is take-up given parï¿½cipaï¿½on in the RCT. For predicï¿½ons about policy impacts in the popula-
ï¿½on, we need the uncondiï¿½onal take-up model unless the RCT sample is representaï¿½ve of the enï¿½re popula-
ï¿½on.
                                                                                                                      5
           To answer this quesï¿½on, we would esï¿½mate the treatment eï¬€ect on the minimum,
           min í µí±Œí µí±Œ1 âˆ’ min í µí±Œí µí±Œ0 , or on a quanï¿½le in the leï¿½ tail, such as í µí±í µí±1 (0.1) âˆ’ í µí±í µí±0 (0.1).
       â€¢   Does educaï¿½on reform decrease dispersion of studentâ€™s test scores?
           To answer this quesï¿½on, we could esï¿½mate the treatment eï¬€ect on a measure of in-
           equality, such as the variance, var(í µí±Œí µí±Œ1 ) âˆ’ var(í µí±Œí µí±Œ0 ), or the Gini index.

The answer to the ï¬rst quesï¿½on is based on the mean, a parï¿½cular feature of the outcome
distribuï¿½on that is the focus of most convenï¿½onal approaches to evaluate policies. However,
randomizaï¿½on idenï¿½ï¬es the full distribuï¿½on of treated and untreated outcomes, í µí°¹í µí°¹0 and í µí°¹í µí°¹1 .
í µí±…í µí±… is independent of í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 , so that í µí°¹í µí°¹0 (í µí±¦í µí±¦0 |í µí±…í µí±… = 0) = í µí°¹í µí°¹0 (í µí±¦í µí±¦0 ) and í µí°¹í µí°¹1 (í µí±¦í µí±¦1 |í µí±…í µí±… = 1) = í µí°¹í µí°¹1 (í µí±¦í µí±¦1 ).
Consequently, under full compliance, we can esï¿½mate the distribuï¿½on of treated outcomes,
í µí°¹í µí°¹1 , from the treatment group and the distribuï¿½on of untreated outcomes, í µí°¹í µí°¹0 from the con-
trol group. Thus, we can compare diï¬€erent features of the treatment and control distribu-
ï¿½ons to answer the remaining quesï¿½ons. We can measure the impact of a policy on the me-
dian, minimum or low quanï¿½les of the distribuï¿½on of realized outcomes by taking the diï¬€er-
ence in the median, minimum or botom decile of the outcome between the treatment and
control group. By the same token, we can measure the impact of an intervenï¿½on on a par-
ï¿½cular inequality measure, such as the standard deviaï¿½on or the Gini coeï¬ƒcient, as in the
third quesï¿½on.
        Importantly, these methods are not informaï¿½ve about how a programâ€™s impact varies
across individuals, because they ignore who within the populaï¿½on belongs in diï¬€erent seg-
ments of the outcome distribuï¿½on. We may want to study the distribution of treatment
eï¬€ects if we are concerned about how policy impacts vary across individuals. Analyses of the
distribuï¿½on of treatment eï¬€ects, discussed in Part 4, can answer quesï¿½ons like:

       â€¢   What proporï¿½on of students beneï¬t from an educaï¿½onal reform?
           For this quesï¿½on, we would compute P(í µí±Œí µí±Œ1 > í µí±Œí µí±Œ0 ) = P(Î” > 0).
       â€¢   Are the improvements in average paï¿½ent outcomes from health facility inspecï¿½ons
           driven by a few people who beneï¬t considerably? Formally: is there signiï¬cant skew-
           ness in eï¬€ects?
           For these quesï¿½ons, we would compute í µí´¼í µí´¼{[(í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 âˆ’ í µí¼‡í µí¼‡)â„í µí¼í µí¼]3 }, where í µí¼‡í µí¼‡ =
           í µí´¼í µí´¼(í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) and í µí¼í µí¼ 2 = í µí´¼í µí´¼[(í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 âˆ’ í µí¼‡í µí¼‡ )2 ].
       â€¢   What is the median impact of a microï¬nance program? More generally, what are the
           quanï¿½les of the impact distribuï¿½on, like the minimum or maximum program impact?
           For this quesï¿½on, we would compute the relevant quanï¿½le of treatment eï¬€ects.

    Unlike evaluaï¿½ng policy impacts on outcome distribuï¿½ons, studying the distribuï¿½on of
impacts requires addiï¿½onal, someï¿½mes strong, assumpï¿½ons about how individuals would
fare in a counterfactual treatment state. Even a perfect RCT cannot yield this informaï¿½on
since the same person cannot be in both the treatment and control group at the same ï¿½me.
    To further illustrate the diï¬€erence between the two approaches, consider the following
ï¬cï¿½onal example. 8 Researchers select a class of ï¬ve students to receive ï¬nance lessons.
Atendance is mandatory and compliance is perfect. At the end of the program, researchers
administer tests to measure ï¬nancial literacy. Table 1 presents the studentsâ€™ test scores. It
also shows what their grades would have been if they had not received the lessons. These


8
    Part 7 presents a real RCT with a similar setup.
                                                                                                                                          6
counterfactual outcomes are of course unobservable in real life, but we nonetheless show
them to clarify a few concepts.
          In standard impact analysis, we would compute the average treatment eï¬€ect (ATE): the
diï¬€erence in means between the two potenï¿½al outcomes. In our example, it is 1.6. Now
consider the treatment eï¬€ect on the median: the diï¬€erence in the medians between the dis-
tribuï¿½ons of potenï¿½al outcomes. In our example, it is 2. Why is it larger than the ATE? Be-
cause the treatment increased lower scores more than those at the top. If the lessons had
instead increased all scores by the same amount, the two eï¬€ects would have agreed. Note
that the diï¬€erence in medians is also higher than the median of individual eï¬€ects, 1, due to
individual mobility across the distribuï¿½on. For example, student E would have earned the
lowest grade without lessons, whereas E achieved the highest score under treatment.
          A litle formalism is useful for clarifying this point. Suppose that the potenï¿½al outcomes
(í µí±Œí µí±Œ0í µí±–í µí±– , í µí±Œí µí±Œ1í µí±–í µí±– ) of observaï¿½on í µí±–í µí±– correspond to quanï¿½les (í µí¼í µí¼0í µí±–í µí±– , í µí¼í µí¼1í µí±–í µí±– ) of í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 , respecï¿½vely. Then
the impact of the policy on individual í µí±–í µí±– is given by:

                                             í µí»¥í µí»¥í µí±–í µí±– â‰¡ í µí±Œí µí±Œ1í µí±–í µí±– âˆ’ í µí±Œí µí±Œ0í µí±–í µí±– = í µí±í µí±1 (í µí¼í µí¼1í µí±–í µí±– ) âˆ’ í µí±í µí±0 (í µí¼í µí¼0í µí±–í µí±– ).

This individual impact can never be esï¿½mated, since even an ideal RCT will only provide an
esï¿½mate of either í µí±í µí±1 (í µí¼í µí¼1í µí±–í µí±– ) oí µí±Ÿí µí±Ÿ í µí±í µí±0 (í µí¼í µí¼0í µí±–í µí±– ). We can rewrite the impact on individual í µí±–í µí±– as:

                              í µí»¥í µí»¥í µí±–í µí±– =       í µí±í µí±1 (í µí¼í µí¼1í µí±–í µí±– ) âˆ’ í µí±í µí±0 (í µí¼í µí¼1í µí±–í µí±– )
                                               ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½                                 + í µí±í µí±0 (í µí¼í µí¼1í µí±–í µí±– ) âˆ’ í µí±í µí±0 (í µí¼í µí¼0í µí±–í µí±– ).
                                                                                             ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
                                           quantile treatment eï¬€ect at í µí¼í µí¼1í µí±–í µí±–                        mobility eï¬€ect


Note that í µí±í µí±0 (í µí¼í µí¼0í µí±–í µí±– ) is a counterfactual outcome for individual í µí±–í µí±– corresponding to the í µí¼í µí¼0í µí±–í µí±– -
quanï¿½le of í µí°¹í µí°¹0 . The ï¬rst diï¬€erence is a quantile treatment eï¬€ect from the ï¬rst approach,
which is observable. The second diï¬€erence is a mobility eï¬€ect, which captures the change in
outcomes due to the movement of individuals to diï¬€erent quanï¿½les within the same distri-
buï¿½on.
    This equaï¿½on clariï¬es why quanï¿½le eï¬€ects are only equal to individual treatment eï¬€ects
if everyone keeps the same rank in í µí°¹í µí°¹0 and í µí°¹í µí°¹1 . That is, the mobility eï¬€ect is zero if í µí¼í µí¼0í µí±–í µí±– = í µí¼í µí¼1í µí±–í µí±–
for all individuals, which is called rank invariance. For example, the two black dots in Figure 1,
show the potenï¿½al outcomes for a parï¿½cular person in the treated (Treatment) and untreat-
ed states (Control). This person is hurt by the treatment despite the fact that most of the
populaï¿½on beneï¬ts, because her relaï¿½ve rank in the distribuï¿½on is much lower in the treat-
ment group than in the control group. While RCTs idenï¿½fy the quanï¿½le treatment eï¬€ect, un-
fortunately, the mobility eï¬€ect can never be recovered directly from the data without addi-
ï¿½onal assumpï¿½ons. This is again because we can never observe the same person in both the
treatment and control group at the same ï¿½me. Even if we observe the same person in the

                                                             Table 1: Mock Dataset
                                                Outcome                                        Outcome                                     Diï¬€erence in
  Student
                                            absent treatment                                under treatment                             potenï¿½al outcomes
  A                                                 1                                              2                                            1
  B                                                 2                                              4                                            2
  C                                                 3                                              4                                            1
  D                                                 4                                              4                                            0
  E                                                 1                                              5                                            4

                                                                                                                                                            7
               Figure 1: Potential Outcomes and an Individual-Speciï¬c Treatment Eï¬€ect

treatment and in the control group over ï¿½me, we must sï¿½ll make an assumpï¿½on about how
untreated outcomes vary over ï¿½me and how they depend on prior treatment status. The key
diï¬€erence between studying impact distribuï¿½ons in Part 4 and impacts on distribuï¿½ons in
Part 3 is modeling how an individualâ€™s relaï¿½ve performance changes when they are in the
treatment group instead of the control group, i.e., modeling the mobility eï¬€ect in the above
decomposiï¿½on. Once we have a credible model of the relaï¿½onship between í µí¼í µí¼1í µí±–í µí±– and í µí¼í µí¼0í µí±–í µí±– and
the right data, we can idenï¿½fy the enï¿½re distribuï¿½on of impacts!

3. From Uncondiï¿½onal to Condiï¿½onal Analysis

The discussions so far concern treatment eï¬€ect heterogeneity in the enï¿½re populaï¿½on. We
are oï¿½en also interested in how treatment eï¬€ects vary with observable characterisï¿½cs, such
as gender, income or baseline outcomes. As a few concrete examples, consider quesï¿½ons
like:

   â€¢   Are men or women more likely to beneï¬t from a program?
   â€¢   Are the returns to a ï¬nancial literacy training program higher for males or for fe-
       males?
   â€¢   Are schools with higher baseline test scores more likely to beneï¬t from school man-
       agement training?

    Part 5 provides tools to analyze such quesï¿½ons by discussing methods to study hetero-
geneity across and, to a lesser extent, within subpopulaï¿½ons deï¬ned by observable charac-
terisï¿½cs. It is important to note that these quesï¿½ons are about how treatment eï¬€ects corre-
late with observable characterisï¿½cs, not necessarily the causal impact of these observable
characterisï¿½cs on the treatment eï¬€ects. To be sure, the average causal impact of treatment
is sï¿½ll idenï¿½ï¬ed among subgroups, so long as treatment is randomly assigned within the
subgroup. However, the subgroupâ€™s characterisï¿½cs, such as being poor or female, are not
randomly assigned. Therefore, if we ï¬nd that a programâ€™s impacts are greater among the
poor, we cannot conclude that the treatment eï¬€ects are great because the people are poor.
For example, an omited variable, like neighborhood of residence, may drive the observed
correlaï¿½on.
    Nonetheless, answering such quesï¿½ons can provide useful informaï¿½on to policymakers.
For example, understanding how treatment eï¬€ects vary with observable characterisï¿½cs sug-
gests how to best target a program to maximize its impact (e.g., Manski, 2004) and contrib-
utes to the understanding of how parï¿½cular subgroups of interest, like women or the poor-

                                                                                                     8
est families, respond to the program. It may also shed light on underlying mechanisms (e.g.,
Pit, Rosenzweig and Hassan, 2012) and beter predict a programâ€™s eï¬€ects in a populaï¿½on
with diï¬€erent characterisï¿½cs from the original experimental populaï¿½on (e.g., Oâ€™Muirchear-
taigh and Hedges, 2014).

3. Impact on Outcome Distribuï¿½ons
1. Introducï¿½on

Policymakers oï¿½en worry about aggregate treatment eï¬€ects. For example, they may wish to
raise average income, decrease inequality or ï¬ght poverty. For such purposes, changes in the
level and the shape of the marginal outcome distribuï¿½on mater more than individual re-
sponses to the intervenï¿½on. This part provides tools to quanï¿½fy these eï¬€ects.
    There are diï¬€erent approaches to this task. We may analyze simple staï¿½sï¿½cs, such as the
mean, an inequality index or a poverty line. This strategy has the advantages of parsimony
and familiarity. For a more detailed picture, we may consider shiï¿½s in the CDF or its quan-
ï¿½les. We discuss quanï¿½les for the sake of concreteness, but the methods in this part extend
to other quanï¿½ï¿½es under minimal condiï¿½ons and with minimal adjustments.
    Quanï¿½le treatment eï¬€ects are the diï¬€erence between the quanï¿½les of potenï¿½al out-
comes. In graphical terms, they measure the horizontal distance between outcome distribu-
ï¿½ons (Firpo, 2007). We formally deï¬ne quanï¿½le treatment eï¬€ects on the treated (QTT) as:

                                 í µí»¥í µí»¥QTT (í µí¼í µí¼) â‰¡ í µí±í µí±1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) âˆ’ í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1),

where í µí±í µí±í µí°·í µí°· (í µí¼í µí¼|í µí±‡í µí±‡ = 1) is the í µí¼í µí¼-th quanï¿½le of potenï¿½al outcomes í µí±Œí µí±Œí µí°·í µí°· for the treated. 9 We only
observe í µí±í µí±1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) in the data. The remainder of this part surveys three approaches to re-
cover the counterfactual quanï¿½le í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) from untreated observaï¿½ons, which in turn
will allow us to esï¿½mate í µí»¥í µí»¥QTT (í µí¼í µí¼). 10
    We focus on uncondiï¿½onal treatment eï¬€ects. These eï¬€ects are parï¿½cularly relevant for
policy evaluaï¿½on, because they capture changes in the dispersion of outcomes both be-
tween and within subgroups of the populaï¿½on (Firpo, Forï¿½n and Lemieux, 2009). Since the
pioneering work of Koenker and Basset (1978), a related literature has explored condiï¿½onal
quanï¿½le regression (CQR). CQR esï¿½mates quanï¿½le eï¬€ects within subgroups under restricï¿½ve
assumpï¿½ons. Part 5 discusses condiï¿½onal eï¬€ects. Note that unlike average eï¬€ects, uncondi-
ï¿½onal quanï¿½le eï¬€ects are not weighted averages of subgroup eï¬€ects.
    This part conï¿½nues as follows. Secï¿½on 3.2 considers RCTs without endogenous selecï¿½on.
This perfectly randomized setup ensures that the distribuï¿½ons of potenï¿½al outcomes do not
depend on treatment status, so that randomizaï¿½on idenï¿½ï¬es QTTs without further assump-
ï¿½ons. However, many applicaï¿½ons deviate from this benchmark. For example, parï¿½cipants
might not comply with treatment assignment. The literature oï¬€ers a wealth of strategies to
account for sample selecï¿½on, as it does for average treatment eï¬€ects. Secï¿½on 3.3 surveys
inverse probability weighï¿½ng, which exploits the assumpï¿½on of selecï¿½on on observables.

9
    In analogy to average treatment eï¬€ects, we can also deï¬ne the quanï¿½le treatment eï¬€ect (QTE): í µí±í µí±1 (í µí¼í µí¼) âˆ’
í µí±í µí±0 (í µí¼í µí¼). See Firpo and Pinto (2016) for addiï¿½onal discussion.
10
     In pracï¿½ce, it is unfeasible to analyze all inï¬nite points of a conï¿½nuous distribuï¿½on. Therefore, we limit our
endeavor to parï¿½cular quanï¿½les of interest. If outcomes are discrete, in principle we could measure treatment
eï¬€ects at each value of the support.
                                                                                                                      9
Secï¿½on 3.4 presents an instrumental-variable approach. Secï¿½on 3.5 concludes with remarks
on the interpretaï¿½on of quanï¿½le eï¬€ects.

2. Randomized Control Trials Without Endogenous Selecï¿½on

This secï¿½on considers randomized trials without selecï¿½on problems, i.e., we assume:

     i. Potenï¿½al outcomes, (í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ), are jointly independent of treatment receipt, í µí±‡í µí±‡.

This is a strong assumpï¿½on, which is only likely to hold under idealized condiï¿½ons. The prob-
ability of assignment to treatment must be equal for all parï¿½cipants. 11 Moreover, the proba-
bility of treatment take-up must be constant. This condiï¿½on requires full compliance with
treatment assignment (í µí±‡í µí±‡ = í µí±…í µí±…) or random noncompliance. We must also observe outcomes
for all parï¿½cipants with the same probability. Should there be nonparï¿½cipaï¿½on or nonre-
sponse, they must be independent of treatment status. For simplicity, we refer to RCTs
which saï¿½sfy assumpï¿½on (i) as RCTs with perfect compliance or RCTs without endogenous
selecï¿½on.
     Assumpï¿½on (i) ensures that the counterfactual distribuï¿½on of potenï¿½al outcomes í µí±Œí µí±Œ0 of
the treated group, í µí°¹í µí°¹0 (í µí±¦í µí±¦|í µí±‡í µí±‡ = 1), is the same as that of the untreated group, í µí°¹í µí°¹0 (í µí±¦í µí±¦|í µí±‡í µí±‡ = 0).
Therefore, a consistent esï¿½mator of the QTT is simply the diï¬€erence in quanï¿½les between
observed outcomes of treated and untreated units:

                                   Ì‚ QTT (í µí¼í µí¼) = í µí±í µí±
                                 í µí»¥í µí»¥                                    ï¿½0 (í µí¼í µí¼|í µí±‡í µí±‡ = 0),
                                                   ï¿½1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) âˆ’ í µí±í µí±

where í µí±í µí± ï¿½í µí°·í µí°· (í µí¼í µí¼|í µí±‡í µí±‡) is any consistent esï¿½mator of the í µí¼í µí¼-th quanï¿½le of outcomes í µí±Œí µí±Œí µí°·í µí°· for group í µí±‡í µí±‡,
such as the empirical quanï¿½le. This esï¿½mator is straighï¿½orward to extend to other objects,
such as the variance or the Gini coeï¬ƒcient: it suï¬ƒces to take the diï¬€erence between the
staï¿½sï¿½cs for treated and untreated observaï¿½ons. Note that we may also esï¿½mate í µí°¹í µí°¹1 (í µí±¦í µí±¦|í µí±‡í µí±‡ =
1) from the treatment group and í µí°¹í µí°¹0 (í µí±¦í µí±¦|í µí±‡í µí±‡ = 1) from the control group under assumpï¿½on
(i). 12
      It is also possible to recover the QTT from a quanï¿½le regression, in the same way that
linear regression yields the average treatment eï¬€ect. To do so, run a quanï¿½le regression of
observed outcomes, í µí±Œí µí±Œ, on a constant and a treatment indicator, í µí±‡í µí±‡. The slope gives the QTT,
whereas the intercept gives the quanï¿½le í µí±í µí±         ï¿½0 (í µí¼í µí¼|í µí±‡í µí±‡ = 0).
      Assumpï¿½on (i) is strong and fails in many applicaï¿½ons. For example, the probability of
assignment to treatment may depend on parï¿½cipantsâ€™ atributes, such as region of resi-
dence. The equivalence between the distribuï¿½ons of potenï¿½al outcomes then breaks down,
leading to composiï¿½on bias. For the same reason, endogenous selecï¿½on into treatment is a
concern when parï¿½cipants do not comply with treatment assignment. Similar to average
eï¬€ects, we may either setle for intent-to-treat eï¬€ects or account for selecï¿½on and esï¿½mate
eï¬€ects on the treated under alternaï¿½ve frameworks, as the next secï¿½ons show.



11
   If the probability of assignment to treatment diï¬€ers across individuals by design, reweighï¿½ng the sample
yields consistent esï¿½mators. See Secï¿½on 3.3.
12
   With random non-compliance, one should include those with í µí±…í µí±… = 1 & í µí±‡í µí±‡ = 0 in the control group and those
with í µí±…í µí±… = 0 & í µí±‡í µí±‡ = 1 in the treatment group to esï¿½mate these distribuï¿½ons.
                                                                                                                      10
3. Applicaï¿½ons with Selecï¿½on on Observables: Inverse Probability Weighï¿½ng

In the ideal RCT of Secï¿½on 3.2, treated and untreated observaï¿½ons have the same distribu-
ï¿½on of potenï¿½al outcomes. Many applicaï¿½ons deviate from this benchmark, though. This
secï¿½on considers the weaker assumpï¿½on of selecï¿½on on observables. 13 Selecï¿½on on observ-
ables is an assumpï¿½on of condiï¿½onal independence between potenï¿½al outcomes and
treatment status, 14 which relaxes our previous assumpï¿½on of uncondiï¿½onal independence.
As the name suggests, we postulate that treatment take-up only depends on observed vari-
ables. Therefore, treated and untreated parï¿½cipants diï¬€er only in observed characterisï¿½cs
(other than treatment status). Correcï¿½ng imbalances in covariates should restore the
equivalence between outcome distribuï¿½ons and allow us to esï¿½mate treatment eï¬€ects.
    This intuiï¿½on moï¿½vates two classes of esï¿½mators: inverse probability weighï¿½ng (IPW)
and matching. IPW consists of reweighï¿½ng the sample to balance covariates across treated
and untreated observaï¿½ons, which should then have the same distribuï¿½on of potenï¿½al out-
comes. 15 Hirano, Imbens and Ridder (2003) propose IPW for average treatment eï¬€ects,
which Firpo (2007) extends to quanï¿½le eï¬€ects. Donald and Hsu (2014) consider CDFs,
whereas Firpo and Pinto (2016) discuss inequality indexes. 16 Matching consists of pairing
observaï¿½ons according to covariates and diï¬€erencing outcomes to esï¿½mate treatment
eï¬€ects. See Heckman and Vytlacil (2007) and Imbens and Wooldridge (2009) for surveys.
Matching does not readily extend from average to distribuï¿½onal eï¬€ects, because it relies on
the law of iterated expectaï¿½ons (FrÃ¶lich, 2007), which fails for quanï¿½les and other nonlinear
staï¿½sï¿½cs.
    The consistency of IPW esï¿½maï¿½on of distribuï¿½onal eï¬€ects relies on the same assump-
ï¿½ons and formulas as average eï¬€ects. It requires: 17

      i. Selecï¿½on on observables: potenï¿½al outcomes, (í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ), are jointly independent of
         treatment status, í µí±‡í µí±‡, given observed covariates, í µí±‹í µí±‹.
     ii. Common support: 0 < P(í µí±‡í µí±‡ = í µí±¡í µí±¡|í µí±‹í µí±‹ = í µí±¥í µí±¥) < 1 for all í µí±¥í µí±¥ and í µí±¡í µí±¡.

Assumpï¿½on (i) is the key idenï¿½ï¬caï¿½on assumpï¿½on. Assumpï¿½on (ii) is crucial, albeit standard.
Matching requires that covariates take the same value range in the treated and untreated
groups. Imbens (2015) presents methods to assess and enforce common support in the data.
   We implement the IPW esï¿½mator in two steps. First, we compute the weight funcï¿½on:

                                                    í µí±‡í µí±‡   1 âˆ’ í µí±‡í µí±‡     P(í µí±‡í µí±‡ = 1|í µí±‹í µí±‹)
                     í µí¼”í µí¼”IPW (í µí±‡í µí±‡, í µí±‹í µí±‹) =              +           Ã—                     .
                                              P(í µí±‡í µí±‡ = 1) P(í µí±‡í µí±‡ = 1) 1 âˆ’ P(í µí±‡í µí±‡ = 1|í µí±‹í µí±‹)

Here, P(í µí±‡í µí±‡ = 1) is the uncondiï¿½onal probability of treatment take-up, which we can esï¿½mate
with the share of the treated in the sample. The condiï¿½onal probability P(í µí±‡í µí±‡ = 1|í µí±‹í µí±‹) is the
propensity score, a building block of many esï¿½mators of average eï¬€ects. See Appendix 2 for
a discussion of esï¿½maï¿½on.

13
   We abstract henceforth from nonparï¿½cipaï¿½on and nonresponse.
14
   This assumpï¿½on is also known as unconfoundedness, ignorability and condiï¿½onal independence.
15
   DiNardo, Forï¿½n and Lemieux (1996) use reweighï¿½ng to decompose changes in the density of wages in the
U.S. in an early and inï¬‚uenï¿½al paper. However, they do not invesï¿½gate the properï¿½es of their esï¿½mator.
16
   Cataneo (2010) considers mulï¿½valued treatments.
17
   Addiï¿½onal regularity condiï¿½ons are required. See Firpo (2007, p. 263).
                                                                                                          11
    To build intuiï¿½on for í µí¼”í µí¼”IPW (í µí±‡í µí±‡, í µí±‹í µí±‹), remember that we wish to esï¿½mate the quanï¿½le treat-
ment eï¬€ect on the treated. We can sï¿½ll esï¿½mate í µí±í µí±1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) from the treated. Thus, the
funcï¿½on í µí¼”í µí¼”IPW (í µí±‡í µí±‡, í µí±‹í µí±‹) gives them equal weight, 1â„P(í µí±‡í µí±‡ = 1). To recover í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) from the
untreated, however, their distribuï¿½on of potenï¿½al outcomes must be comparable to that of
the treated. Hence, we reweight this subsample. By the assumpï¿½on of selecï¿½on on observa-
bles, we only need to balance the distribuï¿½on of í µí±‹í µí±‹. For that reason, í µí¼”í µí¼”IPW (í µí±‡í µí±‡, í µí±‹í µí±‹) is increasing
in the propensity score: we give more weight to untreated observaï¿½ons which resemble the
treated and less weight to observaï¿½ons with characterisï¿½cs that are uncommon among the
treated.
    Aï¿½er construcï¿½ng í µí¼”í µí¼”       ï¿½IPW (í µí±‡í µí±‡, í µí±‹í µí±‹), 18 we proceed as above. The QTT esï¿½mator is the diï¬€er-
ence between the quanï¿½les í µí±í µí±                                  ï¿½0 (í µí¼í µí¼|í µí±‡í µí±‡ = 0) of the reweighted sample, which
                                        ï¿½1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) and í µí±í µí±
we compute separately for treated and untreated observaï¿½ons. As before, this approach
extends to other staï¿½sï¿½cs. It also accommodates alternaï¿½ve treatment eï¬€ects, such as
eï¬€ects on the enï¿½re populaï¿½on: it suï¬ƒces to adjust the weight funcï¿½on (Firpo and Pin-
to, 2015).
    It is also possible to esï¿½mate quanï¿½le eï¬€ects with quanï¿½le regressions. One should run a
regression of outcomes on an intercept and a treatment indicator on the reweighted sam-
ple. Covariates should only enter the model through the weights í µí¼”í µí¼”                        ï¿½IPW (í µí±‡í µí±‡, í µí±‹í µí±‹). If they were
included as control variables, we would esï¿½mate a condiï¿½onal quanï¿½le eï¬€ect (see Part 5).
    The assumpï¿½on of selecï¿½on on observables is strong and has received extensive discus-
sion in the program evaluaï¿½on literature. The covariate set must be rich enough that the un-
explained component of treatment take-up is independent of potenï¿½al outcomes. This ap-
proach is popular in observaï¿½onal studies, and may also be useful in many RCTs, since de-
signers oï¿½en collect extensive data on parï¿½cipantsâ€™ backgrounds. Imbens (2015) suggests
placebo tests to assess plausibility. The assumpï¿½on becomes testable if a valid instrument is
available: see Donald, Hsu and Lieli (2014) for details.

4. Applicaï¿½ons with Selecï¿½on on Unobservables: Instrumental Variables

The previous secï¿½on leveraged the assumpï¿½on of selecï¿½on on observables to address se-
lecï¿½on bias. This secï¿½on explores an alternaï¿½ve strategy: instrumental variables (IV).
    IV esï¿½maï¿½on of average eï¬€ects has a long tradiï¿½on: see Heckman and Vytlacil (2007)
and Imbens and Wooldridge (2009) for surveys. Imbens and Rubin (1997) and Abadie (2002)
extend it to eï¬€ects on distribuï¿½ons. Important early contribuï¿½ons for quanï¿½le eï¬€ects are
Abadie, Angrist and Imbens (2002) and Chernozhukov and Hansen (2004, 2005). FrÃ¶lich and
Melly (2013a,b) propose esï¿½mators of uncondiï¿½onal distribuï¿½onal eï¬€ects.
    As Angrist and Imbens (1994) argue, the IV framework only idenï¿½ï¬es treatment eï¬€ects
on compliers â€“ the subpopulaï¿½on whose treatment status depends on the value of the in-
strument. Further assumpï¿½ons are necessary for idenï¿½ï¬caï¿½on of eï¬€ects on the treated. FrÃ¶-
lich and Melly (2013a) exploit one-sided noncompliance: for some value of the instrument,
parï¿½cipants never take the intervenï¿½on. For intuiï¿½on, consider a clinical trial of a vaccine.
Our candidate instrument is randomizaï¿½on. Parï¿½cipants in the treatment group might refuse
the vaccinaï¿½on. On the other hand, the control group has no access to it. Noncompliance is
one-sided in that it only aï¬€ects the treatment group. 19 This property implies that all the

18
  If the data include sampling weights, mulï¿½ply í µí¼”í µí¼”
                                                 ï¿½IPW (í µí±‡í µí±‡, í µí±‹í µí±‹) by the weights (Ridgeway et al., 2015).
19
  See the analysis of Head Start by Kline and Walters (2015) for a counter-example. Their paper highlights the
importance of verifying the assumpï¿½on of one-sided non-compliance in pracï¿½ce.
                                                                                                                              12
treated are compliers, which allows us to idenï¿½fy eï¬€ects on the treated from eï¬€ects on
compliers.
    This secï¿½on presents the framework of FrÃ¶lich and Melly (2013a). We assume the exist-
ence of a binary instrument í µí±í µí±, such that í µí±í µí± = 0 implies í µí±‡í µí±‡ = 0. One example is randomiza-
ï¿½on. 20 Formally, we assume: 21

       i. Independent instrument: í µí±Œí µí±Œ0 is independent of í µí±í µí± given covariates, í µí±‹í µí±‹, for all í µí±¥í µí±¥ such that
          P(í µí±‡í µí±‡ = 1|í µí±‹í µí±‹ = í µí±¥í µí±¥) > 0.
      ii. One-sided noncompliance: P(í µí±‡í µí±‡ = 0|í µí±í µí± = 0) = 1.
     iii. Support condiï¿½on: P(í µí±í µí± = 0|í µí±‹í µí±‹ = í µí±¥í µí±¥) > 0 for all í µí±¥í µí±¥ such that P(í µí±‡í µí±‡ = 1|í µí±‹í µí±‹ = í µí±¥í µí±¥) > 0.

If the assumpï¿½on of one-sided noncompliance fails, this procedure yields consistent esï¿½-
mates of eï¬€ects on treated compliers. It is also possible to obtain local treatment eï¬€ects.
See FrÃ¶lich and Melly (2013b) for details.
    Condiï¿½on (i) ensures that the instrument is valid. We need full independence, which is
stronger than the assumpï¿½on of uncorrelatedness of the linear IV model. In an RCT, it means
that í µí±Œí µí±Œ0 does not depend on treatment assignment, which is reasonable. Condiï¿½on (iii) is
analogous to the assumpï¿½on of common support in the previous subsecï¿½on. We implement
the IV esï¿½mator in two steps. First we compute the weight funcï¿½on:

                                                            í µí±‡í µí±‡   1 âˆ’ í µí±‡í µí±‡     P(í µí±í µí± = 0|í µí±‹í µí±‹) âˆ’ í µí±í µí±
                        í µí¼”í µí¼”IV (í µí±‡í µí±‡, í µí±‹í µí±‹, í µí±í µí±) =              +            Ã—                         .
                                                      P(í µí±‡í µí±‡ = 1) P(í µí±‡í µí±‡ = 1)     P(í µí±í µí± = 0|í µí±‹í µí±‹)

Note the similarity to í µí¼”í µí¼”IPW (í µí±‡í µí±‡, í µí±‹í µí±‹). Appendix 2 discusses the esï¿½maï¿½on of the condiï¿½onal
probability P(í µí±í µí± = 0|í µí±‹í µí±‹).
      To build intuiï¿½on for í µí¼”í µí¼”IV (í µí±‡í µí±‡, í µí±‹í µí±‹, í µí±í µí±), suppose that the instrument is randomizaï¿½on, i.e.,
í µí±í µí± = í µí±…í µí±…. The distribuï¿½on of potenï¿½al outcomes is iniï¿½ally balanced across the treatment and
control groups, due to random assignment. Noncompliance distorts the distribuï¿½on for the
treated, which now consists of compliers. The untreated include noncompliers from the
treatment group, as well as counterfactual compliers and noncompliers from the control
group. To recover í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1), we would ideally restrict the untreated to counterfactual
compliers, but we do not know who they are. Note however that the distribuï¿½on of í µí±Œí µí±Œ0 for
noncompliers is the same in the treatment and control groups, because of randomizaï¿½on.
Therefore, giving negaï¿½ve weights to the outcomes of noncompliers from the treatment
group makes them â€œcancel outâ€ counterfactual noncompliers in the control group, leaving us
with the distribuï¿½on of í µí±Œí µí±Œ0 for counterfactual compliers!
      Accounï¿½ng for covariates accommodates applicaï¿½ons in which the instrument is only
condiï¿½onally exogenous, such as RCTs with straï¿½ï¬ed randomizaï¿½on and observaï¿½onal data.
We might also want to purge indirect eï¬€ects of an intervenï¿½on to focus on parï¿½cular mech-
anisms. Although controlling for covariates undoes the equivalence between the treated and
compliers, the idenï¿½ï¬caï¿½on result of FrÃ¶lich and Melly (2013a) holds nonetheless.
      Aï¿½er construcï¿½ng í µí¼”í µí¼”IV (í µí±‡í µí±‡, í µí±‹í µí±‹, í µí±í µí±), 22 we proceed as above. The QTT esï¿½mator is the diï¬€er-
ence between the quanï¿½les í µí±í µí±                               ï¿½0 (í µí¼í µí¼|í µí±‡í µí±‡ = 0) of the reweighted sample, which
                                     ï¿½1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1) and í µí±í µí±

20
   The esï¿½mator extends to mulï¿½valued and conï¿½nuous IVs: see Secï¿½on 3.1 in FrÃ¶lich and Melly (2013a).
21
   Addiï¿½onal regularity condiï¿½ons are required. See FrÃ¶lich and Melly (2013a, p. 391). In parï¿½cular, we assume
that there is no endogenous atriï¿½on. The authors propose adjustments for atriï¿½on in their Secï¿½on 4.
22
   If the data include sampling weights, mulï¿½ply í µí¼”í µí¼”
                                                  ï¿½IPW (í µí±‡í µí±‡, í µí±‹í µí±‹) by them (Ridgeway et al., 2015).
                                                                                                                  13
we compute separately for treated and untreated observaï¿½ons. 23 This approach extends to
other staï¿½sï¿½cs, such as the variance.

5. Interpreï¿½ng Quanï¿½le Eï¬€ects

Quanï¿½le eï¬€ects are oï¿½en misinterpreted, which can result in unwarranted conclusions for
policy. This secï¿½on discusses and illustrates two common piï¿½alls: implicit assumpï¿½ons of
rank invariance and extrapolaï¿½ng treatment eï¬€ects to diï¬€erent populaï¿½ons.
     It is easy to conï¬‚ate quanï¿½le eï¬€ects (i.e., changes in the distribuï¿½on of outcomes) and
individual eï¬€ects (i.e., the distribuï¿½on of changes in outcomes). One might naively reason:
â€œThe median outcome in the control group is 50. The diï¬€erence in medians is 10. John is in
the control group and his outcome is 50. Therefore, his outcome would be 60 under treat-
ment.â€ Recall that the quanï¿½le eï¬€ect is the diï¬€erence in quanï¿½les between treated and un-
treated parï¿½cipants. Thus, we implicitly assumed that Johnâ€™s outcome would be equal to the
median of the treated if he underwent treatment himself â€“ in other words, rank invariance
(cf. Part 2). Rank invariance is a strong assumpï¿½on, which is implausible when treatment
eï¬€ects diï¬€er across observably idenï¿½cal parï¿½cipants.
     Assumpï¿½ons of rank invariance are oï¿½en subtle. For example, researchers might argue
that all parï¿½cipants beneï¬ted from the intervenï¿½on if all quanï¿½les eï¬€ects are strictly posi-
ï¿½ve. They would have invoked rank invariance across treatment status. One might also
equate quanï¿½le eï¬€ects and changes with respect to baseline outcomes instead of í µí±Œí µí±Œ0 . This
interpretaï¿½on requires rank invariance both across treatment states and over ï¿½me.
     For illustraï¿½on, consider Figure 2. It shows esï¿½mates of treatment eï¬€ects, based on data
from Simulaï¿½on 1 (see Appendix 1 for details). We set í µí±†í µí±† = 2, so that the ï¬rst period is the
baseline period. Individual eï¬€ects are independent of baseline outcomes; as a consequence,
the average treatment eï¬€ect at each quanï¿½le of baseline outcomes is close to the overall
average eï¬€ect, as can be seen from the line labeled â€œATE at Quanï¿½le of Baseline Yâ€. Yet,
quanï¿½le eï¬€ects are increasing. The QTT (dashed line) clearly diï¬€ers from both average
eï¬€ects at baseline values (thin line) and quanï¿½les of the distribuï¿½on of individual eï¬€ects í µí°¹í µí°¹Î”
(thick line). This discrepancy underlines the noï¿½on that implicitly assuming rank invariance
and misinterpreï¿½ng quanï¿½le eï¬€ect may lead to incorrect conclusions. Note, moreover, that
all quanï¿½le eï¬€ects are posiï¿½ve, even though some parï¿½cipants are worse oï¬€ aï¿½er treat-
ment.
     A diï¬€erent concern is the comparison of treatment eï¬€ects across (sub-)populaï¿½ons. This
part has surveyed the esï¿½maï¿½on of changes in the distribuï¿½on of potenï¿½al outcomes. As
Secï¿½on 4.2.2 argued, RCTs idenï¿½fy these marginal distribuï¿½ons, which allows us to compute
treatment eï¬€ects under minimal assumpï¿½ons. However, these eï¬€ects depend on the uni-
denï¿½ï¬ed joint distribuï¿½on of (í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ). As a consequence, it is diï¬ƒcult to extrapolate or com-
pare results between diï¬€erent (sub-)populaï¿½ons, unless we can account for diï¬€erences in
both the distribuï¿½ons of í µí±Œí µí±Œ0 and the relaï¿½on between í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 . For example, suppose that
we observe diï¬€erences in QTTs across genders. By itself, this ï¬nding does not tell us whether
these discrepancies arise from diï¬€erences in responses to the intervenï¿½on between men
and women or from diï¬€erences in outcomes in the absence of treatment. In other words,
they can stem from gender diï¬€erences in the unknown distribuï¿½on of treatment eï¬€ects, in
the distribuï¿½on of í µí±Œí µí±Œ0 or both. We can esï¿½mate the marginal distribuï¿½on of outcomes, which

23
     As before, it is possible to esï¿½mate the QTT from a weighted quanï¿½le regression. The slope gives the QTT.
                                                                                                                 14
                              Figure 2: QTTs and Common Misinterpretations

allows us to compare treatment eï¬€ects on quanï¿½les that correspond to the same value of
í µí±Œí µí±Œ0 . See the discussion of Figures 6 and 7 in Bitler, Hoynes and Domina (2014) for an example
and strategies to compare quanï¿½le eï¬€ects across groups.

4. Distribuï¿½on of Treatment Impacts
1. Introducï¿½on

1. Deï¬nitions and Outline

Part 3 discusses methods to esï¿½mate the impact of a policy or program on (funcï¿½ons of) the
marginal distribuï¿½on of outcomes. In this part, we are interested in the distribuï¿½on of indi-
vidual speciï¬c treatment eï¬€ects, í µí°¹í µí°¹í µí»¥í µí»¥ . The distribuï¿½on of treatment eï¬€ects is required to an-
swer quesï¿½ons such as:

    â€¢    What is the variance of treatment eï¬€ects?
    â€¢    What was the median impact of the program?
    â€¢    What proporï¿½on of the populaï¿½on was hurt by the program?

As described in Part 2, these quesï¿½ons cannot be answered by the methods in Part 3, be-
cause, rather than eï¬€ects on distribuï¿½ons, they concern eï¬€ects on individuals. The central
diï¬ƒculty of studying the distribuï¿½on of individual treatment eï¬€ects is that they require a
counterfactual outcome for every individual. Suppose person í µí±–í µí±– is in the treatment group, so
we observe í µí±Œí µí±Œ1 . In order to esï¿½mate the impact of treatment on person í µí±–í µí±– , we need to predict
                    ï¿½0 . Then, the individual treatment eï¬€ect is the diï¬€erence between the observed
í µí±Œí µí±Œ0í µí±–í µí±– , say by í µí±Œí µí±Œ
outcome in the treatment state and the counterfactual control group outcome for person í µí±–í µí±– :
  Ì‚ = í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ
í µí»¥í µí»¥              ï¿½0 . Similarly, for person í µí±—í µí±— in the control group, the researcher needs to predict í µí±Œí µí±Œ1í µí±—í µí±— ,
the outcome of person í µí±—í µí±— if í µí±—í µí±— were treated, in order to construct í µí»¥í µí»¥           Ì‚ = í µí±Œí µí±Œ
                                                                                           ï¿½1 âˆ’ í µí±Œí µí±Œ0 .
           Importantly, the individual esï¿½mates í µí»¥í µí»¥     Ì‚ í µí±–í µí±– are only of interest to idenï¿½fy the distribuï¿½on of
treatment eï¬€ects in order to answer quesï¿½ons such as those raised above. The esï¿½mated
                                                                                                                      15
                             Ì‚ , is of less interest both because it is noisily esï¿½mated and because
eï¬€ect on individual í µí±–í µí±– , í µí»¥í µí»¥
this individual has already been treated, so this treatment eï¬€ect provides litle informaï¿½on
about future implementaï¿½ons of the policy. In Part 5, we discuss methods to analyze heter-
ogeneity, which is informaï¿½ve about the types of people who beneï¬t from a program.
    In contrast to studying average treatment eï¬€ects or diï¬€erences in marginal distribuï¿½ons
as in Part 3, individual counterfactuals cannot be idenï¿½ï¬ed by randomizaï¿½on alone. Ran-
domly selecï¿½ng treatment and control groups idenï¿½ï¬es í µí°¹í µí°¹1 and í µí°¹í µí°¹0 but not how the out-
comes of a single individual vary across the treatment or control states. In general, the mar-
ginal distribuï¿½ons and quanï¿½le treatment eï¬€ects from Part 3 inform us of changes in the
frequency of outcomes and inequality, but they only provide limited informaï¿½on about idio-
syncraï¿½c responses to treatment (Bitler, Gelbach and Hoynes, 2014). 24 The distribuï¿½on of
impacts only equals the diï¬€erence in marginal potenï¿½al outcome distribuï¿½ons (or quanï¿½le
eï¬€ects) when individuals maintain exactly the same rank in both the treatment and control
outcome distribuï¿½ons. This rank preservation or invariance condiï¿½on implies that observa-
ï¿½ons with the same rank in the treatment and control outcome distribuï¿½ons are appropriate
counterfactuals for each other. When the rank invariance condiï¿½on is saï¿½sï¬ed, esï¿½maï¿½ng
the distribuï¿½on of treatment eï¬€ects only requires the methods discussed in Part 3. Rank in-
variance is a strong assumpï¿½on. If it does not hold, the parameters from the previous part
are sï¿½ll idenï¿½ï¬ed, but their interpretaï¿½on can be diï¬ƒcult. The interpretaï¿½on of the distribu-
ï¿½on of treatment eï¬€ects is always clear, but the distribuï¿½on is no longer idenï¿½ï¬ed by ran-
domizaï¿½on if rank invariance fails. As a result, we must either make addiï¿½onal, someï¿½mes
strong, assumpï¿½ons that imply individual counterfactuals to point idenï¿½fy the distribuï¿½on of
treatment eï¬€ects, or we must setle for parï¿½al idenï¿½ï¬caï¿½on, where only a range of parame-
ters is idenï¿½ï¬ed.
    The empirical strategy depends on the validity of assumpï¿½ons that we need to assess for
the case at hand, so we ï¬rst provide some background and then discuss more general esï¿½-
maï¿½on principles before we discuss a speciï¬c model that applies to many evaluaï¿½ons. In
parï¿½cular, we ï¬rst illustrate the idenï¿½ï¬caï¿½on problem using the variance of treatment
eï¬€ects as an example. In Secï¿½on 4.2, we discuss parï¿½al idenï¿½ï¬caï¿½on and how addiï¿½onal
assumpï¿½ons can narrow the bounds from this approach. Secï¿½on 4.3 discusses point idenï¿½ï¬-
caï¿½on. We ï¬rst illustrate the required assumpï¿½ons and provide an overview of common ap-
proaches to jusï¿½fy them. We then introduce methods to esï¿½mate features (moments) of the
distribuï¿½on or, under more stringent assumpï¿½ons, the enï¿½re distribuï¿½on. In pracï¿½ce, we
need to adapt the methods to jusï¿½fy the assumpï¿½ons and the esï¿½maï¿½on method to our ap-
plicaï¿½on and data availability, so we close by giving an overview of a speciï¬c panel data
model. The model is general enough to cover many common seï¿½ngs and can serve as a
blueprint which is adaptable to other situaï¿½ons.

2. An Example: Variance of Treatment Eï¬€ects

The vast majority of impact evaluaï¿½ons focus on average treatment eï¬€ects: í µí´¼í µí´¼(í µí»¥í µí»¥) =
í µí´¼í µí´¼(í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ). This is the ï¬rst moment of the treatment eï¬€ect distribuï¿½on, which provides a
measure of locaï¿½on of the distribuï¿½on, i.e., how much individuals beneï¬t on average. If

24
   As Bitler, Gelbach and Hoynes (2014) point out, quanï¿½le eï¬€ects contain addiï¿½onal informaï¿½on about the
distribuï¿½on of individual eï¬€ects. If one or more quanï¿½le eï¬€ects are posiï¿½ve, at least one parï¿½cipant beneï¬ted
from the intervenï¿½on. The converse is also true. Note that Makarov bounds allow us to quanï¿½fy the shares of
winners and losers under minimal assumpï¿½ons: see Secï¿½on 4.3.
                                                                                                                16
treatment eï¬€ects are constant, it completely describes the eï¬€ects of the program. However,
when there is heterogeneity, a natural extension is to study higher order moments of the
distribuï¿½on. For example, the variance of treatment eï¬€ects is the second (centered) mo-
ment of this distribuï¿½on and provides a measure of the dispersion of the treatment
eï¬€ects, 25 i.e., how much they vary across individuals. In the ï¬cï¿½onal RCT in Part 2, the vari-
ance of treatment eï¬€ects summarizes how the impact of ï¬nancial literacy training varies
across students. The variance of treatment eï¬€ects is a useful measure of the importance of
heterogeneity. For instance, if the square root of the variance is close to the average treat-
ment eï¬€ect, some individuals are likely to be harmed by the program. The variance of indi-
vidual treatment eï¬€ects is:

                              var(í µí»¥í µí»¥) = var(í µí±Œí µí±Œ1 ) + var(í µí±Œí µí±Œ0 ) âˆ’ 2 cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ).

The variances of í µí±Œí µí±Œ1 and í µí±Œí µí±Œ0 are features of their marginal distribuï¿½ons and can be esï¿½mated
using the methods discussed in Part 3. However, cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) requires the researcher to know
how í µí±Œí µí±Œ1 relates to í µí±Œí µí±Œ0 . Unfortunately, we can never observe the same person in both the
treatment and control states simultaneously. As a result, the data do not idenï¿½fy cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 )
or, by extension, var(í µí»¥í µí»¥), without addiï¿½onal assumpï¿½ons.
    Consider the mock data in Table 1, but more realisï¿½cally, suppose we do not know which
outcomes under treatment are paired with outcomes in the absence of treatment. As usual,
we can calculate the average treatment eï¬€ect by taking the diï¬€erence between the average
outcome in the treatment and control groups, 26 which yields 1.6. Similarly, for the variance
of treatment eï¬€ects, we get:

                           ï¿½ (í µí±Œí µí±Œ1 ) + var
      ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) = var
      var                               ï¿½ (í µí±Œí µí±Œ0 ) âˆ’ 2 cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) = 1.36 + 0.94 âˆ’ 2 cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ).

Thus, the variance of treatment eï¬€ects is not idenï¿½ï¬ed from the data alone. We face an
analogous idenï¿½ï¬caï¿½on problem when esï¿½maï¿½ng the enï¿½re distribuï¿½on of individual
treatment eï¬€ects or other features of this distribuï¿½on: while features of the marginal distri-
buï¿½ons í µí°¹í µí°¹0 and í µí°¹í µí°¹1 can be calculated from the data, parameters that describe the relaï¿½onship
between í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 are necessary for point idenï¿½ï¬caï¿½on of the distribuï¿½on of treatment
eï¬€ects. We discuss two ways to proceed below. First, we can setle for bounds instead of
point esï¿½mates as discussed in Secï¿½on 4.2. Bounds are oï¿½en simple to obtain, but inference
can be diï¬ƒcult. They also tend to be too wide to be informaï¿½ve and narrowing them re-
quires addiï¿½onal assumpï¿½ons. Second, we can esï¿½mate the (parameters of the) relaï¿½onship
between counterfactual outcomes, as we discuss in Secï¿½on 4.3. This requires further as-
sumpï¿½ons and modeling, such as amending the RCT with a model of parï¿½cipaï¿½on choice.

2. Bounding the Distribuï¿½on of Treatment Eï¬€ects

While the data cannot idenï¿½fy higher order moments of the treatment eï¬€ects distribuï¿½on
without addiï¿½onal assumpï¿½ons, they can idenï¿½fy a range of values that must include the
true value. Bounds do not tell us anything regarding where in the range the parameter is

25
   Here, the variance of the treatment eï¬€ect means the variance of individual treatment eï¬€ects in the popula-
ï¿½on. This is disï¿½nct from the variance of the esï¿½mate of the average treatment eï¬€ect due to sampling that is
used for inference on average eï¬€ects.
26
   To keep the example simple, we abstract from sampling variaï¿½on throughout.
                                                                                                                    17
likely to lie, but they rule out parameter values outside this range, because the data are in-
consistent with them. For example, if we can ï¬nd the largest and smallest possible value of
cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ), we can plug these values into the formula above to obtain bounds on the vari-
ance of individual treatment eï¬€ects, i.e., the largest and smallest possible values it can take.
We ï¬rst conï¿½nue the example of the variance and then extend this idea to the distribuï¿½on
of treatment eï¬€ects and discuss its advantages and problems.
       Recall that cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) = í µí¼Œí µí¼Œ01 í µí¼í µí¼1 í µí¼í µí¼0 , where í µí¼Œí µí¼Œ01 is the correlaï¿½on between í µí±Œí µí±Œ1 and í µí±Œí µí±Œ0 , í µí¼í µí¼1 is
the standard deviaï¿½on of í µí±Œí µí±Œ1 and í µí¼í µí¼0 is the standard deviaï¿½on of í µí±Œí µí±Œ0 . We can esï¿½mate í µí¼í µí¼1 and
í µí¼í µí¼0 from the treatment and control group. The only remaining unknown is the correlaï¿½on
coeï¬ƒcient, í µí¼Œí µí¼Œ01 , which must lie between â€“â€Š1 and 1 by deï¬niï¿½on. Therefore, without addi-
ï¿½onal assumpï¿½ons,

                                           âˆ’í µí¼í µí¼1 í µí¼í µí¼0 â‰¤ cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) â‰¤ í µí¼í µí¼1 í µí¼í µí¼0 .

Subsï¿½tuï¿½ng these bounds for cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) in the formula for var(í µí»¥í µí»¥) yields bounds for var(í µí»¥í µí»¥).
Using the data in Table 1, the bounds are:

                                      ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) â‰¤ 1.36 + 0.94 + 2âˆš1.36Ã—0.94,
          1.36 + 0.94 âˆ’ 2âˆš1.36Ã—0.94 â‰¤ var
                                      ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) â‰¤ 4.56.
                               0.04 â‰¤ var

What can we learn from these bounds? At the upper bound, the average treatment eï¬€ect is
only 1.3 standard deviaï¿½ons from zero, so the data do not seem to rule out negaï¿½ve treat-
ment eï¬€ects. Since the lower bound is greater than zero, there has to be at least some
treatment eï¬€ect heterogeneity. In this way, bounds can also be used to test relevant hy-
potheses. For example, the classical standard approach to impact evaluaï¿½on assumes that
treatment eï¬€ects are constant, so var(í µí»¥í µí»¥) = 0. If the bounds do not include zero, as above,
the data are not consistent with constant treatment eï¬€ects (Heckman, Smith and Clements,
1997). 27 In Simulaï¿½on 1, where treatment eï¬€ects are normally distributed with unit mean
and variance, the bounds on the standard deviaï¿½on of treatment eï¬€ects tell us that it must
be between 0.78 and 3.13. Therefore, the bounds rule out a constant treatment eï¬€ect, but
include esï¿½mates over three ï¿½mes higher than the true standard deviaï¿½on.
    The bounds can be ï¿½ghtened using addiï¿½onal assumpï¿½ons. The results in Heckman,
Smith and Clements (1997) suggest assuming that potenï¿½al outcomes are posiï¿½vely corre-
lated (í µí¼Œí µí¼Œ01 â‰¥ 0) may be reasonable in some cases. If we are willing to assume that people
who do well in the absence of treatment also do well with treatment, the bounds become:

                                               0 â‰¤ cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) â‰¤ í µí¼í µí¼1 í µí¼í µí¼0 .

                                             ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) yields the narrower bounds:
Subsï¿½tuï¿½ng these bounds into the formula for var

                                                  ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) â‰¤ 1.36 + 0.94
                      1.36 + 0.94 âˆ’ 2âˆš1.36Ã—0.94 â‰¤ var
                                                  ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) â‰¤ 2.3.
                                           0.04 â‰¤ var




27
  To conduct a formal hypothesis test, the researcher needs to calculate standard errors for the bounds. We
return to this problem at the end of this secï¿½on.
                                                                                                                                  18
The data in Table 1 actually imply í µí¼Œí µí¼Œ01 = 0.21. Therefore, the true variance of the treatment
eï¬€ect is 1.84, which lies within these bounds.
      How does the example extend to learning about the distribuï¿½on of treatment eï¬€ects
without making assumpï¿½ons beyond what was required in Part 3? Just as in the case of the
variance above, one can sï¿½ll use the marginal outcome distribuï¿½ons to calculate bounds on
the enï¿½re distribuï¿½on of treatment eï¬€ects. Assume we have esï¿½mates of the marginal po-
tenï¿½al outcome distribuï¿½ons í µí°¹í µí°¹1 (â‹… |í µí±‹í µí±‹) and í µí°¹í µí°¹0 (â‹… |í µí±‹í µí±‹) from the treatment and control groups.
Then the distribuï¿½on of treatment eï¬€ects, í µí°¹í µí°¹í µí»¥í µí»¥ (í µí±‘í µí±‘) = í µí±ƒí µí±ƒ(í µí»¥í µí»¥ â‰¤ í µí±‘í µí±‘ ), can be bounded at any point
í µí±‘í µí±‘ using the following Makarov Bounds (Makarov, 1982; Firpo and Ridder, 2008): 28

        sup max{í µí°¹í µí°¹1 (í µí±¡í µí±¡) âˆ’ í µí°¹í µí°¹0 (í µí±¡í µí±¡ âˆ’ í µí±‘í µí±‘),0} â‰¤ í µí°¹í µí°¹í µí»¥í µí»¥ (í µí±‘í µí±‘ ) â‰¤ inf min{í µí°¹í µí°¹1 (í µí±¡í µí±¡) âˆ’ í µí°¹í µí°¹0 (í µí±¡í µí±¡ âˆ’ í µí±‘í µí±‘) + 1 , 1}.
          í µí±¡í µí±¡                                                                 í µí±¡í µí±¡


Bounds may also be informaï¿½ve about speciï¬c quesï¿½ons of interest. For example, marginal
potenï¿½al outcome distribuï¿½ons are someï¿½mes suï¬ƒcient to ï¬nd whether anyone was hurt
by the program or the share of treatment eï¬€ects that are negaï¿½ve, i.e., í µí°¹í µí°¹í µí»¥í µí»¥ (0). The Makarov
bounds indicate the range of values for the joint distribuï¿½on that are consistent with the ob-
served marginal distribuï¿½ons. We break down the pieces of the lower bound as an illustra-
ï¿½on. The maximum funcï¿½on in the lower bound just imposes the logical restricï¿½on that a
CDF cannot be negaï¿½ve. If we ignore the maximum for now, the bound simpliï¬es to:

                                                       sup í µí°¹í µí°¹1 (í µí±¡í µí±¡) âˆ’ í µí°¹í µí°¹0 (í µí±¡í µí±¡),
                                                           í µí±¡í µí±¡
which is just the largest verï¿½cal diï¬€erence between the treatment and control group CDFs.
    As with the lower bound, the minimum in the upper bound imposes the restricï¿½on that
the CDF can be no greater than 1. Ignoring the minimum, the upper bound becomes:

                                                  inf í µí°¹í µí°¹1 (í µí±¡í µí±¡) âˆ’ í µí°¹í µí°¹0 (í µí±¡í µí±¡) + 1,
                                                    í µí±¡í µí±¡
which is determined by the point where the treatment group looks best in comparison to
the control group.
    The ï¬rst panel of Figure 3 illustrates Makarov Bounds for the two data generaï¿½ng pro-
cesses described in simulaï¿½on 2. In both cases, the average treatment eï¬€ect is 1, but the
standard deviaï¿½on of treatment eï¬€ects is 0 in the ï¬rst case and 5 in the second case. Despite
the fact that treatment eï¬€ects are constant in the ï¬rst case, the bounds do not rule out size-
able heterogeneity. On the other hand, the bounds in the second case clearly rule out con-
stant treatment eï¬€ects.
    The second panel of Figure 3 plots the densiï¿½es of outcomes generated from the second
data generaï¿½ng process. The treated outcome density has a slightly higher mean than the
untreated density, but is much more dispersed. Consequently, a non-zero share of the treat-
ed densityâ€™s mass falls below the minimum value of the untreated potenï¿½al outcome densi-
ty. This indicates that someone was hurt by the program in this hypotheï¿½cal example. We
cannot say who was hurt by the program, but we know that the proporï¿½on of people hurt
by the program is at least í µí°¹í µí°¹1 [min(í µí±Œí µí±Œ0 )]. In this simulaï¿½on, this bound indicates that at least
26% (and at most 59%) of individuals were hurt by the treatment. In fact, based on the simu-
lated data, 40% of individuals were hurt by the treatment.

28
  Refer to Firpo and Ridder (2008) for a formula that yields narrower bounds by averaging across bounds from
condiï¿½onal distribuï¿½ons. Note that we have simpliï¬ed the notaï¿½on by assuming conï¿½nuous CDFs.
                                                                                                                                  19
           Figure 3: Simulaï¿½on 3, DGP and Makarov Bounds with í µí¼í µí¼í µí»¥í µí»¥ = 5 and í µí¼í µí¼í µí»¥í µí»¥ = 0.5

    In these examples, we have ignored sampling variaï¿½on, i.e., that the marginal distribu-
ï¿½ons are esï¿½mates rather than the true populaï¿½on distribuï¿½ons. Sampling variaï¿½on exacer-
bates the problem that bounds are oï¿½en wide (Heckman, Smith and Clements 1997), since
esï¿½maï¿½on error makes the possible range of parameters even wider than the point esï¿½-
mates of the upper and lower bounds. Moreover, obtaining the relevant standard errors is
oï¿½en diï¬ƒcult (see Subsecï¿½on 6.2.1). Nonetheless, bounds are usually easy to calculate and
clearly demonstrate what the data imply about the distribuï¿½on. Thereby, they can provide a
useful informal assessment of what can, and (more oï¿½en) what cannot, be learned from the
data alone. For example, if the point esï¿½mates of the variance bounds include zero, the data
are not informaï¿½ve about heterogeneity of treatment eï¬€ects without further assumpï¿½ons.

3. Point Idenï¿½ï¬caï¿½on of Features of the Distribuï¿½on of Treatment Eï¬€ects

When we are willing to make addiï¿½onal assumpï¿½ons, we can make more progress in point
idenï¿½fying the distribuï¿½on of treatment eï¬€ects. We ï¬rst conï¿½nue the example of the vari-
ance of treatment eï¬€ects and illustrate what kind of assumpï¿½ons are required for point
idenï¿½ï¬caï¿½on and what previous studies have done to jusï¿½fy them. The condiï¿½ons under
which these assumpï¿½ons are plausible crucially depend on the substanï¿½ve problem and the
                                                                                                20
available data. We use cross-secï¿½onal notaï¿½on to keep the exposiï¿½on simple. In pracï¿½ce,
one can easily adapt the methods to richer models, such as panel data models, by including
individual ï¬xed eï¬€ects or lagged values in í µí±‹í µí±‹í µí±–í µí±– . To allow researchers to choose and adapt the
methods to their cases, we discuss two general esï¿½maï¿½on frameworks in the next subsec-
ï¿½on. We conclude with an example of a speciï¬c panel data model that can easily be adapted
to many common empirical seï¿½ngs.
    Conï¿½nuing the example of the variance of treatment eï¬€ects, we can point idenï¿½fy
var(í µí»¥í µí»¥) if we are willing to assume a parï¿½cular value of the correlaï¿½on between the treated
and the untreated outcome. For example, if potenï¿½al outcomes are uncorrelated
                                                              ï¿½ (í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 ) = 1.36 + 0.94 = 2.3. As
cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) = 0. In our mock example, this implies: var
we have seen above, the true covariance in our example is posiï¿½ve, so assuming that it is
zero leads to an overesï¿½mate of the variance of treatment eï¬€ects.
    More generally, we need to be able to idenï¿½fy the dependence between the treated and
untreated outcomes to idenï¿½fy the distribuï¿½on of treatment eï¬€ects. So far, we have primari-
ly dealt with extreme cases (such as no or perfect dependence), in which the researcher ex-
plicitly chooses values for the parameters that determine the dependence of potenï¿½al out-
comes. While addiï¿½onal assumpï¿½ons are always required, a much beter case for them can
be made in pracï¿½ce for two reasons. First, the researcher may have a model that includes
the relevant dependence parameters and may be able to esï¿½mate them from this model
under weaker condiï¿½ons. For example, cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) is a crucial parameter of models of indi-
vidual choice such as the (generalized) Roy model, which can be esï¿½mated under condiï¿½ons
outlined in Heckman and HonorÃ© (1990) and extended in Abbring and Heckman (2007).
Thus, rather than drawing a convenient value from thin air as we do here for ease of exposi-
ï¿½on, we may be able to esï¿½mate the required parameters under plausible assumpï¿½ons by
amending the RCT with a model of individual choice. Second, the assumpï¿½ons are usually
only required to hold condiï¿½onal on observables, i.e., aï¿½er controlling for í µí±‹í µí±‹, as Subsec-
ï¿½on 4.3.2 describes.

1. Identiï¬cation and Key Assumptions

Idenï¿½ï¬caï¿½on of the distribuï¿½on of treatment eï¬€ects comes from restricï¿½ons of the depend-
ence between the part of the untreated outcome that is not explained by the covariates and
the size of the treatment eï¬€ect. In this subsecï¿½on, we discuss why these assumpï¿½ons are
necessary, how they solve the idenï¿½ï¬caï¿½on problem and why covariates are important even
in an RCT. Throughout this part, we assume perfect compliance, so that one can use í µí±…í µí±… and í µí±‡í µí±‡
interchangeably. We deï¬ne parameters and esï¿½mators in terms of í µí±‡í µí±‡ here, as the distribuï¿½on
of individual â€œintent-to-treatâ€ parameters is unlikely to be interesï¿½ng and is not clearly de-
ï¬ned. If perfect compliance fails, one needs to adapt the re-weighï¿½ng or IV methods from
part 3. For simplicity, we assume that the eï¬€ect of covariates is linear and addiï¿½vely separa-
ble:

                                    í µí±Œí µí±Œ0 = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí¼€í µí¼€ ,
                                    í µí±Œí µí±Œ1 = í µí±Œí µí±Œ0 + í µí»¥í µí»¥ = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí»¥í µí»¥ + í µí¼€í µí¼€ ,

where Î” is an individual speciï¬c impact of the treatment. This can conveniently be writen in
one equaï¿½on as:


                                                                                                           21
                                                  í µí±Œí µí±Œ = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí»¥í µí»¥í µí»¥í µí»¥ + í µí¼€í µí¼€.

This model is simple to extend: e.g., including non-linear funcï¿½ons of í µí±‹í µí±‹ is straighï¿½orward. It
is also more general than the resemblance to a standard regression equaï¿½on suggests. In
impact evaluaï¿½on, we are interested in í µí»¥í µí»¥ and not in the eï¬€ect of í µí±‹í µí±‹ on í µí±Œí µí±Œ0 . Thus, one can
think of í µí»½í µí»½ as the linear projecï¿½on coeï¬ƒcient, so that í µí±‹í µí±‹ and í µí¼€í µí¼€ are uncorrelated by construc-
ï¿½on (but not necessarily independent). If í µí»¥í µí»¥ depends on í µí±‹í µí±‹, the control group sï¿½ll idenï¿½ï¬es í µí»½í µí»½,
so that the treatment group idenï¿½ï¬es the (not necessarily causal) relaï¿½on of the treatment
eï¬€ect to observables. Thus, as long as randomizaï¿½on works, we can purge the observable
part of the model by parï¿½al regression, i.e., by regressing í µí±Œí µí±Œ on í µí±‹í µí±‹ (and í µí±‹í µí±‹í µí±‹í µí±‹ if treatment
eï¬€ects depend on observables) and working with residuals from this regression as if í µí±‹í µí±‹ does
not mater. 29
     In pracï¿½ce, including í µí±‹í µí±‹ in the model and esï¿½maï¿½ng it in one step may be more conven-
ient than parï¿½al regression. However, parï¿½al regression provides a useful thought device, as
it leaves only the unobservable part of the model, which consists of í µí»¥í µí»¥ + í µí¼€í µí¼€ for the treated
and í µí¼€í µí¼€í µí±–í µí±– only for the control group: í µí»¥í µí»¥í µí»¥í µí»¥ + í µí¼€í µí¼€ . This is a beneï¬t of randomizaï¿½on that helps to
idenï¿½fy the distribuï¿½on of treatment eï¬€ects. To see that it is not suï¬ƒcient, consider the
analogy to idenï¿½fying mean eï¬€ects, where one would compute the mean of í µí¼€í µí¼€ from the con-
trol group, the mean of í µí»¥í µí»¥ + í µí¼€í µí¼€ from the treatment group, and obtain the mean of í µí»¥í µí»¥ as their
diï¬€erence. Extending this to distribuï¿½ons, the treatment group idenï¿½ï¬es the distribuï¿½on of
the sum of í µí»¥í µí»¥ and í µí¼€í µí¼€ and the control group idenï¿½ï¬es the distribuï¿½on of í µí¼€í µí¼€ . However, one can-
not back out the distribuï¿½on of í µí»¥í µí»¥ from these two distribuï¿½ons: contrary to means, the
diï¬€erence between two distribuï¿½ons is not the distribuï¿½on of the diï¬€erences.
     To make progress, addiï¿½onal restricï¿½ons on the dependence of í µí¼€í µí¼€, the part of the un-
treated outcome that is not related to the covariates í µí±‹í µí±‹, and the treatment eï¬€ect are re-
quired. We saw above that, if we are willing to assume that individualsâ€™ potenï¿½al outcomes
are uncorrelated across treatment states, then the variance of treatment eï¬€ects can be
point idenï¿½ï¬ed. Technically, we have achieved idenï¿½ï¬caï¿½on by imposing a moment re-
stricï¿½on. All three terms in the formula for the variance of treatment eï¬€ects above are sec-
ond moments of the data and the covariance is the only moment that depends on the joint
distribuï¿½on. Restricï¿½ng it to zero leaves only terms that we can esï¿½mate, since the other
two terms, the variances of í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 , only depend on the marginal distribuï¿½ons. Similarly,
in the condiï¿½onal case, we can idenï¿½fy the variance of individual treatment eï¬€ects if
cov(í µí»¥í µí»¥, í µí¼€í µí¼€) = 0, since:

                var(í µí»¥í µí»¥) = var(í µí»¥í µí»¥ + í µí¼€í µí¼€) âˆ’ var(í µí¼€í µí¼€ ) âˆ’ 2 cov(í µí»¥í µí»¥, í µí¼€í µí¼€) = var(í µí»¥í µí»¥ + í µí¼€í µí¼€) âˆ’ var(í µí¼€í µí¼€).

We can esï¿½mate the ï¬rst term using the treatment group and the second from the control
group. This idea generalizes. If we are willing to assume that all third moments that are not
determined by the marginal distribuï¿½ons are zero, for example, the third moment of the dis-
tribuï¿½on of treatment eï¬€ects is idenï¿½ï¬ed. We provide more detail on moment esï¿½maï¿½on in
Subsecï¿½on 4.4.1. The limiï¿½ng case of this idea is to assume that all moments of the joint dis-
tribuï¿½on only depend on the moments of the marginal distribuï¿½on. This implies that treat-
ment eï¬€ects and the unexplained part of the untreated outcome are independent condi-



29
     Note that if randomizaï¿½on has been compromised, e.g., by noncompliance, the same has to be done for í µí±‡í µí±‡.
                                                                                                                 22
ï¿½onal on í µí±‹í µí±‹. Then the enï¿½re distribuï¿½on of treatment eï¬€ects can oï¿½en be esï¿½mated using
the method of deconvoluï¿½on, as discussed in Subsecï¿½on 4.4.2.

2. Justifying Identiï¬cation Assumptions

The discussion above shows that idenï¿½ï¬caï¿½on of (features of) the distribuï¿½on of treatment
eï¬€ects requires independence assumpï¿½ons. How can we jusï¿½fy such assumpï¿½ons? They are
saï¿½sï¬ed if treatment eï¬€ect heterogeneity is unrelated to any unobservable aspects of indi-
vidual í µí±–í µí±– , which underscores the importance of covariates. Unlike methods relying on ran-
domizaï¿½on, condiï¿½oning on covariates is typically required for idenï¿½ï¬caï¿½on here. The co-
variates control for variaï¿½on in í µí±Œí µí±Œ0 that is potenï¿½ally correlated with impact heterogeneity.
Consequently, the required assumpï¿½ons to esï¿½mate (moments of) the distribuï¿½on of treat-
ment eï¬€ects may be plausible when the data include a rich set of individual characterisï¿½cs.
This is because the condiï¿½onal independence assumpï¿½on allows Î” to depend on observable
characterisï¿½cs of person í µí±–í µí±– but not on any unobservable characterisï¿½cs or variables that have
been excluded from the model. Such a restricï¿½on seems more plausible the beter the mod-
el of untreated outcomes is. As a simple example, when the model contains no covariates,
í µí¼€í µí¼€ = í µí±Œí µí±Œ0 , so assuming í µí»¥í µí»¥ and í µí¼€í µí¼€ are uncorrelated amounts to the (usually unrealisï¿½c) assump-
ï¿½on that levels (í µí±Œí µí±Œ0 = í µí¼€í µí¼€ ) and gains (í µí»¥í µí»¥) are not related. However, RCTs in economics oï¿½en col-
lect detailed informaï¿½on including baseline values. Including baseline outcomes changes this
restricï¿½on to assuming that gains from the program are unrelated to deviaï¿½ons of the out-
come from its expected path. While the independence assumpï¿½on usually seems unrealisï¿½c
in cross-secï¿½onal applicaï¿½ons, it oï¿½en seems more plausible in panel data seï¿½ngs.
      Consequently, a key component of making the condiï¿½onal independence assumpï¿½on
credible is to atempt to control for all variables that are related to both the size of the
treatment eï¬€ect and the untreated outcome. Subject to the usual caveats (see, e.g., Angrist
and Pischke, 2009), this suggests controlling for many characterisï¿½cs in a ï¬‚exible way and
assessing the robustness of results to changes in the condiï¿½oning variables. However, just as
in a standard regression, regardless of data availability and modeling, whether the assump-
ï¿½on can be jusï¿½ï¬ed or not depends on the applicaï¿½on at hand.
      If we ï¬nd the assumpï¿½on that í µí»¥í µí»¥ is condiï¿½onally independent of í µí¼€í µí¼€ too strong, we may
turn to several tools from the literature to enhance credibility. Aakvik, Heckman and
Vytlacil (2005) show that this assumpï¿½on can be weakened by taking a random eï¬€ects factor
approach. Suppose the data are generated by:

                                      í µí±Œí µí±Œ = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí»¥í µí»¥í µí»¥í µí»¥ + í µí¼ƒí µí¼ƒ + í µí¼€í µí¼€ ,

where í µí¼ƒí µí¼ƒ is a vector of all unobserved variables which are potenï¿½ally correlated with í µí»¥í µí»¥ but
are independent of í µí±‹í µí±‹ and í µí±‡í µí±‡. If we can control for í µí¼ƒí µí¼ƒ, the distribuï¿½on of í µí»¥í µí»¥ can be recovered
using deconvoluï¿½on. Aakvik, Heckman and Vytlacil (2005) assume that í µí¼ƒí µí¼ƒ is an individual
speciï¬c random eï¬€ect with a parï¿½cular distribuï¿½on and esï¿½mate the model using maximum
likelihood. If panel data are available, we can model í µí¼ƒí µí¼ƒ using a less restricï¿½ve ï¬xed eï¬€ects
approach, as in the example in Subsecï¿½on 4.4.4 below.
     If we have access to mulï¿½ple related measures of important omited confounders (or
proxies), we can esï¿½mate the distribuï¿½on of í µí¼ƒí µí¼ƒ using a measurement system (Carneiro, Han-
sen and Heckman, 2003). To be concrete, suppose í µí¼ƒí µí¼ƒ represents ability. If we observe three
test scores, we may be willing to assume:

                                                                                                         23
                                                   í µí±€í µí±€1 = í µí¼ƒí µí¼ƒ + í µí±¢í µí±¢1 ,
                                                   í µí±€í µí±€2 = í µí»¼í µí»¼2 í µí¼ƒí µí¼ƒ + í µí±¢í µí±¢2 ,
                                                   í µí±€í µí±€3 = í µí»¼í µí»¼3 í µí¼ƒí µí¼ƒ + í µí±¢í µí±¢3

where í µí¼ƒí µí¼ƒ, í µí±¢í µí±¢1 , í µí±¢í µí±¢2 and í µí±¢í µí±¢3 are all mutually independent and idenï¿½cally distributed across indi-
viduals and í µí´¼í µí´¼(í µí±¢í µí±¢1í µí±–í µí±– ) = í µí´¼í µí´¼(í µí±¢í µí±¢2í µí±–í µí±– ) = í µí´¼í µí´¼(í µí±¢í µí±¢3í µí±–í µí±– ) = 0. Then, by Kotlarski (1967), í µí°¹í µí°¹í µí¼ƒí µí¼ƒ (â‹…) is nonparame-
terically idenï¿½ï¬ed, which implies í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…) can be recovered using deconvoluï¿½on. The supple-
mental appendix of Arcidiacono et al. (2011) provides more detailed instrucï¿½ons on how to
use Kotlarskiâ€™s Theorem to idenï¿½fy í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). The recent literature on dynamic factor models
(e.g., Cunha, Heckman and Schennach, 2010) combines this approach with the advantages
of panel data.

4. Esï¿½maï¿½on Methods

This secï¿½on presents two approaches to idenï¿½fying and esï¿½maï¿½ng features of the distribu-
ï¿½on of treatment eï¬€ects. In Subsecï¿½on 4.4.1, we extend our discussion about esï¿½maï¿½ng the
variance of treatment eï¬€ects to higher order moments of the distribuï¿½on. This ï¬rst ap-
proach relaxes some of the assumpï¿½ons required to esï¿½mate the full distribuï¿½on of treat-
ment eï¬€ects. It is therefore preferable for quesï¿½ons that can be answered by moments of
the distribuï¿½on of treatment eï¬€ects. For example, what is the variance of treatment eï¬€ects?
In Subsecï¿½on 4.4.2, we show how to use deconvoluï¿½on to esï¿½mate the enï¿½re distribuï¿½on of
treatment eï¬€ects, í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…), when our model suï¬ƒciently captures the variaï¿½on in the untreated
outcome that is related to treatment eï¬€ect heterogeneity, so that í µí»¥í µí»¥í µí±–í µí±– and í µí¼€í µí¼€í µí±–í µí±– are independ-
ent. All of the policy quesï¿½ons raised at the beginning of this secï¿½on can be answered by
compuï¿½ng features of this distribuï¿½on. Moreover, it is simple to calculate the variance of the
esï¿½mated distribuï¿½on to assess the variability of treatment eï¬€ects or the fracï¿½on of individ-
uals hurt by the training, í µí°¹í µí°¹  ï¿½í µí»¥í µí»¥ (0). We present simulaï¿½on results to illustrate these two meth-
ods in Subsecï¿½on 4.4.3.
    We conï¿½nue to use our basic model from the previous secï¿½on to keep the discussion
simple. However, cauï¿½on is warranted when applying the methods in pracï¿½ce, as the re-
quired condiï¿½onal independence assumpï¿½on is strong. This assumpï¿½on likely requires a
richer underlying model and may thereby limit how useful these methods are in pracï¿½ce.
Subsecï¿½on 4.4.4 presents addiï¿½onal details of these methods in a speciï¬c panel data con-
text where the condiï¿½onal independence assumpï¿½on may be plausible.

1. Identifying and Estimating Moments

As the example of the variance shows, moments of the distribuï¿½on of treatment eï¬€ects are
idenï¿½ï¬ed under weaker condiï¿½ons and oï¿½en provide suï¬ƒcient informaï¿½on to answer policy
quesï¿½ons. 30 The ï¬rst two moments of a distribuï¿½on imply its variance and the ï¬rst three
moments imply its skewness. Skewness is informaï¿½ve about how lopsided the distribuï¿½on is.
For example, a high and negaï¿½ve skewness indicates that there is an important number of
individuals whose treatment eï¬€ect is not far above the mean impact and a few individuals
with treatment eï¬€ects far below the mean impact. With many vaccines and medicaï¿½ons,


30
     As a reminder, the í µí±˜í µí±˜-th moment of the distribuï¿½on of treatment eï¬€ects is deï¬ned as í µí´¼í µí´¼ï¿½í µí»¥í µí»¥k ï¿½.
                                                                                                                                24
one may be worried about very lopsided distribuï¿½ons where most people beneï¬t modestly,
but a few people are severely harmed. Examining whether the skewness is large and nega-
ï¿½ve provides evidence on this issue.
    While moments are usually easy to esï¿½mate by their sample analog, í µí»¥í µí»¥ is never observed,
so we cannot esï¿½mate its moment directly. However, we can calculate the residuals from a
parï¿½al regression of í µí±Œí µí±Œ on í µí±‹í µí±‹ for the treatment and control group. Recall from above that if
covariates are linearly related to í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 , the residual from a parï¿½al regression of í µí±Œí µí±Œ on í µí±‹í µí±‹
corresponds to í µí»¥í µí»¥ + í µí¼€í µí¼€ for treatment group observaï¿½ons and í µí¼€í µí¼€ for control group observa-
ï¿½ons.
    We can calculate the variance of treatment eï¬€ects from the ï¬rst two moments of the
treatment eï¬€ects distribuï¿½on, which we can esï¿½mate as moments of our parï¿½al residuals:

                   var(í µí»¥í µí»¥) = í µí´¼í µí´¼(í µí»¥í µí»¥2 ) âˆ’ í µí´¼í µí´¼(í µí»¥í µí»¥)2 = í µí´¼í µí´¼[(í µí»¥í µí»¥ + í µí¼€í µí¼€)2 ] âˆ’ í µí´¼í µí´¼(í µí¼€í µí¼€ 2 ) âˆ’ í µí´¼í µí´¼(í µí»¥í µí»¥)2 .

The ï¬rst two terms are the second moments of treated and untreated parï¿½al residuals and
í µí´¼í µí´¼(í µí»¥í µí»¥) is just the average treatment eï¬€ect. Thus, each of these expectaï¿½ons can be esï¿½mated
using parï¿½al residuals. This is possible because we have assumed that í µí»¥í µí»¥ and í µí¼€í µí¼€ are uncorre-
lated, so í µí´¼í µí´¼(í µí»¥í µí»¥í µí»¥í µí»¥ ) = 0. This is just a condiï¿½onal version of the assumpï¿½on that cov(í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) = 0
that we used to idenï¿½fy the variance of treatment eï¬€ects in our example above.
             The skewness of the distribuï¿½on of treatment eï¬€ects is given by:

                                                      í µí´¼í µí´¼(í µí»¥í µí»¥3 ) âˆ’ 3í µí´¼í µí´¼(í µí»¥í µí»¥) var(í µí»¥í µí»¥) âˆ’ í µí´¼í µí´¼(í µí»¥í µí»¥)3
                          skewness(í µí»¥í µí»¥) =                                                               .
                                                                       var(í µí»¥í µí»¥)3â„2

Once we know the variance of treatment eï¬€ects, the only unknown term in this equaï¿½on is
the third moment, í µí´¼í µí´¼(í µí»¥í µí»¥3 ). To esï¿½mate it from our parï¿½al regression residuals, we need to
extend our assumpï¿½on that terms which do not depend solely on the marginal distribuï¿½ons
of potenï¿½al outcomes are zero to í µí´¼í µí´¼(í µí»¥í µí»¥í µí¼€í µí¼€ 2 ) and í µí´¼í µí´¼(í µí»¥í µí»¥2 í µí¼€í µí¼€). This is a restricï¿½on on how the vari-
ance of the error term is related to the treatment eï¬€ect and vice versa. Under this assump-
ï¿½on, the third moment of the distribuï¿½on of treatment impacts is given by:

                             í µí´¼í µí´¼(í µí»¥í µí»¥3 ) = í µí´¼í µí´¼[(í µí»¥í µí»¥ + í µí¼€í µí¼€)3 ] âˆ’ 3í µí´¼í µí´¼(í µí»¥í µí»¥)í µí´¼í µí´¼(í µí¼€í µí¼€ 2 ) âˆ’ í µí´¼í µí´¼(í µí¼€í µí¼€ 3 ),

Thus, we can esï¿½mate the skewness of the distribuï¿½on of treatment eï¬€ects from moments
of our parï¿½al residuals. Appendix 3 shows how to use the binomial formula to solve for
higher order moments.
    In theory, we can use this method to esï¿½mate all moments (or í µí°¾í µí°¾ = âˆ). This requires all
moments that are not determined by the marginal distribuï¿½ons to be zero. Of course, esï¿½-
maï¿½ng inï¬nitely many moments is impracï¿½cal. Thus, one may prefer to esï¿½mate the ï¬rst í µí°¾í µí°¾
moments and select one of the (usually many) distribuï¿½ons they are consistent with. For ex-
ample, in Secï¿½on 7.2, we esï¿½mate the enï¿½re distribuï¿½on of treatment eï¬€ects by assuming
they are normally distributed and by plugging in mean and variance esï¿½mates. Wu and Per-
loï¬€ (2006) esï¿½mate the ï¬rst four moments and recommend selecï¿½ng the distribuï¿½on ac-
cording to the Principle of Maximum Entropy. This distribuï¿½on is unique and is â€œmaximally
noncommital with regard to missing informaï¿½onâ€ (Jaynes, 1957; Wu and Perloï¬€, 2006). See
their paper for details.


                                                                                                                    25
2. Deconvolution

Deconvoluï¿½on methods esï¿½mate the distribuï¿½on of treatment eï¬€ects by removing the vari-
aï¿½on due to the error term from treatment group observaï¿½ons so the only remaining varia-
ï¿½on is due to the treatment eï¬€ect. Disentangling the variaï¿½on of the treatment eï¬€ect from
that of the error term requires a strong condiï¿½onal independence assumpï¿½on. More pre-
cisely, condiï¿½onal independence requires that the random component of í µí±Œí µí±Œ condiï¿½onal on
(í µí±‹í µí±‹, í µí±…í µí±…), í µí»¥í µí»¥í µí»¥í µí»¥ + í µí¼€í µí¼€ , is the sum of two independent random variables for the treatment group.
The distribuï¿½on of the sum of two random variables is called the convoluï¿½on of these ran-
dom variables. Deconvoluï¿½on methods undo this convoluï¿½on by removing the distribuï¿½on
of one of the random variables from the sum. In our simple model, deconvoluï¿½on requires í µí»¥í µí»¥
to be staï¿½sï¿½cally independent of í µí¼€í µí¼€ given í µí±‹í µí±‹. 31
       A testable implicaï¿½on of these assumpï¿½ons is that:

                        var(í µí±Œí µí±Œ1 |í µí±‹í µí±‹) = var(í µí»¥í µí»¥) + var(í µí¼€í µí¼€ ) â‰¥ var(í µí¼€í µí¼€) = var(í µí±Œí µí±Œ0 |í µí±‹í µí±‹).

This can be tested using the marginal outcome distribuï¿½ons. If var(í µí±Œí µí±Œ1 ) is not greater than
var(í µí±Œí µí±Œ0 ), we should be wary of using this approach. Note that var(í µí±Œí µí±Œ1 ) is greater than var(í µí±Œí µí±Œ0 )
in all of the simulaï¿½ons in Subsecï¿½on 4.4.3 below, even though the underlying assumpï¿½ons
are violated in some cases.
      Deconvoluï¿½on is oï¿½en implemented via esï¿½mated characterisï¿½c funcï¿½ons (e.g., Bon-
homme and Robin, 2010). Here, we present a simpler algorithm by Mallows (2007), which
Arellano and Bonhomme (2012) ï¬nd works well in pracï¿½ce. It esï¿½mates í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…) by randomly
matching treatment group residuals with control group residuals for the full sample many
ï¿½mes. To build intuiï¿½on for this algorithm, consider again the parï¿½al residuals from above.
For members of the control group, they contain just the error term, í µí¼€í µí¼€. For someone in the
treatment group, the parï¿½al residual is the sum of the treatment eï¬€ect and the error term,
í µí»¥í µí»¥ + í µí¼€í µí¼€. Since í µí»¥í µí»¥ and í µí¼€í µí¼€ are independent by assumpï¿½on, we can create pseudo-draws of í µí»¥í µí»¥ to
approximate its distribuï¿½on using:

                                                          ï¿½
                                                    Ì‚ = í µí»¥í µí»¥
                                                  í µí»¥í µí»¥       + Îµ âˆ’ í µí¼€í µí¼€Ì‚,

                                                     ï¿½
where í µí¼€í µí¼€Ì‚ is a control-group parï¿½al residual and í µí»¥í µí»¥ + Îµ is a treatment-group parï¿½al residual.
                                               Ì‚
Mallowsâ€™ Algorithm â€œshrinksâ€ esï¿½mates of í µí»¥í µí»¥ by matching treatment- and control-group par-
ï¿½al residuals under the assumpï¿½on that large values of treatment group parï¿½al residuals are
associated with larger than usual error terms and small treatment group parï¿½al residuals are
associated with smaller than usual error terms. The algorithm then draws a new pseudo-
sample of treatment residuals by randomly matching its shrinkage esï¿½mate of í µí»¥í µí»¥    Ì‚ with resid-
uals and esï¿½maï¿½ng a new shrinkage distribuï¿½on.
    Mallowsâ€™ Algorithm is described in more detail for the convenï¿½onal linear model below:

                                               í µí±Œí µí±Œ = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí»¥í µí»¥í µí±‡í µí±‡ + í µí¼€í µí¼€ .


31
  The model also requires addiï¿½ve separability and restricï¿½ons on the dependence of í µí±‹í µí±‹ and í µí»¥í µí»¥ or í µí¼€í µí¼€ as dis-
cussed above. However, these assumpï¿½ons are speciï¬c to the simple model that we use for clarity here. They
can potenï¿½ally be relaxed, e.g., when many periods of pre- and post-treatment observaï¿½ons are available, one
can use ï¬‚exible panel data models, such as in Jacobson, LaLonde and Sullivan (1993).
                                                                                                                    26
To beter disï¿½nguish treatment and control parï¿½al residuals, we will follow Arellano and
Bonhommeâ€™s (2012) notaï¿½on: í µí°´í µí°´ = í µí»¥í µí»¥ + í µí¼€í µí¼€, í µí°µí µí°µ = í µí»¥í µí»¥ and í µí°¶í µí°¶ = í µí¼€í µí¼€. Note that í µí°´í µí°´ = í µí°µí µí°µ + í µí°¶í µí°¶ . To be
sure, í µí°´í µí°´ and í µí°¶í µí°¶ are just vectors of parï¿½al residual esï¿½mates, whereas í µí°µí µí°µ is a vector of simulat-
ed draws from the (unknown) distribuï¿½on of treatment eï¬€ects.
   To prepare the data for Mallowsâ€™ Algorithm, use esï¿½mates from the convenï¿½onal linear
model above to form í µí°´í µí°´ and í µí°¶í µí°¶ using treatment and control group values of í µí±Œí µí±Œ âˆ’ í µí±‹í µí±‹í µí»½í µí»½      Ì‚ , respec-
ï¿½vely. 32 Then, run the algorithm as follows.

     1.   Set í µí°µí µí°µ0 = sort(í µí°´í µí°´ âˆ’ í µí°¶í µí°¶ ).
     2.        ï¿½ 0 be a random permutaï¿½on of í µí°µí µí°µ0 .
          Let í µí°µí µí°µ
     3.         Ìƒ denote í µí°´í µí°´ sorted according to the order of í µí°µí µí°µ
          Let í µí°´í µí°´                                                 ï¿½ 0 + í µí°¶í µí°¶ .
     4.                         Ìƒ âˆ’ í µí°¶í µí°¶ï¿½. Repeat steps 2 through 4 many ï¿½mes. 33
          Set í µí°µí µí°µí µí±˜í µí±˜ = sortï¿½í µí°´í µí°´

Each í µí°µí µí°µí µí±˜í µí±˜ is a pseudo-sample drawn from í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). The empirical distribuï¿½on of the full set of
í µí°µí µí°µí µí±˜í µí±˜ s is therefore an esï¿½mate of the distribuï¿½on of í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). An example program is in the sup-
plemental material available online.

3. Simulation Results

Table 2 shows the results of Simulaï¿½on 3. We present results using 6 diï¬€erent combinaï¿½ons
of parameters which determine the correlaï¿½on between treatment eï¬€ects and omited vari-
ables and the independence of treatment eï¬€ects from potenï¿½al outcomes. The moment and
deconvoluï¿½on esï¿½maï¿½on methods always yield the same average eï¬€ect, but the diï¬€erences
are parï¿½cularly pronounced in the respecï¿½ve esï¿½mates of the standard deviaï¿½on of treat-
ment eï¬€ects. As we would expect, both the deconvoluï¿½on and moment methods perform
relaï¿½vely beter when their assumpï¿½ons are saï¿½sï¬ed, which is the case for deconvoluï¿½on in
column one only and for the moment-based approach in column two only. In our simulaï¿½on
setup, the moment approach yields standard deviaï¿½on esï¿½mates, which are closer to the
truth when an omited variable is negaï¿½vely correlated with treatment eï¬€ects, regardless of
whether the covariance saï¿½sï¬es the moment or deconvoluï¿½on assumpï¿½ons. In contrast, the
deconvoluï¿½on standard deviaï¿½on esï¿½mates are a beter approximaï¿½on of the truth when
the omited variable is posiï¿½vely correlated with treatment eï¬€ects.




32
   The full í µí°¶í µí°¶ vector or complete replicaï¿½ons of the vector should be used in the algorithm since it is mean zero
by construcï¿½on. í µí°´í µí°´ and í µí°¶í µí°¶ must be the same size. If í µí°¶í µí°¶ is larger than í µí°´í µí°´, replace í µí°´í µí°´ with í µí±ší µí±š bootstrap draws with
replicaï¿½on where í µí±ší µí±š is the length of í µí°¶í µí°¶ . If í µí°´í µí°´ is larger than í µí°¶í µí°¶ , either replace í µí°´í µí°´ with í µí±ší µí±š bootstrap draws with rep-
licaï¿½on or with 2í µí±ší µí±š draws and replace í µí°¶í µí°¶ with [í µí°¶í µí°¶ â€² í µí°¶í µí°¶ â€² ]â€² .
33
   Arellano and Bonhomme (2012) repeat this procedure 2000 ï¿½mes and discard the ï¬rst 500 iteraï¿½ons. In
pracï¿½ce, the largest number of iteraï¿½ons that compuï¿½ng and ï¿½me constraints allow is desirable.



                                                                                                                                      27
                                                  Table 2: Results from Simulation 3
Correlaï¿½on with Omited Variable                                                                        None                     Negaï¿½ve               Posiï¿½ve
í µí±Œí µí±Œ0 independent of í µí»¥í µí»¥                                                                         Yes                No         Yes            No    Yes         No
A. Summary Statistics of Actual Eï¬€ects
Mean                                                                                            1.05                1.06    â€“â€‰0.38          â€“â€‰0.36   1.52       1.54
Standard deviaï¿½on                                                                               0.70                1.22       1.63          1.92    0.86       1.32
Skewness                                                                                        0.06                0.06       0.02         â€“â€‰0.01   0.12       0.12
B. Summary Statistics from Moments
Mean                                                                                            1.14                1.16    â€“â€‰0.34          â€“â€‰0.32   1.64       1.65
Standard deviaï¿½on                                                                               1.40                1.38       1.63          1.62    1.63       1.62
Skewness                                                                                        0.05                0.05     â€“0.01          â€“â€‰0.02   0.04       0.03
C. Summary Statistics from Deconvolution
Mean                                                                                            1.14                1.16    â€“â€‰0.34          â€“â€‰0.32   1.64       1.65
Standard deviaï¿½on                                                                               0.69                0.72       1.09          1.10    1.09       1.10
Skewness                                                                                        0.03                0.03    â€“â€‰0.03          â€“â€‰0.04   0.03       0.03
Notes: Esï¿½mates based on Simulaï¿½on 3, with í µí¼í µí¼01 equal to 0.5 or 0 and í µí±í µí± equal to â€“â€‰1, 0, or 1. When í µí¼í µí¼01 is 0.5,
treatment eï¬€ects are independent of potenï¿½al outcomes, so the deconvoluï¿½on assumpï¿½ons are saï¿½sï¬ed.
When í µí¼í µí¼01 is 0, the moments assumpï¿½ons are saï¿½sï¬ed. When í µí±í µí± is 0.5, there is no omited variable. When í µí±í µí± is 1
or â€“â€‰1, there is an omited variable which is posiï¿½vely or negaï¿½vely correlated with both treatment outcomes
and treatment eï¬€ects, respecï¿½vely.


4. A Speciï¬c Application with Panel Data

In pracï¿½ce, we likely need to extend the simple model from above and adapt the methods to
a speciï¬c seï¿½ng. To provide some guidance for this, we next discuss the panel data seï¿½ng
from Arellano and Bonhomme (2012), which can easily be adapted if the assumpï¿½ons above
do not seem plausible or the available data set has a diï¬€erent structure. The condiï¿½onal in-
dependence assumpï¿½on required for deconvoluï¿½on is more likely to be saï¿½sï¬ed when the
researcher can control for a rich set of individual characterisï¿½cs. Panel data are a special
case that also allows to ï¬‚exibly control for unobserved individual heterogeneity.
    As discussed previously, the central diï¬ƒculty in studying the distribuï¿½on of treatment
impacts is that a counterfactual outcome is needed for every individual in the sample. In a
panel, the same individual can oï¿½en be observed in the treated and control states at diï¬€er-
ent ï¿½mes. This allows one to model individual heterogeneity quite ï¬‚exibly, but instead re-
quires restricï¿½ons on how the treatment eï¬€ect and the residual are allowed to vary over
ï¿½me, as we show below. Arellano and Bonhomme (2012) show how to esï¿½mate higher or-
der moments of the treatment eï¬€ect distribuï¿½on and apply deconvoluï¿½on methods to esï¿½-
mate the full distribuï¿½on of treatment eï¬€ects when panel data are available.
    Consider the panel version of the linear model we work with throughout this secï¿½on:

                             í µí±Œí µí±Œí µí±–í µí±–í µí±–í µí±– = í µí»¼í µí»¼í µí±–í µí±– + í µí±‹í µí±‹í µí±–í µí±–í µí±–í µí±– í µí»½í µí»½ + í µí»¥í µí»¥í µí±–í µí±– í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– + í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– ,     í µí± í µí±  = 1, â€¦ , í µí±†í µí±†.

Call this model (1). Here, í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– is an indicator for whether person í µí±–í µí±– has ever been treated by
period í µí± í µí± . Outcomes are shiï¿½ed by the treatment eï¬€ect í µí»¥í µí»¥í µí±–í µí±– in all periods aï¿½er an individual is
treated, so this model implies that the treatment eï¬€ect is constant over the ï¿½me horizon of

                                                                                                                                                                       28
the panel. 34 This may be a strong assumpï¿½on, since treatment eï¬€ects may not begin imme-
diately and/or may fade over ï¿½me. For example, when analyzing the impact of a school
management intervenï¿½on on studentsâ€™ test scores, this amounts to assuming the interven-
ï¿½on had constant impacts over the enï¿½re period of data collecï¿½on (i.e., three years in the
applicaï¿½on in Secï¿½on 7.2). With very long panels, this can be relaxed by modeling decay
parametrically. A more general model is:

                   í µí±¦í µí±¦í µí±–í µí±–í µí±–í µí±– = í µí»¼í µí»¼í µí±–í µí±– + í µí±‹í µí±‹í µí±–í µí±–â€²í µí±–í µí±– í µí»½í µí»½ + í µí»¿í µí»¿í µí± í µí±  + í µí»¥í µí»¥í µí±–í µí±– í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– + í µí¼Œí µí¼Œí µí±–í µí±– (í µí± í µí±  âˆ’ í µí± í µí± í µí±–í µí±–âˆ— )í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– + í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– , í µí± í µí±  = 1, â€¦ , í µí±†í µí±†.

where í µí± í µí± í µí±–í µí±–âˆ— is the period in which individual í µí±–í µí±– received treatment. Here, the treatment eï¬€ect is
assumed to evolve linearly over ï¿½me according to the (non-stochasï¿½c) linear equaï¿½on
í µí»¥í µí»¥í µí±–í µí±–,í µí± í µí± âˆ’í µí± í µí± âˆ— = í µí»¥í µí»¥í µí±–í µí±– + í µí¼Œí µí¼Œí µí±–í µí±– (í µí± í µí±  âˆ’ í µí± í µí± í µí±–í µí±–âˆ— ).
             Arellano and Bonhomme (2012) show that the variance and distribuï¿½on of í µí»¥í µí»¥í µí±–í µí±– in model
(1) are idenï¿½ï¬ed under the following two assumpï¿½ons:

      i.   Condiï¿½onal independence: í µí»¥í µí»¥í µí±–í µí±– is staï¿½sï¿½cally independent of í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– .
     ii.   Error dynamics: The model requires restricï¿½on of the dependence of errors over
           ï¿½me, so that we can esï¿½mate the ï¿½me series process of í µí±£í µí±£í µí±–í µí±– . See Arellano and Bon-
           homme (2012) for further detail. In their applicaï¿½on, they assume that the errors fol-
           low an autoregressive or moving-average process with independent and idenï¿½cally
           distributed innovaï¿½ons in each period.

Note that the condiï¿½onal independence assumpï¿½on is now condiï¿½onal on an individual
ï¬xed eï¬€ect and the ï¿½me varying controls, í µí±‹í µí±‹í µí±–í µí±–í µí±–í µí±– . The only remaining source of potenï¿½ally prob-
lemaï¿½c residual variaï¿½on is ï¿½me-varying unobservables. While this is sï¿½ll a strong inde-
pendence assumpï¿½on, it is likely more plausible than in the cross-secï¿½onal seï¿½ng. The sec-
ond assumpï¿½on requires that the í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– are not too correlated across periods. This is required
to ensure that the treatment eï¬€ect can be disentangled from the persistent component of
error terms. Importantly, the relaï¿½onship between í µí»¥í µí»¥í µí±–í µí±– and í µí»¼í µí»¼í µí±–í µí±– is leï¿½ unrestricted. 35
    With panel data, the idenï¿½ï¬caï¿½on of the distribuï¿½on of individual treatment eï¬€ects re-
lies primarily on how outcomes of treated individuals vary between treatment and control
states. 36 While this allows us to esï¿½mate parï¿½cular í µí»¥í µí»¥í µí±–í µí±– , we are primarily interested in the dis-
tribuï¿½on of treatment eï¬€ects, as these individual esï¿½mates will be quite noisy in most appli-
caï¿½ons and most policy relevant quesï¿½ons relate to future realizaï¿½ons of treatment eï¬€ects.
Therefore, esï¿½maï¿½ng the distribuï¿½on of treatment eï¬€ects using these models requires the
data to have several features. Here, we will focus on model (1) under the assumpï¿½ons of
Arellano and Bonhomme (2012). In parï¿½cular, we assume someone is â€œtreatedâ€ if they have
ever received the treatment. In order to idenï¿½fy this model, individuals must be observed at
least three ï¿½mes, including at least one period before and another aï¿½er the individual re-
ceives the treatment. Suppose individual í µí±–í µí±– is observed three ï¿½mes and receives the treat-
ment in the third period. Then, her observed outcomes are given by:

                                                  í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí±  = í µí»¼í µí»¼í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí±  + í µí±‹í µí±‹í µí±–í µí±–â€²í µí±–í µí±– í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– ,

34
   Alternaï¿½vely, we could deï¬ne í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– as an indicator for being treated in period í µí± í µí± . In this case, treatment is as-
sumed to aï¬€ect the individual only in treated periods.
35
   In non-experimental seï¿½ngs, the relaï¿½onship between í µí»¥í µí»¥í µí±–í µí±– , í µí»¼í µí»¼í µí±–í µí±– , and í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– is unrestricted.
36
   Control group variaï¿½on aids esï¿½maï¿½on of common parameters that vary over ï¿½me.
                                                                                                                                                                                     29
                              í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí± +1 = í µí»¼í µí»¼í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí± +1 + í µí±‹í µí±‹í µí±–í µí±–â€²,í µí± í µí± +1 í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–,í µí± í µí± +1 ,
                              í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí± +2 = í µí»¼í µí»¼í µí±–í µí±– + í µí»¥í µí»¥í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí± +2 + í µí±‹í µí±‹í µí±–í µí±–â€²,í µí± í µí± +2 í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–,í µí± í µí± +2 .

    Consider the variaï¿½on in the data needed to idenï¿½fy each of the above parameters. First,
observe that í µí»¼í µí»¼í µí±–í µí±– and í µí»¥í µí»¥í µí±–í µí±– are individual-speciï¬c, so that only individual í µí±–í µí±– â€™s observaï¿½ons are in-
formaï¿½ve about their values. If not for í µí»¿í µí»¿í µí± í µí±  and í µí»½í µí»½, the parameters that are common across
individuals, í µí»¼í µí»¼í µí±–í µí±– and í µí»½í µí»½í µí±–í µí±– could be esï¿½mated separately for each individual. For this reason, í µí»¥í µí»¥í µí±–í µí±– is
only idenï¿½ï¬ed for the subpopulaï¿½on of individuals who are observed in both the treatment
and control states. In contrast, untreated observaï¿½ons are informaï¿½ve about the common
parameters, í µí»¿í µí»¿í µí± í µí±  and í µí»½í µí»½.
    If, instead, individual í µí±–í µí±– were treated in the second and third periods, her observed out-
comes would be:

                                        í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí±  = í µí»¼í µí»¼í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí±  + í µí±‹í µí±‹í µí±–í µí±–â€²í µí±–í µí±– í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– ,
                              í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí± +1 = í µí»¼í µí»¼í µí±–í µí±– + í µí»¥í µí»¥í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí± +1 + í µí±‹í µí±‹í µí±–í µí±–â€²,í µí± í µí± +1 í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–,í µí± í µí± +1 ,
                              í µí±Œí µí±Œí µí±–í µí±–,í µí± í µí± +2 = í µí»¼í µí»¼í µí±–í µí±– + í µí»¥í µí»¥í µí±–í µí±– + í µí»¿í µí»¿í µí± í µí± +2 + í µí±‹í µí±‹í µí±–í µí±–â€²,í µí± í µí± +2 í µí»½í µí»½ + í µí±£í µí±£í µí±–í µí±–,í µí± í µí± +2 .

In principle, the distribuï¿½on of í µí»¥í µí»¥í µí±–í µí±– is idenï¿½ï¬ed if each individual is only treated in one period
or, even in a cross-secï¿½on, if the errors í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– are independent and idenï¿½cally distributed. This
assumpï¿½on implies that the residual from any individual í µí±—í µí±— at any ï¿½me period í µí± í µí± , í µí±£í µí±£í µí±—í µí±—í µí±—í µí±— , could be
used as a counterfactual for the residual of individual í µí±–í µí±– at ï¿½me í µí± í µí± . If one only uses a cross-
secï¿½on, this reduces to the assumpï¿½on that residuals from another individual at the same
ï¿½me, í µí±£í µí±£í µí±—í µí±—í µí±—í µí±— , are valid counterfactuals for í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– . Exploiï¿½ng panel data to use only within individual
variaï¿½on, as we do here, relaxes this assumpï¿½on to require only residuals from the same
person, í µí±£í µí±£í µí±–í µí±–í µí±–í µí±–â€² , to be valid counterfactuals for í µí±£í µí±£í µí±–í µí±–í µí±–í µí±– for í µí± í µí±  â€² â‰  í µí± í µí± .
    We use only individual í µí±–í µí±– â€™s observaï¿½ons to esï¿½mate í µí»¥í µí»¥í µí±–í µí±– , so consistency is in the number of
treated and untreated periods, not the number of individuals. This is illustrated in Figure 4
below which is generated from Simulaï¿½on 1 with í µí±†í µí±† = 4 (leï¿½ panel) and í µí±†í µí±† = 16 (right panel).
In parï¿½cular, noï¿½ce that the distribuï¿½on of regression esï¿½mates of the treatment eï¬€ects is
quite diï¬€erent from the true distribuï¿½on and the deconvoluï¿½on esï¿½mates when í µí±†í µí±† = 4. The
esï¿½mates are much more similar when í µí±†í µí±† = 16. 37 In general, esï¿½mates of í µí»¥í µí»¥í µí±–í µí±– will be noisy




          Figure 4: Estimates of Distribution of Treatment Eï¬€ects (Left: í µí±†í µí±† = 4; Right: í µí±†í µí±† = 16)
when individuals are only treated in one, or even a few, periods. Moreover, esï¿½mates of

37
  The required number of ï¿½me periods depends on the SEs of í µí»¥í µí»¥í µí±–í µí±– , so there is no general rule. However, wheth-
er the variaï¿½on due to the esï¿½maï¿½on error is minimal can easily be examined in any given applicaï¿½on.
                                                                                                                               30
treatment impacts on a parï¿½cular individual are not of parï¿½cular policy interest, since the
individual has already received the treatment in quesï¿½on. The distribuï¿½on of treatment
eï¬€ects is potenï¿½ally more informaï¿½ve about how individuals are likely to be aï¬€ected by fu-
ture applicaï¿½ons of a program. Esï¿½mates of individual treatment eï¬€ects may be of interest
for analyzing how í µí»¥í µí»¥í µí±–í µí±– varies by individual characterisï¿½cs, which we discuss in more detail in
Part 5. For this purpose, the individual esï¿½mates can be regressed on covariates, but stand-
ard errors should be adjusted to account for the fact that the outcomes are themselves es-
ï¿½mated.
     A less ambiï¿½ous goal than esï¿½maï¿½ng í µí»¥í µí»¥í µí±–í µí±– for each treated individual is to esï¿½mate the dis-
tribuï¿½on of treatment eï¬€ects, í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). When í µí±†í µí±†, the number of periods in the panel, is large,
the distribuï¿½on of esï¿½mated individual treatment impacts, í µí°¹í µí°¹     ï¿½í µí»¥í µí»¥
                                                                    ï¿½ (â‹…) is likely to be an accurate
approximaï¿½on of í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). In such cases, one may only need to calculate or plot the distribuï¿½on
of the esï¿½mated treatment eï¬€ects. Unfortunately, í µí±†í µí±† is typically relaï¿½vely small in RCTs.
                                                                         ï¿½í µí»¥í µí»¥
When í µí±†í µí±† is small, each í µí»¥í µí»¥í µí±–í µí±– is esï¿½mated using few observaï¿½ons, so í µí°¹í µí°¹ï¿½ (â‹…) is an inï¬‚ated version
of í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…). Therefore, one needs to correct for this esï¿½maï¿½on error using deconvoluï¿½on as
speciï¬ed in step 3 below.
     When the data requirements and assumpï¿½ons discussed above are saï¿½sï¬ed, this model
can be esï¿½mated using the following procedure:

    1. Setup: Set up the data so that there is one observaï¿½on for each unique individual-
       ï¿½me period combinaï¿½on.
    2. Esï¿½mate regression: Regress the outcome on individual ï¬xed eï¬€ects, an indicator for
       having been randomly assigned to treatment by round í µí± í µí±  interacted with individual
       ï¬xed eï¬€ects and covariates with common eï¬€ects across individuals.
    3. Esï¿½mate feature of interest: If interested in the variance of treatment eï¬€ects, use
       Arellano and Bonhomme (2012), eq. (47). If interested in the full distribuï¿½on of
       treatment eï¬€ects, esï¿½mate í µí°¹í µí°¹í µí»¥í µí»¥ (â‹…) by applying Mallowsâ€™ algorithm using treatment
                                                                   Ì‚ âˆ’ í µí»¼í µí»¼
       and control period values of í µí±¦í µí±¦í µí±–í µí±–í µí±–í µí±– âˆ’ í µí±‹í µí±‹í µí±–í µí±–â€²í µí±–í µí±– í µí»½í µí»½   ï¿½í µí±–í µí±– .

Applicaï¿½ons of these methods are shown using data from an actual RCT conducted in The
Gambia in Secï¿½on 7.2 and using simulated data in Secï¿½on 7.3. Example code appears in the
supplementary materials available online.

5. Distribuï¿½onal Impacts and Condiï¿½onal Analyses
1. Introducï¿½on

Thus far, we have considered uncondiï¿½onal heterogeneity, i.e., how treatment impacts vary
in the populaï¿½on overall. We may also be interested in quesï¿½ons such as whether and how
the impact of a program on inequality diï¬€ers by gender or whether program impacts are in-
creasing or decreasing with baseline income. These quesï¿½ons concern (features of) the joint
distribuï¿½on of treatment impacts and other variables. Thus, as discussed in Part 2, they are
not answered directly by the methods above and call for conditional analysis. In this part, we
discuss how to study condiï¿½onal treatment eï¬€ect heterogeneity.
    We ï¬rst describe subgroup analysis, i.e., how the methods above can be applied to sub-
populaï¿½ons, such as by gender. Condiï¿½onal versions of both quesï¿½ons concerning impacts
on outcome distribuï¿½ons, such as whether the eï¬€ect on inequality varies by gender, and
                                                                                                          31
quesï¿½ons on the distribuï¿½on of outcomes, such as whether the fracï¿½on of individuals who
beneï¬t from the program varies by gender, may be of interest. Secï¿½on 5.2 shows that for
discrete covariates, such as gender, the problem is tractable, but oï¿½en requires larger sam-
ple sizes than those typically available. For conï¿½nuous variables, such extensions would re-
quire esï¿½maï¿½ng the joint distribuï¿½on of two conï¿½nuous variables, such as treatment eï¬€ects
and baseline income â€“ which requires even stronger assumpï¿½ons than the one discussed
above and excepï¿½onally large data. However, esï¿½maï¿½ng features of this joint distribuï¿½on,
such as condiï¿½onal means, may sï¿½ll answer important quesï¿½ons. For example, how would
the average treatment eï¬€ect change if the 1985 age distribuï¿½on were replaced with the cur-
rent distribuï¿½on, holding all else constant (Rothe, 2012)? Therefore, researchers oï¿½en esï¿½-
mate condiï¿½onal average treatment eï¬€ects. We discuss their esï¿½maï¿½on and interpretaï¿½on
in Secï¿½on 5.3.

2. Subgroup Analysis

We start with subgroup analysis, i.e., applying the methods discussed above separately to
two or more groups of interest. While straighï¿½orward in theory, this approach requires
common support and large sample sizes. In parï¿½cular, we can implement exactly the same
methods used to study the full sample on each of the diï¬€erent groups of interest. This con-
diï¿½onal approach can be applied to a wide range of methods, including average treatment
eï¬€ects, quanï¿½le treatment eï¬€ects and distribuï¿½ons of treatment eï¬€ects. For example, the
QTTs for men and women are given by:

               í µí»¥í µí»¥QTT (í µí¼í µí¼|gender = male) = í µí±í µí±1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1, male) âˆ’ í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1, male),
           í µí»¥í µí»¥QTT (í µí¼í µí¼|gender = female) = í µí±í µí±1 (í µí¼í µí¼|í µí±‡í µí±‡ = 1, female) âˆ’ í µí±í µí±0 (í µí¼í µí¼|í µí±‡í µí±‡ = 1, female).

If compliance is not perfect, so that independence of í µí±‡í µí±‡ and (í µí±Œí µí±Œ0 , í µí±Œí µí±Œ1 ) fails, it is important to
take this into account as discussed in Part 3. Just as QTTs are interpretable as the diï¬€erence
between the treatment and control marginal distribuï¿½ons at a parï¿½cular quanï¿½le, the sub-
group QTT for, say, males, is the diï¬€erence in the marginal distribuï¿½ons of outcome among
males at a parï¿½cular quanï¿½le. 38 These subgroup distribuï¿½onal impacts are of interest be-
cause, as in the full sample, means may mask substanï¿½al within-group treatment heteroge-
neity. Note that if the distribuï¿½on of the outcome variable is very diï¬€erent across groups,
quanï¿½le treatment eï¬€ects for each group may look diï¬€erent even if the eï¬€ects are idenï¿½cal
at the same values of the outcome variable. This is due to the fact that the quanï¿½les of the
distribuï¿½on of untreated outcomes, í µí±í µí±0 (í µí¼í µí¼), diï¬€er between the groups: see the discussions in
Secï¿½on 3.5 and around Figure 6 of Bitler, Hoynes and Domina (2014).
    In principle, the above approach of esï¿½maï¿½ng parameters separately by subgroup works
whenever the subgroup has both treatment and control observaï¿½ons, i.e., common sup-




38
  Note that subgroup QTTs diï¬€er from the esï¿½mates of condiï¿½onal quanï¿½le regression (CQR). CQR models
each quanï¿½le as a parametric funcï¿½on of covariates. The CQR coeï¬ƒcient on the interacï¿½on of the subpopula-
ï¿½on indicator and T would indicate how the í µí¼í µí¼ í µí±¡í µí±¡â„ quanï¿½le of í µí±¦í µí±¦ diï¬€ers between the treated in the subpopulaï¿½on
and the overall populaï¿½on (rather than the untreated subpopulaï¿½on). It assumes that treatment eï¬€ects are
constant across subgroups. Note that condiï¿½onal quanï¿½le eï¬€ects do not average to the uncondiï¿½onal eï¬€ect,
so that CQR provides litle informaï¿½on about treatment eï¬€ects for the populaï¿½on of parï¿½cipants.
                                                                                                                       32
port. 39 However, subgroup analysis requires even larger sample sizes, because separate
analyses are being conducted across each subgroup of interest. Thus, it may oï¿½en be infea-
sible, parï¿½cularly when subgroups are deï¬ned by several characterisï¿½cs or conï¿½nuous
measures. Taking baseline income as an example, it would be quite surprising if every
unique income level in the study was reported by at least two families, let alone one treat-
ment and one control family. Even at income levels where there are mulï¿½ple observaï¿½ons,
there generally will not be enough observaï¿½ons to yield a precise enough esï¿½mate of the
mean, not to menï¿½on the enï¿½re condiï¿½onal distribuï¿½on. Adjusï¿½ng for mulï¿½ple hypotheses
tests as we discuss in Part 6 further increases the required sample size. Of course, we can
parï¿½ally overcome this issue by collapsing conï¿½nuous variables into a small number of cate-
gories, like using income deciles, instead of income directly. This approach gains feasibility at
the cost of potenï¿½ally missing some heterogeneity, for example, within observaï¿½ons in the
same income decile. These assumpï¿½ons may allow learning about heterogeneity, but they
can also mask it if they are not chosen well, as we discuss further in Secï¿½on 5.3.

3. Condiï¿½onal Average Treatment Eï¬€ects

In this secï¿½on, we focus on condiï¿½onal average treatment eï¬€ects. In pracï¿½ce, most re-
searchers setle for showing that average eï¬€ects change with covariates. This is generally not
because learning about how the full distribuï¿½on changes with covariates is not of interest,
but because the subgroup sample sizes are too small to esï¿½mate separate distribuï¿½ons with-
in each subgroup. However, we may sï¿½ll be able to esï¿½mate the average eï¬€ect of interest
using only the relevant subsample. For example, if we are interested in how average impacts
vary across men and women, we can simply esï¿½mate Condiï¿½onal Average Treatment Eï¬€ects
(CATEs) 40 separately using the subsamples of men and women:

                í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– |gender = male) = í µí´¼í µí´¼(í µí±Œí µí±Œ|í µí±‡í µí±‡ = 1, male) âˆ’ í µí´¼í µí´¼(í µí±Œí µí±Œ|í µí±‡í µí±‡ = 0, male),
            í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– |gender = female) = í µí´¼í µí´¼(í µí±Œí µí±Œ|í µí±‡í µí±‡ = 1, female) âˆ’ í µí´¼í µí´¼(í µí±Œí µí±Œ|í µí±‡í µí±‡ = 0, female).

As above, this approach requires every subgroup of interest to have a suï¬ƒcient number of
observaï¿½ons in both treatment and control groups. If perfect compliance fails, í µí±‡í µí±‡ may be en-
dogenous and bias CATEs, just as it biases ATEs. Consequently, reweighï¿½ng or IV methods
are required to recover eï¬€ects on the treated, as in Part 3. One can also sï¿½ll use randomiza-
ï¿½on instead of treatment status to obtain intent-to-treat parameters. However, for their in-
terpretaï¿½on it is important to take into account that both take-up and treatment eï¬€ects may
vary between groups. Subpopulaï¿½on means share most of the advantages and shortcomings
of average treatment eï¬€ects discussed in Part 0, with the added beneï¬t that comparing
means across subpopulaï¿½ons can shed some light on heterogeneity. Djebbari and Smith
(2008) call heterogeneity explained by diï¬€erences in subgroup means â€œsystemaï¿½c heteroge-
neityâ€ and heterogeneity remaining aï¿½er controlling for these diï¬€erences â€œidiosyncraï¿½c het-
erogeneityâ€. Subgroup means are therefore informaï¿½ve about systemaï¿½c heterogeneity, but
not idiosyncraï¿½c heterogeneity. In some cases, this can lead to incorrect conclusions about

39
   Selecï¿½ng the relevant subgroups is a criï¿½cal step in condiï¿½onal analysis. It is recommended to deï¬ne the
groups of interest at the design stage and include them as part of the data collecï¿½on. See Secï¿½on 6.4. Despite
extensive planning, however, researchers may not anï¿½cipate the most relevant subgroups.
40
   We follow common terminology in calling this parameter CATE rather than â€œon the treatedâ€, as the discus-
sion in Part 2 suggests.
                                                                                                                 33
the nature and extent of treatment eï¬€ect heterogeneity. For example, Bitler, Gelbach and
Hoynes (2014) re-analyze a welfare experiment to invesï¿½gate the extent to which allowing
for heterogeneity in CATEs can explain the heterogeneity in quanï¿½le treatment eï¬€ects in Bit-
ler, Gelbach and Hoynes (2006). Using a simulaï¿½on exercise, they conclude heterogeneity
across subgroups is unable to explain the observed treatment eï¬€ect heterogeneity.
     As pointed out above, esï¿½maï¿½ng how average treatment eï¬€ects vary with covariates
non-parametrically is oï¿½en infeasible when there are many subgroups or when treatment
eï¬€ects vary with a conï¿½nuous variable. These problems can be miï¿½gated by making para-
metric assumpï¿½ons on the treatment eï¬€ect heterogeneity. We oï¿½en have prior beliefs that
suggest a certain funcï¿½onal form for treatment eï¬€ect heterogeneity. For example, we may
be willing to assume treatment eï¬€ects vary linearly or quadraï¿½cally with income. At the risk
of misspeciï¬caï¿½on, these assumpï¿½ons increase power and allow for idenï¿½ï¬caï¿½on of eï¬€ects
without full common support. Parametric models of treatment eï¬€ects can be implemented
by interacï¿½ng covariates with treatment status:

                                                         ï¿½ í µí±‡í µí±‡í µí±‡í µí±‡ + í µí»¿í µí»¿í µí»¿í µí»¿ + í µí¼€í µí¼€ .
                                      í µí±Œí µí±Œ = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí±‹í µí±‹

As above, í µí±‡í µí±‡ is unlikely to be exogenous when perfect compliance fails, so re-weighï¿½ng or IV
methods are necessary to obtain consistent esï¿½mates. The methods from secï¿½ons 3.3 and
3.4 are directly applicable, since condiï¿½onal means are features of the marginal outcome
distribuï¿½ons. One may be tempted to conï¿½nue to use randomizaï¿½on status í µí±…í µí±… instead of
treatment status í µí±‡í µí±‡ in order to esï¿½mate an intent-to-treat parameter. However, as pointed
out above, ITT parameters conï¬‚ate heterogeneity in take-up with heterogeneity in treat-
ment eï¬€ects, which makes them hard to interpret. It will usually be preferable to separately
esï¿½mate take-up given parï¿½cipaï¿½on in the RCT and treatment eï¬€ects for the treated sepa-
rately.
         We use í µí±‹í µí±‹   ï¿½ instead of í µí±‹í µí±‹ here to indicate that all covariates do not need to be interacted
with treatment. For example, í µí±‹í µí±‹            ï¿½ might include only gender or income if the researcher is
primarily concerned with that dimension of treatment heterogeneity. The coeï¬ƒcients on the
interacï¿½ons, í µí»¾í µí»¾, describe how the average treatment eï¬€ect varies with í µí±‹í µí±‹            ï¿½ . To be sure, this
model imposes several parametric assumpï¿½ons. Most importantly, potenï¿½al outcomes, í µí±Œí µí±Œ0
and í µí±Œí µí±Œ1 , are assumed to be linearly related to the covariates, since í µí±Œí µí±Œ0 = í µí±‹í µí±‹í µí±‹í µí±‹ + í µí¼€í µí¼€ and í µí±Œí µí±Œ1 =
            ï¿½ í µí»¾í µí»¾ + í µí¼€í µí¼€ . When the true data generaï¿½ng process is nonlinear, the esï¿½mates can be in-
í µí±‹í µí±‹í µí±‹í µí±‹ + í µí±‹í µí±‹
terpreted as a linear approximaï¿½on of the condiï¿½onal expectaï¿½on funcï¿½on and provide a
useful ï¬rst impression of the existence and direcï¿½on of heterogeneity. Also, covariates in-
cluded in í µí±‹í µí±‹ but not í µí±‹í µí±‹      ï¿½ are assumed to have the same impact on treatment and control out-
comes.
         While linear models can be made quite ï¬‚exible by including powers of covariates and in-
teracï¿½on terms, they may sï¿½ll struggle to detect complex relaï¿½onships. A common exercise
in regression analysis is to add covariates to the model to see how a coeï¬ƒcient of interest
changes. To explore whether observed subgroup impacts are driven by an omited variable,
we can add addiï¿½onal covariates to í µí±‹í µí±‹            ï¿½ . Recent work proposes using machine learning algo-
rithms as a data-driven approach to â€œbuildâ€ the model (Imai and Ratkovik, 2013; Athey and
Imbens, 2015; Wager and Athey, 2015) and include only the most important dimensions of
treatment heterogeneity.
         Condiï¿½onal average treatment eï¬€ects provide a simple measure of how treatment
eï¬€ects vary with observable characterisï¿½cs. As with the average treatment eï¬€ect, however,
                                                                                                               34
there is a distribuï¿½on around the condiï¿½onal mean. For example, even if all condiï¿½onal
means are posiï¿½ve, some individuals may sï¿½ll be hurt by the program. This idiosyncraï¿½c het-
erogeneity may pose a threat to the external validity of the results. For example, using sub-
group eï¬€ects to inform future targeï¿½ng of a program may backï¬re if the impact on the mar-
ginal parï¿½cipant is very diï¬€erent from the average treatment eï¬€ect among the current set of
parï¿½cipants, even within each subgroup. Smith (2015) provides the following example. Sup-
pose there is a program in which half of men have an impact of 10 and half have an impact
of 4. Similarly, half of women have an impact of 12 and the other half have an impact of 1. If
the cost of parï¿½cipaï¿½ng in the program is 5, only the â€œbig respondersâ€ will choose to parï¿½ci-
pate and the program will appear more eï¬€ecï¿½ve for women than men. However, the impact
on the marginal male parï¿½cipant (4) is larger than the impact on the marginal female parï¿½c-
ipant (1).
    We can atempt to overcome the above issue by esï¿½maï¿½ng a model of parï¿½cipaï¿½on
along with the outcome model. To address the concerns raised in the previous paragraph,
we need to understand how treatment eï¬€ects vary with both the observables and the unob-
servables, i.e., the error term í µí±‰í µí±‰ of this parï¿½cipaï¿½on model. The methods in this secï¿½on can
be used to study how treatment eï¬€ects vary with observed covariates. Heckman and
Vytlacil (1999, 2005, 2007) analogously deï¬ne marginal treatment eï¬€ects (MTE) as the aver-
age treatment eï¬€ect at a speciï¬c value of the unobservable component of the parï¿½cipaï¿½on
equaï¿½on:

                             í µí»¥í µí»¥MTE = í µí´¼í µí´¼(í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 |í µí±‰í µí±‰ = í µí±£í µí±£ , í µí±‹í µí±‹ = í µí±¥í µí±¥ ).

This is a condiï¿½onal average treatment eï¬€ect just as are those described below, but one
condiï¿½oning variable, í µí±‰í µí±‰, is not observed. Thus, esï¿½maï¿½on is more complex. Under the as-
sumpï¿½ons of Heckman and Vytlacil, it can be esï¿½mated as the derivaï¿½ve of the outcome, í µí±Œí µí±Œ,
with respect to the exogenous variaï¿½on in the propensity to parï¿½cipate. Brinch, Mogstad
and Wiswall (forthcoming) and Kowalski (2016) are examples of recent studies which use
MTEs to examine treatment heterogeneity. Cornelissen et al. (2016) provide a review and
discuss the relaï¿½on to LATE.

6. Staï¿½sï¿½cal Inference and Power Calculaï¿½ons
1. Introducï¿½on

Parts 3 and 4 discuss idenï¿½ï¬caï¿½on and esï¿½maï¿½on of treatment eï¬€ects. However, meaning-
ful policy evaluaï¿½on must also account for the precision of point esï¿½mates. This part surveys
some tools for formal hypothesis tests and power calculaï¿½ons in DIA: Secï¿½on 6.2 discusses
staï¿½sï¿½cal inference for DIA. It focuses on repeated tesï¿½ng and funcï¿½onal hypotheses. Sec-
ï¿½on 6.3 surveys tests of a parï¿½cular distribuï¿½onal hypothesis: whether individual responses
to treatment were heterogeneous. Secï¿½on 6.4 considers the choice of sample size for RCTs.
It aims to help researchers design RCTs to address distribuï¿½onal hypotheses.
     These three secï¿½ons draw on approximaï¿½ons to the ï¬nite-sample behavior of esï¿½mators
of treatment eï¬€ects. Inference and power calculaï¿½ons would ideally use the exact distribu-
ï¿½on of the esï¿½mator in quesï¿½on for each sample size. However, ï¬nite-sample results are on-



                                                                                                 35
ly available for special cases. 41 Hence, we must rely on asymptoï¿½c approximaï¿½ons, for which
there are two main strategies. Tradiï¿½onal asymptoï¿½c theory exploits the limiï¿½ng distribuï¿½on
of esï¿½mators as the sample size goes to inï¬nity, which is normal in most cases. This ap-
proach has two drawbacks. First, the resulï¿½ng approximaï¿½on might be poor. Second, the as-
ymptoï¿½c distribuï¿½on might be impracï¿½cal. For example, the asymptoï¿½c variance of the IPW
esï¿½mator of QTTs (Secï¿½on 3.3) depends on a condiï¿½onal expectaï¿½on (Firpo, 2007), which is
diï¬ƒcult to esï¿½mate due to the curse of dimensionality. Therefore, we recommend simula-
ï¿½on-based inference instead. The procedure is straighï¿½orward: esï¿½mate the eï¬€ect of inter-
est on many diï¬€erent samples; pool the esï¿½mates across replicaï¿½ons to construct a sample
of esï¿½mators; then use the distribuï¿½on of the esï¿½mator from this sample for inference.

2. Staï¿½sï¿½cal Inference

When researchers conduct DIA, they oï¿½en wish to address mulï¿½ple hypotheses or hypothe-
ses about mulï¿½ple parameters. However, repeated tesï¿½ng increases the probability of false
posiï¿½ves, distorï¿½ng signiï¬cance and power levels. Therefore, criï¿½cal values need careful ad-
justment according to the quesï¿½on at hand. 42
    This secï¿½on surveys three categories of hypotheses, which oï¿½en occur in DIA:

     â€¢   Single hypotheses about a ï¬nite number of points, which lend themselves to standard
         pointwise inference.
     â€¢   Multiple hypotheses about a ï¬nite number of points, which also pertain to pointwise
         inference, although criï¿½cal values need adjustment to correct signiï¬cance levels.
     â€¢   Single hypotheses about a function, which require uniform inference.

The next subsecï¿½ons discuss each category in turn, including examples of relevant hypothe-
ses and algorithms for valid inference.

1. Pointwise Inference

This subsecï¿½on focuses on pointwise inference: tesï¿½ng a single hypothesis about a ï¬nite
number of points. For instance, consider the following quesï¿½ons:

     â€¢   Is the average treatment eï¬€ect signiï¬cantly diï¬€erent from zero?
     â€¢   Is the distribuï¿½on of treatment eï¬€ects symmetric?
     â€¢   Is the change in the ï¬rst quarï¿½le of outcomes larger than the third quarï¿½le?

The ï¬rst hypothesis concerns a single staï¿½sï¿½c of the distribuï¿½on of treatment eï¬€ects. The
second also concerns a single staï¿½sï¿½c of this distribuï¿½on if we reformulate it in terms of
skewness. 43 The third concerns the treatment eï¬€ect on two points of the outcome distribu-
ï¿½on. Thus, they all require pointwise inference.

41
   For instance, ï¬nite-sample theory oï¬€ers exact formulas for the distribuï¿½on of quanï¿½le esï¿½mators at any
sample size if the data are independent and idenï¿½cally distributed. See Koenker (2005) and Chernozhukov,
Hansen and Jansson (2009).
42
   The design of the RCT should also account for mulï¿½ple tesï¿½ng. For example, opï¿½mal sample sizes are larger.
See Secï¿½on 6.4.
43
   Note that no skewness is a necessary condiï¿½on for symmetry, but it is not suï¬ƒcient.
                                                                                                                36
    Following the discussion in the introducï¿½on of this part, we recommend basing inference
on the bootstrap. Instead of hypothesis tests, we consider the equivalent problem of con-
strucï¿½ng conï¬dence intervals. We accept the null hypothesis if it falls enï¿½rely within the
conï¬dence interval and reject it otherwise.
    Suppose that the sample consists of í µí±í µí± observaï¿½ons. To construct a conï¬dence interval
at the 95% level, 44 Horowitz (2001) recommends the percenï¿½le method:

     1. Sample í µí±í µí± observaï¿½ons at random with replacement from the data. You now have a
        bootstrap sample.
     2. Esï¿½mate the treatment eï¬€ect of interest on the bootstrap sample and store it.
     3. Repeat steps 1 and 2 í µí°µí µí°µ ï¿½mes. You now have a sample of esï¿½mates of size í µí°µí µí°µ.
     4. Compute the quanï¿½les 0.025 and 0.975 of the sample of esï¿½mators, í µí±§í µí±§0.025 and
        í µí±§í µí±§0.975 . You now have bootstrap criï¿½cal values. Your conï¬dence interval is:
        [í µí±§í µí±§0.025 , í µí±§í µí±§0.975 ].

For diï¬€erent signiï¬cance levels, adjust step 4. Alternaï¿½ve resampling procedures in step 1
are possible. For example, we can sample clusters instead of individual observaï¿½ons to ac-
count for within-cluster dependence. 45 We can also use the bootstrap to obtain diï¬€erent
staï¿½sï¿½cs. For example, compute the standard deviaï¿½on of the sample of esï¿½mators in step 4
to esï¿½mate standard errors.
    How many bootstrap repeï¿½ï¿½ons are necessary? Computaï¿½on is oï¿½en trivial, so that a
conservaï¿½vely large í µí°µí µí°µ comes at almost no cost. Based on Andrews and Buchinsky (2000),
Cameron and Trivedi (2005) suggest at least 348 repeï¿½ï¿½ons for conï¬dence intervals at level
0.05 and 685 for level 0.01. In applied work, however, researchers tend to run at least a
thousand repeï¿½ï¿½ons and oï¿½en as many as ten thousand.
    To achieve correct inference with the bootstrap, step 2 should account for the interac-
ï¿½on between diï¬€erent sources of esï¿½maï¿½on noise. Consider, for example, the IPW esï¿½mator
of treatment eï¬€ects (see Secï¿½on 3.3). We ï¬rst compute weights for each observaï¿½on, before
taking the diï¬€erence between weighted quanï¿½les (or averages, variances, etc.). One should
not overlook esï¿½maï¿½on error from the ï¬rst step, which depends on the weight esï¿½mator. In
the case of parametric models, it is suï¬ƒcient to re-esï¿½mate the weights at each iteraï¿½on in
step 2 to adjust percenï¿½le intervals. 46 Nonparametric or semiparametric esï¿½mators are
more challenging, because their rates of convergence depend on tuning parameters (e.g.,
the kernel bandwidth). Most data-dependent procedures pick opï¿½mal tuning parameters, in
the sense that they minimize mean squared error. However, opï¿½mal convergence rates oï¿½en
generate asymptoï¿½c bias, which invalidates inference (whether it draws on asymptoï¿½c theo-
ry or the bootstrap). Then it is necessary to either correct for bias or to adjust the tuning pa-
rameter. Moreover, these procedures themselves introduce addiï¿½onal esï¿½maï¿½on noise. It is
unclear, however, whether one should correct for it. In a study of kernel density esï¿½mators,
for example, Hall and Kang (2001) argue against re-esï¿½maï¿½ng the bandwidth at each boot-
strap round.


44
   Analogous algorithms yield one-sided or asymmetric tests. See Horowitz (2001).
45
   The usual caveats about cluster-robust esï¿½maï¿½on apply. We refer the reader to the excellent survey of
Cameron and Miller (2015) for details, in parï¿½cular Subsecï¿½on VI.C.3 (â€œBootstrap with cauï¿½onâ€).
46
   For most esï¿½mators, analyï¿½cal correcï¿½ons for asymptoï¿½c conï¬dence intervals are possible. See Newey and
McFadden (2001) for a general discussion of inference for two-step esï¿½mators.
                                                                                                            37
    Note also that the bootstrap requires conï¿½nuity condiï¿½ons. 47 The esï¿½mators of changes
in the outcome distribuï¿½on in Part 3 generally saï¿½sfy these assumpï¿½ons. The excepï¿½on are
extremal eï¬€ects: very low and very high quanï¿½les, for which the scarcity of data aï¬€ects con-
vergence rates. Zhang (2016) considers inference for such extremal quanï¿½le eï¬€ects. Moment
esï¿½mators for the distribuï¿½on of treatment eï¬€ects (Subsecï¿½on 4.4.1) also saï¿½sfy the boot-
strap regularity condiï¿½ons, as long as this distribuï¿½on is not degenerate. On the other hand,
the validity of resampling for the deconvoluï¿½on esï¿½mator of Subsecï¿½ons 4.4.2 and 4.4.4 is
an open quesï¿½on, 48 because the asymptoï¿½c properï¿½es of Mallowsâ€™ Algorithm are unknown.
As the literature stands, the bootstrap provides some insight into the precision of this esï¿½-
mator, but it does not allow formal hypothesis tests.
    The theory of pointwise inference focuses on point esï¿½mates. However, it is also possible
to test hypotheses about parï¿½ally idenï¿½ï¬ed parameters. For example, Secï¿½on 4.2 discussed
the esï¿½maï¿½on of bounds on features of the distribuï¿½on of treatment eï¬€ects. As Imbens and
Manski (2004) and Stoye (2009) note, inference raises addiï¿½onal quesï¿½ons in this case. They
propose a strategy to construct conï¬dence intervals that cover the true, unknown parame-
ter within the bounds with the correct probability. The limits of these intervals depend on
the asymptoï¿½c distribuï¿½on of the bound esï¿½mators. This task is oï¿½en diï¬ƒcult because many
bounds involve extrema, such as the sample maxima and minima in the Makarov bounds in
Secï¿½on 4.2. These disconï¿½nuiï¿½es violate the smoothness assumpï¿½ons of standard methods
of inference. Fan and Park (2010) develop a subsampling strategy to perform inference on
Makarov bounds, which is valid under weak condiï¿½ons.

2. Multiple Hypothesis Testing (MHT)

Policy evaluaï¿½on oï¿½en entails mulï¿½ple hypothesis tests. For example, consider the ques-
ï¿½ons:

     â€¢   Do average treatment eï¬€ects vary across subgroups?
     â€¢   What is the average treatment eï¬€ect for various outcomes?
     â€¢   Which quanï¿½le treatment eï¬€ects are posiï¿½ve?

Repeated tesï¿½ng distorts signiï¬cance levels, necessitaï¿½ng adjustments to criï¿½cal values for
correct inference. To illustrate this point, suppose that researchers worry about heterogenei-
ty across ethniciï¿½es. They esï¿½mate average treatment eï¬€ects for ï¬ve ethnic groups and test
each esï¿½mate against the zero null hypothesis at the 5-percent level. Thus, the probability of
a false posiï¿½ve is ï¬ve percent for each test. Across all tests, however, it is larger. If the tests
are independent, it rises to 1 â€“ 0.95âµ = 0.23!
    Adjusï¿½ng criï¿½cal values requires us to extend the concept of test size (i.e., probability of
making a Type I error) to mulï¿½ple hypotheses. Several extensions exist and researchers
should base their choice of rejecï¿½on rule on substanï¿½ve consideraï¿½ons. 49 One approach

47
   It is oï¿½en possible to adjust the simulaï¿½on algorithm to obtain valid inference under weaker assumpï¿½ons.
For instance, Otsu and Rai (forthcoming) develop a valid weighted bootstrap approach for matching esï¿½ma-
tors. Diï¬€erent resampling methods, such as subsampling, are oï¿½en valid under weaker condiï¿½ons than the
bootstrap, although their theoreï¿½cal properï¿½es are not as advantageous. See Horowitz (2001).
48
   The nonparametric bootstrap is valid for the kernel deconvoluï¿½on esï¿½mator of the distribuï¿½on of treatment
eï¬€ects (Bissantz et al., 2007).
49
   Researchers should ideally deï¬ne their preferred error rate at the design stage.
                                                                                                               38
considers the Familywise Error Rate (FWER). The FWER is the probability of falsely rejecï¿½ng
at least one true null hypothesis. This criterion is stringent: it preserves signiï¬cance levels at
a heavy cost of test power. Some authors consider the k-FWER instead, which generalizes
the FWER to k false rejecï¿½ons. Also popular is the False Discovery Rate (FDR): the expected
proporï¿½on of false posiï¿½ves across all hypothesis tests. As Romano and Wolf (2010) point
out, however, control of the FDR does not allow us to make precise statements about the
realized probability of false discoveries, which might remain quite high.
    Romano and Wolf (2010) discuss these diï¬€erent concepts of error rates in more detail.
They propose a general method to construct simultaneous conï¬dence regions, using
resampling and an iteraï¿½ve step-down algorithm to preserve power. 50 The resulï¿½ng intervals
achieve balance, in the sense that each marginal interval covers the true parameter with the
same probability. Here we present a special case of their algorithm, which controls the
FWER.
    We wish to test í µí°¾í µí°¾ hypothesis about parameters {í µí¼ƒí µí¼ƒí µí±˜í µí±˜ }í µí°¾í µí°¾
                                                                í µí±˜í µí±˜=1 at level í µí»¼í µí»¼ . The sample size is í µí±›í µí±›.
                                         ï¿½
We assume that there are esï¿½mators í µí¼ƒí µí¼ƒí µí±˜í µí±˜ for each parameter í µí¼ƒí µí¼ƒí µí±˜í µí±˜ , such that í µí¼í µí¼í µí±›í µí±› í µí¼ƒí µí¼ƒí µí±˜í µí±˜ converges to
a nondegenerate distribuï¿½on, where í µí¼í µí¼í µí±›í µí±› is a nonnegaï¿½ve sequence. For example, í µí¼ƒí µí¼ƒí µí±˜í µí±˜ might
be the average treatment eï¬€ect or a quanï¿½le eï¬€ect, in which case í µí¼í µí¼í µí±›í µí±› = âˆší µí±›í µí±›. We will proceed
in a series of single-step tests. At each iteraï¿½on, we remove rejected hypotheses from con-
sideraï¿½on. The single-step algorithm is:

                     ï¿½í µí±˜í µí±˜ for each í µí±˜í µí±˜.
       1. Esï¿½mate í µí¼ƒí µí¼ƒ
       2. Sample í µí±›í µí±› observaï¿½ons at random with replacement from the data. You now have a
          bootstrap sample.
                     ï¿½í µí±˜í µí±˜í µí±˜í µí±˜
       3. Esï¿½mate í µí¼ƒí µí¼ƒ âˆ—
                               for each í µí±˜í µí±˜ on the bootstrap sample. Use the same esï¿½mator of step 1.
          Compute and store: í µí¼í µí¼í µí±›í µí±› ï¿½í µí¼ƒí µí¼ƒ ï¿½í µí±˜í µí±˜í µí±˜í µí±˜
                                              âˆ—          ï¿½í µí±˜í µí±˜ ï¿½.
                                                      âˆ’ í µí¼ƒí µí¼ƒ
       4. Repeat steps 2 and 3 í µí°µí µí°µ ï¿½mes.
       5. Compute the empirical CDF í µí°»í µí°»                              ï¿½í µí±˜í µí±˜í µí±˜í µí±˜
                                                      ï¿½ of í µí¼í µí¼í µí±›í µí±› ï¿½í µí¼ƒí µí¼ƒ âˆ—        ï¿½í µí±˜í µí±˜ ï¿½ across bootstrap replicaï¿½ons. For each
                                                                                âˆ’ í µí¼ƒí µí¼ƒ
          parameter í µí±˜í µí±˜ and bootstrap replicaï¿½on í µí±í µí±, you will have í µí°»í µí°»                                         ï¿½í µí±˜í µí±˜í µí±˜í µí±˜
                                                                                                    ï¿½ ï¿½í µí¼í µí¼í µí±›í µí±› ï¿½í µí¼ƒí µí¼ƒ âˆ—          ï¿½í µí±˜í µí±˜ ï¿½ï¿½.
                                                                                                                              âˆ’ í µí¼ƒí µí¼ƒ
       6. For each bootstrap replicaï¿½on í µí±í µí±, compute í µí±§í µí±§í µí±í µí± = maxí µí±˜í µí±˜ í µí°»í µí°»        âˆ—                                          ï¿½í µí±˜í µí±˜ ï¿½ï¿½.
                                                                                                                 ï¿½í µí±˜í µí±˜í µí±˜í µí±˜ âˆ’ í µí¼ƒí µí¼ƒ
                                                                                                   ï¿½ ï¿½í µí¼í µí¼í µí±›í µí±› ï¿½í µí¼ƒí µí¼ƒ âˆ—
                                                            âˆ— ( )
       7. Compute the í µí»¼í µí»¼-th quanï¿½le of í µí±§í µí±§í µí±í µí± , í µí±í µí± í µí»¼í µí»¼ . Note that it lies in the unit interval.
       8. For each parameter í µí±˜í µí±˜, compute the í µí±í µí± (í µí»¼í µí»¼ )-th quanï¿½le of í µí¼í µí¼í µí±›í µí±› ï¿½í µí¼ƒí µí¼ƒ                             ï¿½í µí±˜í µí±˜í µí±˜í µí±˜
                                                                                                                         âˆ—         ï¿½í µí±˜í µí±˜ ï¿½ across boot-
                                                                                                                               âˆ’ í µí¼ƒí µí¼ƒ
          strap replicates. This quanï¿½le is the criï¿½cal value for the í µí±˜í µí±˜-th hypothesis test.

To start the step-down algorithm, run the single-step algorithm. If you do not reject any hy-
pothesis, stop. If you do reject, go back to step 6. When you compute the maximum across
parameters, ignore previously rejected hypotheses. Step 7 will yield a diï¬€erent percenï¿½le for
use as a criï¿½cal value in step 8. Conï¿½nue in this fashion unï¿½l you stop rejecï¿½ng.

3. Uniform Inference

This subsecï¿½on discusses uniform inference: tesï¿½ng a single hypothesis about a conï¿½nuous
object, such as a funcï¿½on. Uniform inference allows us to address such quesï¿½ons as:

       â€¢    Are all quanï¿½le treatment eï¬€ects posiï¿½ve?


50
     Lee and Shaikh (2014) and List, Shaikh and Xu (2016) illustrate the algorithm with experimental data.
                                                                                                                                                          39
     â€¢   Is the distribuï¿½on of treatment eï¬€ects normal?

The disï¿½ncï¿½on between uniform inference and correcï¿½ons for mulï¿½ple tesï¿½ng can be sub-
tle. Uniform inference is concerned with single hypotheses about single continuous objects,
such as the quanï¿½le process or the distribuï¿½on funcï¿½on. Tesï¿½ng whether there was any
eï¬€ect on the outcome distribuï¿½on pertains to uniform inference, because we would test the
equality of two distribuï¿½on funcï¿½ons. On the other hand, tesï¿½ng which quanï¿½le eï¬€ects are
signiï¬cant is a problem of mulï¿½ple tesï¿½ng, because we would perform a sequence of
pointwise signiï¬cance tests for each esï¿½mate.
     Staï¿½sï¿½cians and econometricians have developed various tests of popular distribuï¿½onal
hypotheses, which are oï¿½en based on scalar staï¿½sï¿½cs. For example, consider the hypothesis
of posiï¿½ve quanï¿½le eï¬€ects. It is equivalent to ï¬rst-order stochasï¿½c dominance, for which we
have the Kolmogorov-Smirnov staï¿½sï¿½c (the largest absolute diï¬€erence between the out-
come distribuï¿½ons of treated and untreated parï¿½cipants). Chernozhukov, FernÃ¡ndez-Val and
Melly (2013) exploit this approach to construct bootstrap uniform conï¬dence bands, whose
width depends on the criï¿½cal values of the Kolmogorov-Smirnov staï¿½sï¿½c. 51 Uniform conï¬-
dence bands cover the enï¿½re funcï¿½on of interest with the correct probability, in the same
way that conï¬dence intervals cover point esï¿½mates. They have three advantages over scalar
test staï¿½sï¿½cs: they are easy to display on a graph; they allow researchers to test hypotheses
for which no known staï¿½sï¿½cs are available; and they allow readers to test hypotheses which
the authors of a paper may not have considered. 52

3. Tests of Heterogeneous Treatment Eï¬€ects

DIA builds on the premise that treatment responses vary across individuals. How can we test
this hypothesis?
    As far as heterogeneity relates to discrete covariates, signiï¬cant diï¬€erences in CATEs in-
dicate heterogeneity in individual responses. Such heterogeneity across subgroups is oï¿½en
interesï¿½ng in itself. Tests are standard, but researchers should adjust criï¿½cal values for MHT,
which oï¿½en takes a heavy toll on power. Crump et al. (2008) generalize this idea to accom-
modate discrete and conï¿½nuous covariates in both parametric and non-parametric esï¿½ma-
tors of condiï¿½onal means. They propose a scalar staï¿½sï¿½c, thereby avoiding MHT.
    The tests consider heterogeneity as it relates to observables and will thereby fail to de-
tect heterogeneity that is unrelated to observables. To test for any heterogeneity, we can
use the fact that the distribuï¿½ons of í µí±Œí µí±Œ0 and í µí±Œí µí±Œ1 only diï¬€er in means under the null. To test
whether treatment eï¬€ects are constant, therefore, we may test whether the variance of
outcomes is equal for the treated and untreated â€“ i.e., test whether var(í µí±Œí µí±Œ0 ) = var(í µí±Œí µí±Œ1 ). Sig-
niï¬cant diï¬€erences in the variance allow us to reject the null hypothesis. We can implement
such a pointwise test with the bootstrap algorithm of Subsecï¿½on 6.2.1. However, this test
may have low or no power if the covariance of í µí±Œí µí±Œ0 and í µí»¥í µí»¥ is negaï¿½ve: var(í µí±Œí µí±Œ1 ) = var(í µí±Œí µí±Œ0 ) +
var(í µí»¥í µí»¥) + 2 cov(í µí»¥í µí»¥, í µí±Œí µí±Œ0 ), so the negaï¿½ve covariance would oï¬€set the variance from treatment
eï¬€ect heterogeneity. The analyï¿½cal example in Secï¿½on 3.5 illustrates this point. The test may
also falsely reject in the presence of heteroskedasï¿½city, i.e., if the variances of the error
terms diï¬€er between treatment and control. Heteroskedasï¿½city may be a concern if random-

51
  See algorithms 2 (p. 2221) and 3 (p. 2222) in Chernozhukov, FernÃ¡ndez-Val and Melly (2013).
52
  For some esï¿½mators, the literature provides asymptoï¿½c theory to construct conï¬dence bands as well. For
quanï¿½le treatment eï¬€ects, see Chernozhukov, FernÃ¡ndez-Val and Melly (2013) and Koenker and Xiao (2002).
                                                                                                           40
izaï¿½on was compromised. Conducï¿½ng the test on residuals may address this concern and
increase power, but it may also lead to false rejecï¿½ons if the model is misspeciï¬ed.
    The idea in the previous paragraph generalizes to higher moments. Joint tests of mulï¿½ple
moments may achieve greater power. One can also use a test of equality of distribuï¿½ons,
such as the Kolmogorov-Smirnov test, to assess whether the distribuï¿½ons of deviaï¿½ons from
the mean diï¬€er between the treated and untreated. 53 Similar to the variance, one may be
worried that the distribuï¿½ons diï¬€er for other reasons if randomizaï¿½on was compromised.
    Further evidence against the null hypothesis of constant treatment eï¬€ects may come
from quanï¿½le eï¬€ects or bounds. If treatment eï¬€ects were constant, all quanï¿½le eï¬€ects
would be equal to the average treatment eï¬€ect. Implemenï¿½ng this approach requires either
correcï¿½ons for mulï¿½ple tesï¿½ng (Subsecï¿½on 6.2.2) or uniform inference (Subsecï¿½on 6.2.3).
One may also be able to reject the null if the variance bounds do not include zero, as Secï¿½on
4.2 discusses.

4. Power Calculaï¿½ons

This secï¿½on considers the choice of sample size for DIA in RCTs. We ï¬rst adapt the analyï¿½c
framework of List, Sadoï¬€ and Wagner (2011) to DIA. The complexiï¿½es of DIA oï¿½en render an
analyï¿½c approach undesirable or unfeasible, so we close with some guidance on power cal-
culaï¿½ons via simulaï¿½on.


1. Analytic Approach


An important choice in experimental design is the sample size. Due to cost consideraï¿½ons,
we seek the smallest sample for a desired level of precision.
    As a ï¬rst step, we must deï¬ne precision. Our criterion will be the signiï¬cance level and
the power of a parï¿½cular pointwise test against the zero null hypothesis (ZNH). 54 We wish to
determine the opï¿½mal sample size, í µí±›í µí±›âˆ— , and the opï¿½mal probability of assignment to treat-
ment, í µí±í µí±âˆ— , such that a test of the ZNH will reject a given minimum eï¬€ect size at signiï¬cance
level í µí»¼í µí»¼ with power 1 âˆ’ í µí»½í µí»½. These parameters reï¬‚ect the experimenterâ€™s tolerance of staï¿½sï¿½-
cal error. Here, í µí±›í µí±›âˆ— includes both treated and untreated parï¿½cipants. To derive the power of a
test, we need the asymptoï¿½c distribuï¿½on of the esï¿½mator of interest. For concreteness, we
focus on quanï¿½le treatment eï¬€ects under the independence assumpï¿½on of Secï¿½on 3.2. 55
Similar to ATTs, QTTs are asymptoï¿½cally normal. Therefore, we only need to specify their as-
ymptoï¿½c variance. Power calculaï¿½ons for QTTs and ATTs only diï¬€er in the exact form of this
variance.
    We proceed in four steps. For a quanï¿½le í µí¼í µí¼ of interest:


53
   Note that this test involves esï¿½mated parameters, which the bootstrap should account for. See Subsec-
ï¿½on 6.2.1.
54
   The ZNH states that the treatment had no eï¬€ect. It is the main hypothesis of interest in most RCTs. Other
null hypotheses are possible with the necessary modiï¬caï¿½ons. As a reminder, the signiï¬cance level is the
probability of a type I error in a two-sided test: rejecï¿½ng the null hypothesis when it is true (a false posiï¿½ve).
The power is the probability of rejecï¿½ng the null hypothesis when the alternaï¿½ve is true.
55
   We assume that the data are IID. For a discussion of clustered data and straï¿½ï¬ed designs, see Secï¿½on 4 of
List, Sadoï¬€ and Wagner (2011), and especially McConnell and Vera-HernÃ¡ndez (2015).
                                                                                                                     41
     1. Specify the quanï¿½le í µí±í µí±0 (í µí¼í µí¼) and the density í µí±“í µí±“0 [í µí±í µí±0 (í µí¼í µí¼)] of potenï¿½al outcomes í µí±Œí µí±Œ0 . Note
        that this quanï¿½le is the same under the null and the alternaï¿½ve hypotheses.
     2. Specify the quanï¿½le í µí±í µí±1 (í µí¼í µí¼) and the density í µí±“í µí±“1 [í µí±í µí±1 (í µí¼í µí¼)] of potenï¿½al outcomes í µí±Œí µí±Œ1 under
        the alternaï¿½ve hypothesis. Note that í µí±í µí±1 (í µí¼í µí¼) = í µí±í µí±0 (í µí¼í µí¼) and í µí±“í µí±“0 [í µí±í µí±0 (í µí¼í µí¼)] = í µí±“í µí±“1 [í µí±í µí±1 (í µí¼í µí¼)] under
        the null hypothesis of no treatment eï¬€ect.
     3. Deï¬ne a minimum detectable eï¬€ect size í µí±í µí±1 (í µí¼í µí¼) âˆ’ í µí±í µí±0 (í µí¼í µí¼), a signiï¬cance level í µí»¼í µí»¼ and a
        test power 1 âˆ’ í µí»½í µí»½. The RCT will detect treatment eï¬€ects equal to or greater than
        í µí±í µí±1 (í µí¼í µí¼) âˆ’ í µí±í µí±0 (í µí¼í µí¼) with error rates í µí»¼í µí»¼ and í µí»½í µí»½.
     4. Under the alternaï¿½ve hypothesis, the asymptoï¿½c variance of the esï¿½mator í µí±í µí±                              ï¿½ í µí±‡í µí±‡ (í µí¼í µí¼) is:

                                                         2
                                                                            í µí¼í µí¼(1 âˆ’ í µí¼í µí¼)
                                                    í µí¼í µí¼í µí±‡í µí±‡ (í µí¼í µí¼) =                               .
                                                                        í µí±“í µí±“í µí±‡í µí±‡ [í µí±í µí±í µí±‡í µí±‡ (í µí¼í µí¼)]2

          The opï¿½mal randomizaï¿½on rate, í µí±í µí±âˆ— (í µí¼í µí¼), and the sample size, í µí±›í µí±›âˆ— (í µí¼í µí¼), are:

                                                         í µí¼í µí¼1 (í µí¼í µí¼)
                               í µí±í µí±âˆ— (í µí¼í µí¼) =                              ,
                                             í µí¼í µí¼0 (í µí¼í µí¼) + í µí¼í µí¼1 (í µí¼í µí¼)
                                   âˆ—
                                                     í µí±§í µí±§í µí»¼í µí»¼â„2 + í µí±§í µí±§í µí»½í µí»½ 2 í µí¼í µí¼0
                                                                                 2
                                                                                   (í µí¼í µí¼)         2
                                                                                              í µí¼í µí¼1 (í µí¼í µí¼)
                               í µí±›í µí±› (í µí¼í µí¼) = ï¿½                               ï¿½ ï¿½            +             ï¿½,
                                                í µí±í µí±1 (í µí¼í µí¼) âˆ’ í µí±í µí±0 (í µí¼í µí¼) 1 âˆ’ í µí±í µí±âˆ— (í µí¼í µí¼) í µí±í µí±âˆ— (í µí¼í µí¼)

where í µí±§í µí±§í µí»¼í µí»¼â„2 and í µí±§í µí±§í µí»½í µí»½ are the quanï¿½les of the standard normal distribuï¿½on. Note that sample
sizes are larger for quanï¿½les in low-density regions, such as the tails of the outcome distri-
buï¿½on, because the scarcity of observaï¿½ons reduces accuracy.
       These same steps yield opï¿½mal sample sizes for other quanï¿½ï¿½es. The formulas for í µí±›í µí±›âˆ—
and í µí±í µí±âˆ— in step 4 go through as long as the esï¿½mator of interest is asymptoï¿½cally normal. 56
                                                                                                 2
Adjust steps 1 and 2 according to the object of interest and its asymptoï¿½c variance í µí¼í µí¼í µí±‡í µí±‡       . For
the average treatment eï¬€ect, for example, one should specify the mean and the variance of
                                                                            2
potenï¿½al outcomes instead of the quanï¿½le and the density, since í µí¼í µí¼í µí±‡í µí±‡      = var(í µí±Œí µí±Œí µí±‡í µí±‡ ).
       The procedure above considers a parï¿½cular quanï¿½le of interest. In most applicaï¿½ons,
however, researchers compute quanï¿½le eï¬€ects on a grid. Three diï¬ƒculï¿½es arise. The ï¬rst
consists of formulaï¿½ng disï¿½nct hypothesis tests for each quanï¿½le. It is oï¿½en simpler to think
in terms of the enï¿½re distribuï¿½on. For example, a locaï¿½on model assumes that the distribu-
                                                                                                2( )
ï¿½on shiï¿½s by a constant. Then all quanï¿½le eï¬€ects are equal to that constant and í µí¼í µí¼0             í µí¼í µí¼ =
    2
í µí¼í µí¼1 (í µí¼í µí¼), which reduces the number of free parameters by two thirds. Secondly, the sample
size í µí±›í µí±›âˆ— (í µí¼í µí¼) and the randomizaï¿½on rate í µí±í µí±âˆ— (í µí¼í µí¼) diï¬€er for each quanï¿½le. 57 One should choose
the largest sample size across í µí¼í µí¼ to ensure correct test size and power at all points. Note,
though, that the formulas above are invalid for extremal eï¬€ects. It is advisable to avoid esï¿½-
maï¿½on of extremal eï¬€ects â€“ beyond the 5th and 95th percenï¿½les, say. Lastly, grid esï¿½maï¿½on
implies mulï¿½ple hypothesis tesï¿½ng, invalidaï¿½ng the formulas above. There are two soluï¿½ons
to this problem. It is possible to adjust criï¿½cal values for repeated tesï¿½ng (cf. Secï¿½on 6.2).
However, this approach involves complex algorithms and many unknown quanï¿½ï¿½es, which
limits its usefulness. Simulaï¿½on oï¬€ers a more feasible route, which we survey in the next

56
   It is also possible to use ï¬nite-sample distribuï¿½ons instead of the asymptoï¿½c normal approximaï¿½on when
they are available. See Koenker (2005) and Chernozhukov, Hansen and Jansson (2009) for quanï¿½le treatment
eï¬€ects.
57
   For a locaï¿½on model, í µí±í µí±âˆ— (í µí¼í µí¼) = 0.5 for all í µí¼í µí¼.
                                                                                                                                      42
subsecï¿½on. The closed-form formulas provide a ï¬rst guess of sample size to start the simu-
laï¿½on algorithm.
    If researchers intend to conduct subgroup analysis, the choice of sample size and ran-
domizaï¿½on rate should also take MHT into account. Otherwise, signiï¬cance levels will be
higher and/or test power will be lower than planned. Note that the number of observaï¿½ons
might dramaï¿½cally increase with the number of tests. Spliï¿½ng samples might help keep the
RCT ï¬nancially viable. This approach splits the sample into two subsamples. In one subsam-
ple, an automated procedure selects a small set of relevant covariates. In the second sub-
sample, we esï¿½mate the resulï¿½ng model and test the signiï¬cance of each variable, limiï¿½ng
data requirements. For further details, see Wasserman and Roeder (2009), Fithian, Sun and
Taylor (2017) and Fafchamps and Labonne (2016) and the references therein.

2. Simulation Approach

Simulaï¿½on is an alternaï¿½ve strategy to determine the required sample size. Simulaï¿½on for
DIA presents no parï¿½cular challenge, so we only sketch a brief overview here. See
McConnell and Vera-HernÃ¡ndez (2015) for details. They also provide an algorithm and sam-
ple code.
    Similar to the previous subsecï¿½on, the selecï¿½on criteria are the signiï¬cance and power
of a hypothesis test against the ZNH. Instead of compuï¿½ng these error probabiliï¿½es with as-
ymptoï¿½c methods, however, we use simulaï¿½on. To be precise, we simulate pseudo-samples
from the model of interest under the null and the alternaï¿½ve hypothesis. For each pseudo-
sample, we perform the relevant hypothesis test. Then we adjust the number of observa-
ï¿½ons unï¿½l empirical rejecï¿½on rates saï¿½sfy the desired level of accuracy.
    Simulaï¿½on oï¬€ers a number of advantages over asymptoï¿½c theory. Firstly, it accommo-
dates esï¿½mators with unknown or excessively complex asymptoï¿½c distribuï¿½on (e.g., the IPW
esï¿½mator of QTTs), as well as diï¬ƒcult inference problems (e.g., uniform inference or mulï¿½-
ple hypotheses). Secondly, it reï¬‚ects the ï¬nite-sample behavior of esï¿½mators which might
converge slowly to their limiï¿½ng distribuï¿½on. Thirdly, it is straighï¿½orward to incorporate
complex designs, such as panel data.
    To conduct a simulaï¿½on exercise, it is necessary to choose the number of pseudo-
samples. Unless the computaï¿½onal burden is high, it should be large: ï¬ve thousand or ten
thousand are good ï¬gures. One also needs to specify the data generaï¿½ng process. Choosing
distribuï¿½ons of covariates and the error term is oï¿½en challenging: they should reproduce
the condiï¿½ons of the RCT, including dependence paterns in the error term (such as clusters
or serial correlaï¿½on in panel data). Previous studies might provide some guidance. If an ex-
isï¿½ng dataset contains the covariates of interest (or some of them), it is possible to draw
pseudo-samples from it to minimize distribuï¿½onal assumpï¿½ons. Sensiï¿½vity analyses are al-
ways advisable.

7. Applicaï¿½ons
In this part, we present applicaï¿½ons of the methods discussed above using data from two
RCTs. Secï¿½on 7.1 revisits the study of ï¬nancial educaï¿½on by Bruhn et al. (2016). In Secï¿½on
7.2, we study the impact of a school-development program on studentsâ€™ test scores, building
on Blimpo, Evans and Lahire (2016). The goal of this part is threefold: (1) to demonstrate
what we can learn from DIA beyond standard mean analyses; (2) to provide examples of
                                                                                               43
how to choose appropriate methods and how to assess their assumpï¿½ons and address
common concerns; and (3) to illustrate brieï¬‚y the implementaï¿½on of the methods and their
output. 58 The programs corresponding to these analyses can be found in the supplemental
materials available online.

1. Financial Educaï¿½on RCT in Brazil

This secï¿½on revisits the ï¬nancial educaï¿½on program evaluated by Bruhn et al. (2016). Com-
prehensive lessons in basic ï¬nance and responsible intertemporal choices were integrated
into regular classroom curricula of randomly selected high schools. The program increased
average ï¬nancial proï¬ciency by a quarter of a standard deviaï¿½on, which is large in compari-
son with similar programs (Bruhn et al., 2016).
    However, policymakers may wish for more informaï¿½on than average eï¬€ects. For in-
stance, they may take parï¿½cular interest in low values of ï¬nancial proï¬ciency, which might
put consumers at risk of pyramid schemes and other predatory tacï¿½cs. They may want to
ï¬ne tune the program if they observe no change in the frequency of botom scores. In a sim-
ilar vein, governments may worry about dispersion in ï¬nancial proï¬ciency, which could
aï¬€ect the rewards from ï¬nancial inclusion. They may also ask whether eï¬€ects diï¬€ered across
subgroups, which could help them target the intervenï¿½on and understand why it works (or
not). If poverty is associated with low ï¬nancial proï¬ciency, for example, we might advocate
addiï¿½onal ï¬nancial educaï¿½on for children from poor households. To explore these ques-
ï¿½ons, we esï¿½mate several DIA parameters, mostly related to changes in the outcome distri-
buï¿½on (Part 3) and condiï¿½onal analysis (Part 5).

1. Data

Our sample includes 892 schools and 18,276 students in six states in Brazil. 59 We focus on
the short-term impact between the baseline survey (August 2010) and the ï¬rst follow-up
(December 2010). 60 We observe three-quarters of the original baseline sample of around
25,000 students at the ï¬rst follow-up. The authors report that the groups are overall bal-
anced across treatment and control groups at each round of data collecï¿½on. 61
   We focus on ï¬nancial proï¬ciency as the outcome of interest. Each survey included a
mulï¿½ple-choice test, from which Bruhn et al. (2016) construct an index of ï¬nancial
knowledge on a hundred-point scale to track studentsâ€™ progress. We use this score for our
analyses. For future reference, the average score in the control group at the ï¬rst follow-up is
56.05 and the standard deviaï¿½on is 14.81.

2. Changes in the Distribution of Financial Proï¬ciency

Did the intervenï¿½on change the frequency of very low test scores? Did it change dispersion
in ï¬nancial proï¬ciency? Did it reshape the proï¬ciency distribuï¿½on?

58
   We focus on DIA and DIA-speciï¬c issues. The original papers discuss soluï¿½ons to other common problems
that aï¬€ect both DIA and the esï¿½maï¿½on of average treatment eï¬€ects.
59
   From an original list of 910 schools, nineteen did not parï¿½cipate for unknown reasons.
60
   The dataset is available from the American Economic Journal: Applied Economics.
61
   As an excepï¿½on, the authors ï¬nd a small diï¬€erence in the gender raï¿½o, which is signiï¬cant at the 10% level
(these tests are unadjusted for mulï¿½ple hypothesis tesï¿½ng).
                                                                                                                44
                   Figure 5: Outcome Distributions for Financial Education Program

     To answer these quesï¿½ons, we examine treatment eï¬€ects on a broad set of parameters:
the mean, the standard deviaï¿½on and the raï¿½o of the 75th to the 25th percenï¿½le; every per-
cenï¿½le between the 5th and the 95th; and the CDF for every integer score between 33 and
81. 62 We consider a total of 143 parameters. We assume independence between outcomes
and treatment status (cf. Secï¿½on 3.2). The intervenï¿½on began halfway into the school year,
so students could not change schools or classes before the ï¬rst follow-up, limiï¿½ng noncom-
pliance with treatment assignment. On the other hand, nonresponse may be a concern: only
three-quarters of the baseline sample took the follow-up survey. However, Bruhn et
al. (2016) ï¬nd no signiï¬cant diï¬€erences in the means of background variables at each round,
which suggests that nonresponse is as good as random.
     Figure 5 plots the outcome distribuï¿½on for each group. Table 3 and Table 4 show esï¿½-
mates of treatment eï¬€ects. 63 All conï¬dence intervals control the FWER at the 95-percent
level using the step-down bootstrap algorithm of Romano and Wolf (2010), see Subsecï¿½on
6.2.2. Thus, the probability of at least one false rejecï¿½on across all signiï¬cance tests is as-
ymptoï¿½cally smaller than ï¬ve percent.
     We ï¬nd a large increase in average ï¬nancial proï¬ciency: 4.3 points (0.29 SD or 7.6%), in
line with Bruhn et al. (2016). There was also a reducï¿½on in the proporï¿½on of very low scores.
For example, the share of scores below 40 points is lower by 0.08, a 45.8% reducï¿½on from
0.17 in the control group. Outcomes are also less dispersed in the treatment group: the
standard deviaï¿½on is smaller by 0.46 points, a 3.12% reducï¿½on of the 14.81 points in the
control group, and the raï¿½o of the 75/25 quarï¿½les is reduced by 7.5% from 1.53 in the con-
trol group. All of these eï¬€ects are staï¿½sï¿½cally signiï¬cant. In summary, the intervenï¿½on not
only increased average scores, but also decreased inequality in ï¬nancial proï¬ciency.
     Quanï¿½le eï¬€ects provide further insight into these results. As Figure 6 shows, the inter-
venï¿½on shiï¿½ed the enï¿½re CDF to the right. Recall that quanï¿½le eï¬€ects are the horizontal dis-
tance between these curves; hence, they are all posiï¿½ve (and staï¿½sï¿½cally signiï¬cant). More-
over, the change in lower quanï¿½les is relaï¿½vely larger. The ï¬rst decile increased by 4.2 points
or 11.5%. The ï¬rst quarï¿½le is greater by 6.2 points (14.1%), whereas the diï¬€erence in the
ninth decile is 3.2 points (4.27%). A Kolmogorov-Smirnov test rejects equality of quanï¿½le

62
   The 5th percenï¿½le of control-group outcomes is 32.95. The 95th is 80.46.
63
   Figure 12 in Appendix 4 shows changes in the distribuï¿½on funcï¿½on (the verï¿½cal distance between the CDFs
in Figure 5). These eï¬€ects mirror quanï¿½le eï¬€ects.
                                                                                                             45
                Table 3: Treatment Eï¬€ects Estimates for Financial Education Program
                               Control        Eï¬€ect esï¿½mate         Standard      Simultaneous
      Staï¿½sï¿½c
                             group value     Value    Percent         error     conf. region (95%)
      Mean                     56.050        â€“â€Š4.266   1â€“â€Š7.611%      0.571      â€“â€Š2.671   â€“â€Š5.861
      Standard deviaï¿½on        14.808        â€“â€Š0.462   1â€“â€Š3.119%      0.201      â€“â€Š0.853   â€“â€Š0.071
      75/25 perc. raï¿½o         01.530        â€“â€Š0.119   1â€“â€Š7.748%      0.020      â€“â€Š0.172   â€“â€Š0.066
      10th percenï¿½le           36.302        â€“â€Š4.177   â€“â€Š11.505%      0.582      â€“â€Š2.552   â€“â€Š5.802
      25th percenï¿½le           43.867        â€“â€Š6.189   â€“â€Š14.109%      0.843      â€“â€Š3.933   â€“â€Š8.446
      50th percenï¿½le           56.157        â€“â€Š4.642   1â€“â€Š8.266%      0.700      â€“â€Š2.717   â€“â€Š6.568
      75th percenï¿½le           67.138        â€“â€Š3.537   1â€“â€Š5.268%      0.575      â€“â€Š1.889   â€“â€Š5.185
      90th percenï¿½le           75.812        â€“â€Š3.236   1â€“â€Š4.269%      0.572      â€“â€Š1.536   â€“â€Š4.937
      CDF at 40 points         00.172        â€“â€Š0.079   â€“â€Š45.742%      0.011      â€“â€Š0.109   â€“â€Š0.049
      CDF at 50 points         00.365        â€“â€Š0.116   â€“â€Š31.806%      0.016      â€“â€Š0.160   â€“â€Š0.073
      CDF at 60 points         00.593        â€“â€Š0.114   â€“â€Š19.236%      0.016      â€“â€Š0.159   â€“â€Š0.070
      CDF at 70 points         00.806        â€“â€Š0.071   1â€“â€Š8.864%      0.012      â€“â€Š0.106   â€“â€Š0.038
      CDF at 80 points         00.945        â€“â€Š0.032   1â€“â€Š3.373%      0.006      â€“â€Š0.049   â€“â€Š0.015
       Notes: Standard errors and conï¬dence region based on the bootstrap (ï¬ve thousand replica-
       ï¿½ons) and clustered at the school level. The conï¬dence region controls the FWER (probability
       of at least one false rejecï¿½on across tests), following Romano and Wolf (2010).

eï¬€ects at the 5% level. This patern reveals that the reducï¿½on in outcome inequality oc-
curred despite increases of the upper percenï¿½les (which are desirable in an educaï¿½onal pro-
gram). It was a consequence of proporï¿½onally larger gains in the leï¿½ tail.
    How would we esï¿½mate these treatment eï¬€ects under the assumpï¿½on of selecï¿½on on
observables? For illustraï¿½on purposes, suppose that a small imbalance in the gender raï¿½o
and baseline scores generated suspicion of selecï¿½on bias. Following Secï¿½on 3.3, we can use
inverse probability weighting to rebalance groups. We compute the weights with a logisï¿½c
regression of treatment status on a quadraï¿½c polynomial of baseline scores, an indicator for
missing baseline score and an indicator for gender. Table 9 in Appendix 4 show our results.
Although the rebalanced esï¿½mates are smaller than their unweighted counterparts, the
diï¬€erences are not staï¿½sï¿½cally signiï¬cant, which suggests that endogenous selecï¿½on did not
aï¬€ect our main results. Bruhn et al. (2016) arrived at a similar conclusion, although their




                Figure 6: Quantile Eï¬€ects Estimates for Financial Education Program

                                                                                                      46
methodology diï¬€ers. 64

3. Distribution of Individual Treatment Eï¬€ects

Quanï¿½le analysis helps us address a broad range of policy quesï¿½ons. Nonetheless, the pos-
sibility of mobility eï¬€ects constrains our interpretaï¿½on of quanï¿½le eï¬€ects, in that the change
in quanï¿½le í µí¼í µí¼ may diï¬€er from the individual treatment eï¬€ect at quanï¿½le í µí¼í µí¼. Consider Figure 6.
It is tempï¿½ng to believe that low-scoring students beneï¬ted more than average, since the
change in botom percenï¿½les is relaï¿½vely larger. As Part 2 and Secï¿½on 3.5 argue, however,
this reasoning hinges on an implicit assumpï¿½on of rank invariance: the same students are in
the botom and the top of the distribuï¿½on in both treated and untreated states.
     Despite this limitaï¿½on, our esï¿½mates in Table 3 and Figure 6 have implicaï¿½ons for indi-
vidual eï¬€ects. Dispersion decreased, so responses to treatment must have been heteroge-
neous. Moreover, posiï¿½ve average and quanï¿½le eï¬€ects imply that at least some parï¿½cipants
beneï¬ted from the intervenï¿½on. However, the methods of Part 3 do not allow us to quanï¿½fy
these qualitaï¿½ve results.
     Esï¿½maï¿½ng features of the distribuï¿½on of individual eï¬€ects requires strong assumpï¿½ons
(cf. Secï¿½on 4.3), which are hard to jusï¿½fy in this applicaï¿½on. As an alternaï¿½ve, Secï¿½on 4.2
shows that we can construct bounds under minimal condiï¿½ons. As a ï¬rst exercise, we esï¿½-
mate the Makarov bounds on the share of posiï¿½ve eï¬€ects, P(í µí±Œí µí±Œ1 > í µí±Œí µí±Œ0 ). Recall that the
bounds comprise the range of values which are consistent with the observed marginal dis-
tribuï¿½ons. We ï¬nd that the probability of posiï¿½ve individual treatment eï¬€ects lies between
12% and 100%. 65 These bounds conï¬rm that at least some parï¿½cipants beneï¬ted from the
intervenï¿½on; moreover, the data are compaï¿½ble with no one being hurt, because the
bounds include 100% posiï¿½ve eï¬€ects. Next, we bound the standard deviaï¿½on of individual
eï¬€ects. Assuming that the correlaï¿½on between potenï¿½al outcomes is posiï¿½ve, we obtain
that it lies between 0.46 and 20.62 points. The lower limit is posiï¿½ve, 66 which rules out con-
stant treatment eï¬€ects. At 0.46 points, the lower bound represents nearly 11% of the ATT,
suggesï¿½ng that the dispersion in treatment eï¬€ects is non-negligible. To summarize, these
bounds suggest the existence of heterogeneous individual treatment eï¬€ects under minimal
assumpï¿½ons on the data.

4. Conditional Analysis

The previous subsecï¿½ons showed that studentsâ€™ responses to the ï¬nancial educaï¿½on pro-
gram were heterogeneous. This secï¿½on invesï¿½gates the relaï¿½on between treatment impacts
and pupilsâ€™ background characterisï¿½cs. For that purpose, we compute condiï¿½onal average
eï¬€ects (CATEs) and condiï¿½onal QTTs for diï¬€erent subgroups of parï¿½cipants, following Sec-
ï¿½on 5.2. 67


64
   Bruhn et al. (2016) compute average treatment eï¬€ects by linear regression. They include a quadraï¿½c poly-
nomial of baseline scores, an indicator for missing baseline score and an indicator for gender as controls. The
resulï¿½ng esï¿½mate is not staï¿½sï¿½cally diï¬€erent from their baseline regression, which does not include controls.
65
   Note that we do not perform inference to assess the precision of these bounds.
66
   The 95% conï¬dence interval is [0.07, 20.89] (Imbens and Manski, 2004). Under no assumpï¿½ons on the corre-
laï¿½on between potenï¿½al outcomes, the upper bound is 29.15 and the conï¬dence region is [0.07, 29.54].
67
   We compute treatment eï¬€ects as the diï¬€erence in the relevant staï¿½sï¿½c between the treatment and control
subsamples of each subgroup (cf. Secï¿½on 5.2), as in Subsecï¿½on 7.1.2.
                                                                                                                  47
               Table 4: Conditional Average Treatment Eï¬€ects for Financial Education Program
                                    Sample         Eï¬€ect esï¿½mate           Standard        Simultaneous
              Subgroup
                                      size        Value     Percent          error       conf. region (95%)
     Baseline score          No      17960         4.120       8.417%        0.476        2.891        5.349
       above median          Yes     17960         4.069       6.345%        0.588        2.508        5.631
     Student has repeat-     No      10949         4.472       7.634%        0.607        2.866        6.079
       ed grade              Yes     14437         4.653       9.112%        0.665        2.950        6.355
                             No      16941         4.977       8.588%        0.673        3.227        6.728
     Student is female
                            Yes     18720        3.806       6.855%         0.609        2.209         5.403
                            No      10898        4.188       7.311%         0.613        2.589         5.788
     Student works
                            Yes     15612        4.722       8.671%         0.702        2.919        6.525
     Student earns          No      15713        3.585       6.163%         0.624        1.943        5.228
       income               Yes     10812        4.682       8.877%         0.628        3.061        6.304
     Family is on welfare   No      10216        5.020       8.301%         0.658        3.294        6.746
       (Bolsa FamÃ­lia)      Yes     15334        3.386       5.833%         0.678        1.671        5.101
     Notes: The ï¬rst four speciï¬caï¿½ons include 848 schools. The last two include 851 schools. Standard errors
     and conï¬dence region based on the bootstrap (ï¬ve thousand replicaï¿½ons) and clustered at the school lev-
     el. The conï¬dence region controls the FWER (probability of at least one false rejecï¿½on across tests), follow-
     ing Romano and Wolf (2010).

    Based on the available data, we consider six background variables: (1) baseline proï¬cien-
cy score (above or below median); (2) grade repeï¿½ï¿½on; (3) gender; (4) family welfare status
(Bolsa FamÃ­lia); (5) working status; and (6) income-earning status (i.e., whether the student
earns any income, including pocket money). Each variable deï¬nes two subgroups. 68 Table 1
in Bruhn et al. (2016) reports summary staï¿½sï¿½cs and balance tests by variable.
    Table 4 displays our esï¿½mates of CATEs. Table 5 reports t-staï¿½sï¿½cs for the diï¬€erence in
CATEs. We perform six equality tests in total; hence, we must adjust for mulï¿½ple tesï¿½ng
(MHT). In Subsecï¿½on 7.1.2, we controlled the FWER (the probability of at least one false re-
jecï¿½on). Although this error rate is the most stringent, all eï¬€ects were signiï¬cant at the ï¬ve-
percent level. Evidence of condiï¿½onal heterogeneity is less robust. Therefore, Table 5 shows
criï¿½cal values for the 2-FWER (the probability of at least two false rejecï¿½ons) as well. We use
the step-down bootstrap algorithm of Romano and Wolf (2010). (See Subsecï¿½on 6.2.2.)
    Responses to treatment seem to correlate with socioeconomic background. The families
of a third of our sample parï¿½cipate in Bolsa FamÃ­lia, a welfare program for low-income
households. On average, these students gained signiï¬cantly less from the intervenï¿½on (3.39
points, against 5.02 for the remainder). This diï¬€erence is signiï¬cant at the ten-percent level
if we control the FWER. We only ï¬nd weak evidence of heterogeneity otherwise. Boys had
higher average gains than girls (4.98, against 3.81). The average eï¬€ect was also larger for
students with earned income (4.68, against 3.59). However, these diï¬€erences are only sig-
niï¬cant if we control the 2-FWER, i.e., if we are willing to tolerate a ï¬ve-percent chance of
two false rejecï¿½ons in six tests. Other criteria do not yield signiï¬cant eï¬€ects, whether we
control the FWER or the 2-FWER.



68
   A number of parï¿½cipants declined to answer the relevant quesï¿½ons in the surveys, depressing response
rates to 64â€‰%. For rigorous policy evaluaï¿½on, it would be necessary to assess robustness to missing observa-
ï¿½ons.
                                                                                                                     48
      Table 5: Critical Values for Test of Equality of Average Eï¬€ects for Financial Education Program
                                              5% conï¬dence level                10% conï¬dence level
          Subgroup            t-stat.    Point-                             Point-
                                                    1-FWER      2-FWER                 1-FWER      2-FWER
                                          wise                               wise
     Baseline score above
                             â€“â€Š0.095      1.913      2.615       1.890       1.619      2.325       1.696
       median
     Student has repeated
                             â€“â€Š0.284      1.914      2.498       1.884       1.609      2.284       1.688
       grade
     Student is female
                             â€“â€Š2.219      1.979      2.622       1.955       1.660      2.374       1.759
     Student works
                             â€“â€Š0.850      1.957      2.695       1.930       1.677      2.427       1.752
     Student earns
                               â€“â€Š2.139    1.970       2.597       1.929      1.648       2.344      1.711
       income
     Family is on welfare
                               â€“â€Š2.407    1.998       2.645       1.957      1.636       2.357      1.723
       (Bolsa FamÃ­lia)
     Notes: Bold values indicate rejecï¿½on of the null hypothesis. The ï¬rst four speciï¬caï¿½ons include 848
     schools. The last two include 851 schools. Criï¿½cal values based on bootstrapping t-staï¿½sï¿½cs (ï¬ve thou-
     sand replicaï¿½ons) and clustered at the school level. Columns 4, 5, 7 and 8 control the k-FWER via the
     step-down algorithm of Romano and Wolf (2010).

    Figure 7 plots esï¿½mates of ï¬ve condiï¿½onal quanï¿½le eï¬€ects for each subgroup. 69 Paterns
are similar to Figure 6, with eï¬€ects peaking around the ï¬rst quarï¿½le. The only clear excep-
ï¿½on is students whose baseline score was above the median, for which quanï¿½le eï¬€ects are
monotonically decreasing. Are diï¬€erences between subgroups signiï¬cant? There are two
approaches to this quesï¿½on. On the one hand, we could test whether the diï¬€erence be-
tween each quanï¿½le eï¬€ect in each pair of subgroups is signiï¬cant. However, this approach
would require thirty hypothesis tests; adjusï¿½ng for MHT would take a heavy toll on power.
On the other hand, we could test whether all quanï¿½le eï¬€ects are equal in each pair of sub-
groups. To do so, we could test the maximum absolute diï¬€erence in quanï¿½le eï¬€ects across
quanï¿½les, 70 which only requires six tests. This second procedure reveals that quanï¿½le eï¬€ects
only diï¬€er between subgroups deï¬ned by baseline scores and gender, controlling the FWER
at the ten-percent level. These results point to heterogeneity both between and within sub-
groups, which average eï¬€ects did not uncover.
    Note that these esï¿½mates are not informaï¿½ve about causal eï¬€ects of the characterisï¿½cs
that deï¬ne the subgroups, because students do not sort into subgroups at random. Note
also that we did not take the overlaps between subgroups into account. For example, stu-
dents might be more likely to work if their families are on welfare. Subgroup analysis might
provide addiï¿½onal insights as we break down cells into smaller groups. However, the number
of observaï¿½ons per cell would decrease just as the number of hypothesis tests increased, to
the detriment of staï¿½sï¿½cal power.




69
   The quanï¿½les are: the 10th, the 25th, the 50th, the 75th and the 90th. Table 10 in Appendix 3 reports point
esï¿½mates and standard errors.
70
   This procedure tests for signiï¬cant diï¬€erences in at least one quanï¿½le eï¬€ect for each pair of subgroups. It
cannot detect all quanï¿½le eï¬€ects for which there are signiï¬cant diï¬€erences.
                                                                                                                 49
         Figure 7: Conditional Quantile Treatment Eï¬€ects for Financial Education Program

    On a methodological note, Table 5 highlights the importance of correcï¿½ng for mulï¿½ple
tests (even at large sample sizes). Controlling the FWER inï¬‚ates criï¿½cal values by 30 to
50 percent. As a consequence, only one diï¬€erence in average eï¬€ects remains signiï¬cant,
compared to three if we do not adjust. The choice of error rate is also consequenï¿½al.
Whereas control of the FWER always widens conï¬dence regions, other criteria may not. For
example, control of the 2-FWER leads to smaller criï¿½cal values at the 95-percent level and
larger cutoï¬€s at the 90-percent level. To understand this puzzling feature, recall that the
probability of two or more false rejecï¿½ons across six pointwise tests at the ï¬ve-percent level
is 3.28%, which is lower than the nominal ï¬ve-percent level. Therefore, criï¿½cal values adjust
downwards. At the 10-percent level, it is 11.43%. Hence, criï¿½cal values adjust upwards.

5. Power Calculations

This dataset includes 18,276 observaï¿½ons, which allowed us to obtain precise esï¿½mates of a
rich parameter set. However, DIA is feasible with much smaller samples. This subsecï¿½on
looks into the choice of sample size for this RCT.

                                                                                                 50
       Table 6: Optimal Sample Sizes for Financial Education Program by Quantile Treatment Eï¬€ect
                                                 Minimum detectable eï¬€ect
                      +1%           +5%     +10%         +15% +1 point       +5 pts.   +10 pts.    +15 pts.
     10th perc.     67920          2828       743          347      8862         985       354         181
     20th perc.     72109          3002       789          368     12194       1355        488         249
     30th perc.     90478          3767       990          462     19492       2166        780         398
     40th perc.     61993          2581       678          317     16371       1819        655         334
     50th perc.     46217          1924       506          236     14430       1603        577         294
     60th perc.     38287          1594       419          196     13792       1532        552         281
     70th perc.     33043          1376       361          169     13753       1528        550         281
     80th perc.     28562          1189       312          146     13731       1526        549         280
     90th perc.     27957          1164       306          143     15908       1768        636         325
     Notes: The table shows the smallest sample size, such that a pointwise two-sided test of the zero null
     hypothesis detects a given treatment eï¬€ect with size 5% and power 80%. See Subsecï¿½on 6.3.1.

    We follow the approach of Subsecï¿½on 6.4.1. We compute the opï¿½mal sample size to de-
tect a given minimum eï¬€ect on each decile. We ï¬x the signiï¬cance level at 5% and power at
80%. We must also parametrize the asymptoï¿½c variance of our esï¿½mator of interest. For
quanï¿½le eï¬€ects, it depends on the density of outcomes, which we compute from the control
group. 71 In an applicaï¿½on, researchers might obtain the density funcï¿½on based on a baseline
sample, previous studies and parametric assumpï¿½ons.
    Table 6 reports our results for a typical random control trial without any adjustments.
Small eï¬€ects require large samples: detecï¿½ng an increase of 1% in the 10th percenï¿½le re-
quires a total of 67,920 observaï¿½ons. However, moderate samples suï¬ƒce for modest eï¬€ects.
For instance, to detect increases around 10% in each decile would have required a sample
for around 990 in the 30th decile.
    Table 6 does not adjust sample sizes for mulï¿½ple hypothesis tests or clustering, which
would raise data requirements. The formula for the opï¿½mal sample size in Subsecï¿½on 6.4.1
depends on the square of the criï¿½cal values. In Subsecï¿½on 7.1.2, we controlled the FWER
across 143 tests, inï¬‚aï¿½ng cutoï¬€s by up to 50%. Such a correcï¿½on would increase the rec-
ommended sample size by a factor of 2.25. Esï¿½maï¿½ng fewer parameters would reduce this
adjustment. For instance, suppose that we focus on the mean and the deciles (a total of ten
parameters). Then, control of the FWER increases criï¿½cal values by 30%, which implies mul-
ï¿½plying the sample size by a factor of 1.7. As for clustering, the opï¿½mal sample size is pro-
porï¿½onal to the variance of the esï¿½mator of interest. In our applicaï¿½on, accounï¿½ng for clus-
tering increases variances by a factor between 4 and 7.
    Combining these rules of thumb, our esï¿½mates of each quanï¿½le eï¬€ect (see Table 3 and
Figure 6) and the formula for the opï¿½mal sample size (see Subsecï¿½on 6.4.1), we ï¬nd that the
opï¿½mal sample sizes for this RCT would be 12,000 observaï¿½ons if we control the FWER
across all 143 parameters and 9,000 observaï¿½ons if we only control the FWER across the
mean and the deciles. Note that adjustments for mulï¿½ple tesï¿½ng and clustering are un-
known at the design stage. Simulaï¿½ons may help researchers incorporate these features into
their choice of sample size. See Subsecï¿½on 6.4.2.




71
     We use the Epanechnikov kernel and the Sheather-Jones plug-in bandwidth.
                                                                                                              51
6. Takeaways

These empirical examples highlight several points about the importance of going beyond
average treatment eï¬€ects. First, it is diï¬ƒcult to summarize the impact of an intervenï¿½on
with any single staï¿½sï¿½c. In parï¿½cular, average eï¬€ects oï¿½en hide signiï¬cant heterogeneity.
Second, we gain important insights from the changes in the shape of the distribuï¿½on. Quan-
ï¿½le analysis and other DIA methods allow us to address a broader range of policy concerns
than means alone under minimal assumpï¿½ons. Third, condiï¿½onal analysis is a complement
and not a subsï¿½tute for uncondiï¿½onal approaches. Each method reveals a diï¬€erent dimen-
sion of heterogeneity. Finally, our analysis illustrates methodological issues in DIA, such as
correcï¿½ng for mulï¿½ple tesï¿½ng.

2. School Management RCT in The Gambia

In this secï¿½on, we use the methods in this toolkit, focusing on those in Part 4, to re-analyze
the impact of the Whole School Development Program (WSDP). The WSDP was administered
as part of an RCT in The Gambia from 2007 to 2011 and evaluated by Blimpo, Evans and La-
hire (2016). The program aims to improve school quality by training school leaders and
community members in school management techniques. Each of 273 Gambian primary
schools was randomly assigned to one of three groups. Ninety schools in the ï¬rst treatment
arm were oï¬€ered the WSDP, which provided principals, certain teachers and community
members with a comprehensive training program in school management. These schools
were also given a $â€Š500 grant to help cover costs associated with implemenï¿½ng new iniï¿½a-
ï¿½ves based on the training. To disentangle the impact of the WSDP training from the impact
of the grant, 94 schools in the second treatment arm (â€œgrant onlyâ€) received the $â€Š500 grant
without any addiï¿½onal training. In the third arm, 89 schools served as the control group and
received no treatment.
    Blimpo, Evans and Lahire (2016) ï¬nd that the average impact of the WSDP treatment on
test scores is approximately zero and staï¿½sï¿½cally insigniï¬cant when looking at impacts sepa-
rately by grade and year. Zero average eï¬€ects are consistent with a program having no im-
pact or with a program having heterogeneous impacts, beneï¬ï¿½ng some schools and hurï¿½ng
others. In order to disï¿½nguish between these two cases we use the methods discussed in
Part 4 to esï¿½mate the variance of treatment eï¬€ects and, relying on strong assumpï¿½ons, the
enï¿½re distribuï¿½on of treatment eï¬€ects. The results of these exercises are important for poli-
cy: If there is treatment eï¬€ect heterogeneity the program could become eï¬€ecï¿½ve if beter
targeted at those with posiï¿½ve treatment eï¬€ects. This is obviously not possible if the treat-
ment eï¬€ect is (very close to) zero for everyone.
    The WSDP is a good applicaï¿½on to demonstrate the methods discussed in Part 4 because
high quality panel data were collected for the evaluaï¿½on. However, we do not ï¬nd evidence
of heterogeneity in treatment eï¬€ects: Our results are consistent with the WSDP having no
impact on any school. To illustrate the methods further, and demonstrate that our ï¬nding of
no impact is not due to a general problem of these methods, we simulate an analogous da-
taset, based on the features of the data collected for this RCT, using the Simulaï¿½on 1 data
generaï¿½ng process described in Appendix 1.




                                                                                                 52
1. Data

We use the data from Blimpo, Evans and Lahire (2016). Baseline data were collected in 2008
at the start of the program. Follow-up data were collected in 2009, 2010 and 2011. Blimpo,
Evans and Lahire (2016) demonstrate that schoolsâ€™ baseline characterisï¿½cs are balanced
across the three arms. Here, we focus on the impact of the WSDP on student test scores.
Math and literacy scores were collected for 3rd and 5th graders in 2008 and 2010 and for
4th and 6th graders in 2009 and 2011.
    We construct a balanced panel of test scores by taking the average test score by school-
grade-year and restricï¿½ng atenï¿½on to WSDP and control group observaï¿½ons where 2 grades
were observed in each year from 2008 to 2011. This yields a sample of 960 total observa-
ï¿½ons with 8 observaï¿½ons for each of 120 schools, including 61 schools in the WSDP treat-
ment arm and 59 schools in the control group. This diï¬€ers from Blimpo, Evans and Lahire
(2016), who use student level data clustered by school-year for their cross-secï¿½onal analysis.
We instead focus on a balanced panel of school level observaï¿½ons. As Table 7 shows, this
approach yields similar results for the mean impacts, but has the advantage of simplifying
the implementaï¿½on of Mallowsâ€™ deconvoluï¿½on algorithm, which we use in Subsec-
ï¿½on 7.2.2. 72

2. Going Beyond the Mean of the Distribution of Treatment Eï¬€ects

Blimpo, Evans and Lahire (2016) ï¬nd the average impact of the WSDP treatment on test
scores is approximately zero when looking at impacts separately by grade and year. We ï¬nd
a similar small and staï¿½sï¿½cally insigniï¬cant eï¬€ect, using pooled OLS on the stacked cross-
secï¿½ons. But does this null average eï¬€ect mask treatment eï¬€ect heterogeneity? Of course,
in order for a null average eï¬€ect to mask treatment heterogeneity, some schools must bene-
ï¬t while others are hurt by the program. While policymakers usually implement programs
because they think they will beneï¬t parï¿½cipants, programs may have unintended negaï¿½ve
consequences if, for example, they disrupt eï¬€ecï¿½ve systems. If this is the case here, what
proporï¿½on of schools beneï¬ted from the WSDP?
     In this subsecï¿½on, we answer these quesï¿½ons by studying features of the distribuï¿½on of
the WSDPâ€™s eï¬€ects beyond the mean. Unlike average eï¬€ects and quanï¿½le treatment eï¬€ects,
features of the distribuï¿½on of impacts beyond the mean are not idenï¿½ï¬ed by random varia-
ï¿½on induced by an RCT alone; addiï¿½onal assumpï¿½ons are always required. The WSDP RCT is
a good candidate for saï¿½sfying these assumpï¿½ons because it includes four waves of data,
and treated schools are observed both before and aï¿½er the implementaï¿½on of the WSDP.
This allows us to analyze the data using panel data methods, like those discussed in Subsec-
ï¿½on 4.4.4. Condiï¿½onal on school ï¬xed eï¬€ects, the variance of treatment eï¬€ects is idenï¿½ï¬ed
so long as the treatment eï¬€ect is uncorrelated with all ï¿½me-varying components of the error
term, and these ï¿½me varying components are not themselves too correlated over ï¿½me. The
full distribuï¿½on of treatment eï¬€ects is idenï¿½ï¬ed under the stronger assumpï¿½on that treat-
ment eï¬€ects are independent of all ï¿½me varying components of the error term. While these
are not directly testable assumpï¿½ons, they may be plausible. They would be violated, for ex-



72
  Speciï¬cally, by focusing on a balanced panel, all schoolsâ€™ residual vectors are of the same length and receive
equal weight.
                                                                                                                   53
ample, if the school management training is parï¿½cularly eï¬€ecï¿½ve in areas with the highest
(unobserved) economic growth during the study period.
   In order to move beyond the mean, we use the following variant of the panel data speci-
ï¬caï¿½on from Subsecï¿½on 4.4.4. to account for heterogeneity in the WSDPâ€™s impact:

                                                    í µí±Œí µí±Œí µí±–í µí±–í µí±–í µí±–í µí±–í µí±– = í µí»¥í µí»¥í µí±–í µí±– WSDPí µí±–í µí±–í µí±–í µí±– + í µí»¼í µí»¼í µí±–í µí±– + í µí»½í µí»½í µí±”í µí±” + í µí»¾í µí»¾í µí± í µí±  + í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– .

Note two features of this speciï¬caï¿½on: First, we control for school ï¬xed eï¬€ects, í µí»¼í µí»¼í µí±–í µí±– . Second,
the treatment eï¬€ects are no longer assumed to be constant across schools. Instead, í µí»¥í µí»¥í µí±–í µí±– is the
impact of the WSDP on school í µí±–í µí±– . Importantly, í µí»¥í µí»¥í µí±–í µí±– is only idenï¿½ï¬ed for the subpopulaï¿½on of
schools in the WSDP treatment arm, since idenï¿½ï¬caï¿½on relies on variaï¿½on in WSDPí µí±–í µí±–í µí±–í µí±– within
school í µí±–í µí±– . Control group schools contribute to esï¿½maï¿½ng the coeï¬ƒcients í µí»½í µí»½í µí±”í µí±” and í µí»¾í µí»¾í µí± í µí±  which are
common across all schools.
    The ï¬rst row of Table 7 shows that the esï¿½mate of the average impact across schools,
0.01, is quite similar to the esï¿½mate assuming treatment eï¬€ects are constant across schools.
This esï¿½mate is just í µí´¼í µí´¼      Ì‚ í µí±–í µí±– ï¿½í µí±‡í µí±‡ = 1ï¿½. Standard errors are given by convenï¿½onal formulas for
                          ï¿½ ï¿½í µí»¥í µí»¥
method of moments esï¿½mators.
    The second row shows the esï¿½mate of the variance of treatment eï¬€ects using the formu-
la given in Arellano and Bonhommeâ€™s (2012) equaï¿½on (50). The esï¿½mate, 0.005, is about
half the size of the mean impact and is also staï¿½sï¿½cally insigniï¬cant. The validity of this es-
ï¿½mate relies on two assumpï¿½ons. First, treatment eï¬€ects are condiï¿½onally mean independ-
ent of all past, current and future error terms (i.e., strict exogeneity):

                     í µí´¼í µí´¼ï¿½í µí»¥í µí»¥í µí±–í µí±– ï¿½WSDPí µí±–í µí±–í µí±–í µí±– , í µí»¼í µí»¼í µí±–í µí±– , í µí»½í µí»½í µí±”í µí±” , í µí»¾í µí»¾í µí± í µí±  , í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–1 , â€¦ , í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– ï¿½ = í µí´¼í µí´¼ï¿½í µí»¥í µí»¥í µí±–í µí±– ï¿½WSDPí µí±–í µí±–í µí±–í µí±– , í µí»¼í µí»¼í µí±–í µí±– , í µí»½í µí»½í µí±”í µí±” , í µí»¾í µí»¾í µí± í µí±  ï¿½.

Second, the covariance matrix of í µí¼€í µí¼€í µí±–í µí±– = (í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–1 , â€¦ , í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– ) is given by í µí»ºí µí»ºí µí±–í µí±– = í µí¼í µí¼í µí±–í µí±–2
                                                                                                                   í µí±–í µí±–í µí±–í µí±– í µí°¼í µí°¼í µí±†í µí±† . The notaï¿½on
      2
í µí¼í µí¼í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– indicates standard errors may be a funcï¿½on of individual covariates. The key component
of this later assumpï¿½on is that a schoolâ€™s errors are not correlated across periods. This can
be relaxed so long as errors are not â€œtoo correlatedâ€.
               As discussed in Part 4, we can idenï¿½fy the enï¿½re distribuï¿½on of treatment eï¬€ects if we
are willing to make even stronger assumpï¿½ons. In many applicaï¿½ons, these assumpï¿½ons are
unjusï¿½ï¬ed. We include this analysis here primarily for the purpose of illustraï¿½on.
               First, if we are willing to assume treatment eï¬€ects are normally distributed, then the
mean and variance esï¿½mates are suï¬ƒcient staï¿½sï¿½cs for the distribuï¿½on. This distribuï¿½on is
shown with the doted line in Figure 8. The distribuï¿½on is ï¿½ghtly concentrated around zero.
To be sure, we cannot rule out that the distribuï¿½on is degenerate at zero, since neither the
mean or variance is staï¿½sï¿½cally signiï¬cant.
               Alternaï¿½vely, we can recover the enï¿½re distribuï¿½on using deconvoluï¿½on if we are willing
              Table 7: Beyond the Mean Impact of WSDP on Numeracy and Literacy Test Scores
                                                                                                                            Esï¿½mate                                        Standard Error
       í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– )                                                                                                      0.010                                                     0.03
       var(í µí»¥í µí»¥í µí±–í µí±– )                                                                                                       0.005                                                     0.01
       Makarov Bounds on P(í µí»¥í µí»¥í µí±–í µí±– â‰¥ 0)                                                                                 [0.05, 0.95]
      Notes: N = 960 with 8 observaï¿½ons on each of 120 schools. Mean and variance of impacts esï¿½mates
      and standard errors calculated using Arellano and Bonhommeâ€™s (2012) mean group and robust vari-
      ance esï¿½mators. See Secï¿½on 4.4 for details.

                                                                                                                                                                                               54
to assume that treatment eï¬€ects are condiï¿½onally independent of the error terms í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– .
While this assumpï¿½on is not directly testable, a necessary condiï¿½on for it being saï¿½sï¬ed is
that the variance of í µí»¥í µí»¥í µí±–í µí±– í µí±Ší µí±Ší µí±–í µí±–í µí±–í µí±–í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±–í µí±–í µí±– is greater for treatment observaï¿½ons than for control ob-
servaï¿½ons. This condiï¿½on is saï¿½sï¬ed in our sample; the variance of these parï¿½al residuals is
0.133 for treatment observaï¿½ons and 0.114 for control observaï¿½ons.




                              Figure 8: Estimates of Distribution of WSDP Impacts
                        Ì‚ í µí±–í µí±– are very noisy because they are esï¿½mated using only 3 treatment
     The esï¿½mates of í µí»¥í µí»¥
observaï¿½ons and one control observaï¿½on per treated school. Deconvoluï¿½on atempts to
disentangle the variaï¿½on due to the treatment eï¬€ects from the variaï¿½on atributable to
noise. The dashed line in Figure 8 shows the distribuï¿½on of the unadjusted í µí»¥í µí»¥ Ì‚ í µí±–í µí±– esï¿½mates. In
contrast, the solid line shows the distribuï¿½on of treatment eï¬€ects recovered from applying
deconvoluï¿½on via Mallowsâ€™ algorithm. As expected, the deconvoluï¿½on esï¿½mate is much less
dispersed than the unadjusted distribuï¿½on. However, it is more dispersed and has heavier
tails than the normal approximaï¿½on to the distribuï¿½on of treatment eï¬€ects.




                           Figure 9: Deciles of Treatment Eï¬€ects and QTTs

    With knowledge of the full distribuï¿½on of treatment eï¬€ects, we can calculate any feature
of the distribuï¿½on. For example, we can calculate any quanï¿½le of the treatment eï¬€ect distri-
buï¿½on or any moment of the distribuï¿½on, like the mean, variance, skewness or kurtosis of
the distribuï¿½on. In Figure 9, we present deciles of the deconvoluï¿½on esï¿½mates of the distri-

                                                                                                                              55
buï¿½on of treatment eï¬€ects in gray. For comparison, we show quanï¿½le treatment eï¬€ects at
each decile in black. We calculate these quanï¿½le treatment eï¬€ects using the empirical dec-
iles of the parï¿½al residuals of a regression of average test scores in 2011 on grade level.
While the distribuï¿½on of treatment eï¬€ects is calculated using the full panel, our panel func-
ï¿½onal form implies that treatment eï¬€ects are the same in every year and should therefore
be comparable to the quanï¿½le treatment eï¬€ects calculated using only 2011 data. Pointwise
conï¬dence intervals for the QTTs are calculated using one thousand iteraï¿½ons of the
pointwise bootstrap described in Subsecï¿½on 6.2.1.
    In this case, deciles of the distribuï¿½on of treatment impacts look quite similar to the
quanï¿½le treatment eï¬€ects at each decile. The deciles of the distribuï¿½on of treatment im-
pacts are increasing by construcï¿½on, but the QTTs trend upwards at almost exactly the same
rate. As discussed in Parts 2 and 4, this is not the case in general. The similarity of these es-
ï¿½mates suggests the WSDP did not cause much mobility across the potenï¿½al outcome distri-
buï¿½ons. In other words, schools that ranked high in the control group distribuï¿½on also
ranked high in treatment group distribuï¿½on. While none of the decile QTTs are signiï¬cantly
diï¬€erent from 0 based on the pointwise 95% conï¬dence interval, the eï¬€ect at the top decile,
0.23, is signiï¬cant at the 10-percent level.

3. Simulation Results

The analyses in this secï¿½on so far amend Blimpo, Evans and Lahireâ€™s (2016) ï¬nding of a zero
average eï¬€ect by providing evidence that this is due to zero or small individual eï¬€ects rather
than oï¬€seï¿½ng gains and losses. This demonstrates that DIA can provide further guidance for
policy even in cases with no average impact. However, the lack of signiï¬cance impairs the
illustraï¿½on of what else one can learn from DIA and such panel data and how failures of the
assumpï¿½ons can aï¬€ect the results. To improve the illustraï¿½on, we replicate our distribuï¿½onal
analysis of the WSDP using simulated data mirroring the sample used for the WSDP. Speciï¬-
cally, we draw a simulated panel of 8 observaï¿½ons for each of 120 â€œschoolsâ€ from the follow-
ing data generaï¿½ng process:

                                     í µí±¦í µí±¦í µí±–í µí±–í µí±–í µí±– = í µí»¼í µí»¼í µí±–í µí±– + í µí»¥í µí»¥í µí±–í µí±– í µí±‡í µí±‡í µí±–í µí±–í µí±–í µí±– + 0.5âˆší µí±¡í µí±¡í µí»¾í µí»¾í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±– .

With the following distribuï¿½onal assumpï¿½ons:

                                     í µí»¥í µí»¥í µí±–í µí±–   1.5         1                             í µí¼Œí µí¼Œâˆš0.5
              í µí»¼í µí»¼í µí±–í µí±– ~í µí±í µí±(0, 1), ï¿½ ï¿½ ~í µí±í µí± ï¿½ï¿½ ï¿½ , ï¿½                                                    ï¿½ï¿½ and í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±– ~í µí±í µí±(0, 0.01).
                                     í µí»¾í µí»¾í µí±–í µí±–    0     í µí¼Œí µí¼Œâˆš0.5                               0.5

We include the âˆší µí±¡í µí±¡Î³i term to explore the impact of violaï¿½ng the deconvoluï¿½on assumpï¿½ons
on the esï¿½mates. In parï¿½cular, í µí»¥í µí»¥í µí±–í µí±– will be correlated with this term unless í µí¼Œí µí¼Œ = 0. As in the
WSDP sample, 61 schools are randomly assigned to treatment beginning in year 2.
    Table 8 presents esï¿½mates of the average and variance of treatment eï¬€ects and Makarov
Bounds on the proporï¿½on of schools who beneï¬t from the program when í µí¼Œí µí¼Œ is 0, 0.1 and
0.8. 73 Panel A shows results when í µí¼Œí µí¼Œ is 0 so that the deconvoluï¿½on assumpï¿½ons are saï¿½sï¬ed.


73
  Note that each simulated dataset was drawn with the same random seed so that the only diï¬€erence in the
esï¿½mated is due to changing í µí¼Œí µí¼Œ. Mirroring the above analysis, our controls include an indicator for whether the
                                                                                                                                                56
              Table 8: Illustrating Analyses Beyong the Mean Impact using Simulated Data
                                                 True value
                                                                      Esï¿½mate            Std. error
                                                 from DGP
A. cov(í µí»¥í µí»¥í µí±–í µí±– , í µí»¾í µí»¾í µí±–í µí±– ) = 0
í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– )                                     1.50                 1.57               0.15
var(í µí»¥í µí»¥í µí±–í µí±– )                                      1.00                 1.37               0.23
Makarov Bounds on P(í µí»¥í µí»¥í µí±–í µí±– â‰¥ 0)                   0.93             [0.49, 1.00]
B. cov(í µí»¥í µí»¥í µí±–í µí±– , í µí»¾í µí»¾í µí±–í µí±– ) = 0.1
í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– )                                     1.50                 1.57               0.16
var(í µí»¥í µí»¥í µí±–í µí±– )                                      1.00                 1.41               0.24
Makarov Bounds on P(í µí»¥í µí»¥í µí±–í µí±– â‰¥ 0)                   0.93             [0.48, 1.00]
C. cov(í µí»¥í µí»¥í µí±–í µí±– , í µí»¾í µí»¾í µí±–í µí±– ) = 0.8
í µí´¼í µí´¼(í µí»¥í µí»¥í µí±–í µí±– )                                     1.50                 1.55               0.18
var(í µí»¥í µí»¥í µí±–í µí±– )                                      1.00                 1.64               0.30
Makarov Bounds on P(í µí»¥í µí»¥í µí±–í µí±– â‰¥ 0)                   0.93             [0.46, 1.00]
Notes: N = 960 with 8 observaï¿½ons on each of 120 schools. Based on simulated data with idenï¿½cal structure
to WSDP sample. Average and variance of impacts esï¿½mates and standard errors calculated using Arellano
and Bonhomme's (2012) mean group and robust variance esï¿½mators. See Secï¿½on 4.4.4 for addiï¿½onal details.

In this case, the esï¿½mated mean and variance of treatment eï¬€ects are both staï¿½sï¿½cally sig-
niï¬cant, but not signiï¬cantly diï¬€erent from the true values. The Makarov Bounds for the
proporï¿½on of schools which were hurt range from 0.49 to 1, which is consistent with roughly
half of schools being hurt/beneï¬t by the program to everyone beneï¬ï¿½ng, but include the
true value of 0.93.
    Panel B shows results when í µí¼Œí µí¼Œ is 0.1 so that the deconvoluï¿½on assumpï¿½ons are violated,




                          Figure 10: Estimates of Distribution of Simulated Impacts
but the correlaï¿½on between the treatment eï¬€ect and the omited variable is relaï¿½vely weak.
Since the omited variable is mean zero, the esï¿½mated average eï¬€ect remains unbiased.

observaï¿½on is from an â€œolderâ€ grade (which are randomly selected since this coeï¬ƒcient does not enter the
DGP) and year indicators.
                                                                                                            57
                    Figure 11: Deciles of Simulated Treatment Eï¬€ects and QTTs


However, the esï¿½mated variance of treatment eï¬€ects increased slightly and as a result is
signiï¬cantly diï¬€erent from the true variance at the ten-percent level. Panel C shows the case
when í µí¼Œí µí¼Œ is 0.8, so that treatment eï¬€ects are strongly correlated with the omited variable. In
this case, the esï¿½mated variance increases further and is signiï¬cantly diï¬€erent from the true
variance at the ï¬ve-percent level. In both cases, the Makarov Bounds become somewhat
wider, but are qualitaï¿½vely quite similar.
    Figure 11 plots the true distribuï¿½on of treatment eï¬€ects and the deconvoluï¿½on esï¿½-
mates for each of the above cases. As Table 8 suggests, when í µí¼Œí µí¼Œ = 0 or 0.1, the esï¿½mated dis-
tribuï¿½on is slightly more dispersed but generally similar to the true distribuï¿½on of treatment
eï¬€ects. When í µí¼Œí µí¼Œ = 0.8, the esï¿½mated distribuï¿½on is even more over dispersed.
    The three ï¬gures in Figure 11 plot the deciles of the true distribuï¿½on of treatment
eï¬€ects, the deconvoluï¿½on esï¿½mate of the distribuï¿½on of treatment eï¬€ects, and esï¿½mated
QTTs at each decile when í µí¼Œí µí¼Œ equals 0, 0.1, or 0.8, respecï¿½vely. Similarly to Figure 10, the es-
ï¿½mates are quite similar when í µí¼Œí µí¼Œ is 0 or 0.1. In both cases, the esï¿½mated deciles of the dis-
tribuï¿½on of treatment eï¬€ects are quite similar to the deciles from the true distribuï¿½on. The
correlaï¿½on between the esï¿½mated and true deciles is about 0.92 in both cases. The deciles
of QTTs are much ï¬‚ater and generally smaller than the true deciles of treatment eï¬€ects
above the 4th decile. When í µí¼Œí µí¼Œ is 0.8, so that the deconvoluï¿½on assumpï¿½ons are violated, the
deciles of the esï¿½mated distribuï¿½on of treatment eï¬€ects are sï¿½ll quite similar to the true
deciles. But in this case, the QTTs at the deciles are about equicorrelated with the true dec-
iles as the deconvoluï¿½on esï¿½mates, whereas the QTTs were less correlated with the true
deciles of the treatment eï¬€ect in the other cases.


                                                                                                    58
4. Takeaways

By going beyond the mean and esï¿½maï¿½ng the distribuï¿½on of treatment eï¬€ects we were able
to test whether the null average eï¬€ect found in Blimpo, Evans, and Lahire (2015) was mask-
ing policy relevant treatment heterogeneity. The zero average eï¬€ect does not appear to be
masking heterogeneity in schoolsâ€™ response to the Whole School Development Program. In
fact, the esï¿½mated variance implies that the standard deviaï¿½on is about 70% of the esï¿½mat-
ed average eï¬€ect and is also staï¿½sï¿½cally insigniï¬cant. This ï¬nding of litle treatment hetero-
geneity is corroborated by both the deconvoluï¿½on esï¿½mate of the distribuï¿½on and esï¿½mates
of QTTs.
    While relevant for policy, such a null result falls short of illustraï¿½ng what we can learn
from the methods we apply. The simulated results demonstrate that the null results are a
feature of the parï¿½cular program being studied rather than a deï¬ciency of the distribuï¿½onal
methods. Our esï¿½mates of both the variance and distribuï¿½on of treatment eï¬€ects are sta-
ï¿½sï¿½cally indisï¿½nguishable from the truth even when the strong assumpï¿½ons are violat-
ed. However, it is not clear how sensiï¿½ve the methods are to violaï¿½ons of their assumpï¿½ons
in general, and we do not mean to suggest that the robustness of the esï¿½mates in our appli-
caï¿½on generalizes.

References
AAKVIK, A., J.J. HECKMAN AND E.J. VYTLACIL (2005): â€œEsï¿½maï¿½ng treatment eï¬€ects for discrete outcomes when re-
     sponses to treatment vary: An applicaï¿½on to Norwegian vocaï¿½onal rehabilitaï¿½on programsâ€, Journal of
     Econometrics 125(1â€“2), 15â€“21.
ABADIE, A. (2002): â€œBootstrap tests for distribuï¿½onal treatment eï¬€ects in instrumental variable modelsâ€, Journal
     of the American Statistical Association 97(457), 284â€“292.
ABADIE, A., J. ANGRIST AND G.W. IMBENS (2002): â€œInstrumental variables esï¿½maï¿½on of quanï¿½le treatment eï¬€ectsâ€,
     Econometrica 70(1), 91â€“117.
ABBRING, J., AND J. HECKMAN (2007): â€œEconometric evaluaï¿½on of social programs, part III: Distribuï¿½onal treatment
     eï¬€ects, dynamic treatment eï¬€ects, dynamic discrete choice, and general equilibrium policy evaluaï¿½onâ€,
     Handbook of Econometrics 6, 5145â€“5303.
ANDREWS, D.W.K., AND M. BUCHINSKY (2000): â€œA three-step method for choosing the number of bootstrap repeï¿½-
     ï¿½onsâ€, Econometrica 68(1), 23â€“51.
ANGRIST, J.D., AND G.W. IMBENS (1994): â€œIdenï¿½ï¬caï¿½on and esï¿½maï¿½on of local average treatment eï¬€ectsâ€, Econ-
     ometrica 62(2), 467â€“475.
ANGRIST, J., AND J.S. PISCHKE (2009): Mostly harmless econometrics: An empiricist's companion. Princeton (NJ):
     Princeton University Press.
ARCIDIACONO, P., E. AUCEJO, H. FANG AND K. SPENNER (2011): â€œDoes aï¬ƒrmaï¿½ve acï¿½on lead to mismatch? A new
     test and evidenceâ€, Quantitative Economics 2(3), 303â€“333.
ARELLANO, M., AND S. BONHOMME (2012): â€œIdenï¿½fying distribuï¿½onal characterisï¿½cs in random coeï¬ƒcients panel
     data modelsâ€, Review of Economic Studies 79(3), 987â€“1020.
ATHEY, S., AND G.W. IMBENS (2002): â€œRecursive parï¿½ï¿½oning for heterogeneous causal eï¬€ectsâ€, arXiv:1504.01132.
BELLONI, A., V. CHERNOZHUKOV, AND C. HANSEN (2014): â€œInference on treatment eï¬€ects aï¿½er selecï¿½on among high-
     dimensional controlsâ€, Review of Economic Studies 81(2), 608â€“650.
BITLER, M., J. GELBACH AND H.W. HOYNES (2006): â€œWhat mean impacts miss: Distribuï¿½onal eï¬€ects of welfare re-
     form experimentsâ€, American Economic Review 96(4), 988â€“1012.
â”€â”€â”€â”€â”€ (2014): â€œCan variaï¿½on in subgroupsâ€™ average treatment eï¬€ects explain treatment eï¬€ect heterogeneity?
     Evidence from a social experimentâ€, NBER Working Paper 20142.
BITLER, M., H.W. HOYNES AND T. DOMINA (2014): â€œExperimental evidence on distribuï¿½onal eï¬€ects of Head Startâ€,
     NBER Working Paper 20434.
BISSANTZ, N., L. DÃœMBGEN, H. HOLZMANN AND A. MUNK (2007): "Non-parametric conï¬dence bands in deconvoluï¿½on
     density esï¿½maï¿½onâ€, Journal of the Royal Statistical Society B 69(3), 483â€“506.

                                                                                                                   59
BLACK, D.A., J.A. SMITH, M.C. BERGER AND B. J. NOEL (2003): â€œIs the threat of reemployment services more eï¬€ec-
     ï¿½ve than the services themselves? Experimental evidence from the UI systemâ€, American Economic Re-
     view 93(3), 1313â€“1327.
BLIMPO, M., D.K. EVANS AND N. LAHIRE (2015): â€œParental human capital and eï¬€ecï¿½ve school management: Evi-
     dence from The Gambiaâ€, World Bank Policy Research Working Paper 7238.
BONHOMME, S., and J. ROBIN (2010): â€œGeneralized nonparameteric deconvoluï¿½on with an applicaï¿½on to earnings
     dynamicsâ€, Review of Economic Studies 77(2), 491â€“533.
BRINCH, C., M. MOGSTAD AND M. WISWALL (forthcoming): â€œBeyond LATE with a discrete instrumentâ€, Journal of
     Political Economy.
BRUHN, M., L. DE SOUZA LEÃƒO, A. LEGOVINI, R. MARCHETTI AND B. ZIA (2016): â€œThe impact of high school ï¬nancial edu-
     caï¿½on: Evidence from a large-scale evaluaï¿½on in Brazilâ€, American Economic Journal: Applied Economics
     8(4), 256â€“295.
CAMERON, C., AND D.L. MILLER (2015): â€œA pracï¿½ï¿½onerâ€™s guide to cluster-robust inferenceâ€, Journal of Human Re-
     sources 50(2), 317â€“372.
CAMERON, C., AND P. TRIVEDI (2005): Microeconometrics: Methods and applications. New York (NY): Cambridge
     University Press.
CARNEIRO, P., K. HANSEN AND J. HECKMAN (2002): â€œRemoving the veil of ignorance in assessing the distribuï¿½onal
     impacts of social policiesâ€, NBER Working Papers 8840.
â”€â”€â”€â”€â”€ (2003): â€œEsï¿½maï¿½ng distribuï¿½ons of treatment eï¬€ects with an applicaï¿½on to the returns to schooling and
     measurement of the eï¬€ects of uncertainty on college choiceâ€, International Economic Review 44(2), 361â€“
     422.
CATTANEO, M. (2010): â€œEï¬ƒcient semiparametric esï¿½maï¿½on of mulï¿½-valued treatment eï¬€ects under ignorabil-
     ityâ€, Journal of Econometrics 155(2), 138â€“154.
CHERNOZHUKOV, V., I. FERNÃNDEZ-VAL AND A. GALICHON (2010): â€œQuanï¿½le and probability curves without crossingâ€,
     Econometrica 78(3), 1093â€“1125.
CHERNOZHUKOV, V., I. FERNÃNDEZ-VAL AND B. MELLY (2013): â€œInference on counterfactual distribuï¿½onsâ€, Economet-
     rica 81(6), 2205â€“2268.
CHERNOZHUKOV, V., AND C. HANSEN (2004): â€œThe impact of 401(k) parï¿½cipaï¿½on on the wealth distribuï¿½on: An in-
     strumental quanï¿½le regression analysisâ€, Review of Economics and Statistics 86(3), 735â€“751.
â”€â”€â”€â”€â”€ (2005): â€œAn IV model of quanï¿½le treatment eï¬€ectsâ€, Econometrica 73(1), 245â€“261.
â”€â”€â”€â”€â”€ (2013): â€œQuanï¿½le models with endogeneityâ€, Annual Review of Economics 5, 57â€“81.
CHERNOZHUKOV, V., C. HANSEN AND M. JANSSON (2009): â€œFinite sample inference in econometric models via quanï¿½le
     restricï¿½onsâ€, Journal of Econometrics 152(2), 93â€“103.
CORNELISSEN, T., C. DUSTMANN, A. RAUTE AND U. SCHÃ–NBERG (2016): â€œFrom LATE to MTE: Alternaï¿½ve methods for the
     evaluaï¿½on of policy intervenï¿½onsâ€, Labour Economics 41, 47â€“60.
CRUMP, R.K., V.J. HOTZ, G.W. IMBENS AND O.A. MITNIK (2008): â€œNonparametric tests for treatment eï¬€ect
     heterogeneityâ€, Review of Economics and Statistics 90(3), 389â€“405.
â”€â”€â”€â”€â”€ (2009): â€œDealing with limited overlap in esï¿½maï¿½on of average treatment eï¬€ectsâ€, Biometrika 96(1),
     187â€“199.
CUNHA, F., J. HECKMAN AND S. SCHENNACH (2010): â€œEsï¿½maï¿½ng the technology of cogniï¿½ve and non-cogniï¿½ve skill
     formaï¿½onâ€, Econometrica 78(3), 883â€“931.
DINARDO, J., N.M. FORTIN AND T. LEMIEUX (1996): â€œLabor market insï¿½tuï¿½ons and the distribuï¿½on of wages, 1973â€“
     1992: A semiparametric approachâ€, Econometrica 64(5), 1001â€“1044.
DJEBBARI, H., and J.A. SMITH (2008): â€œHeterogeneous impacts in PROGRESAâ€, Journal of Econometrics 145(1), 64â€“
     80.
DONALD, S.G. AND Y.C. HSU (2014): â€œEsï¿½maï¿½on and inference for distribuï¿½on funcï¿½ons and quanï¿½le funcï¿½ons in
     treatment eï¬€ect modelsâ€, Journal of Econometrics 178(3), 383â€“397.
DONALD, S.G., Y.C. HSU AND R.P. LIELI (2014): â€œTesï¿½ng the unconfoundedness assumpï¿½on via inverse probability
     weighted esï¿½mators of (L)ATTâ€, Journal of Business & Economic Statistics 32(3), 395â€“415.
FAFCHAMPS, M., and J. LABONNE (2016): â€œUsing split samples to improve inference about causal eï¬€ectsâ€, NBER
     Working Paper 21842.
FAN, Y., and S. PARK (2010): â€œSharp bounds on the distribuï¿½on of treatment eï¬€ects and their staï¿½sï¿½cal infer-
     enceâ€, Econometric Theory 26(3), 931â€“951.
FITHIAN, W., D. SUN AND J. TAYLOR (2017). â€œOpï¿½mal inference aï¿½er model selecï¿½onâ€, arXiv:1410.2597v4.
FIRPO, S. (2007): â€œEï¬ƒcient semiparametric esï¿½maï¿½on of quanï¿½le treatment eï¬€ectsâ€, Econometrica, 75(1), 259â€“
     276.


                                                                                                                     60
FIRPO, S., N.M. FORTIN AND T. LEMIEUX (2009): â€œUncondiï¿½onal quanï¿½le regressionsâ€, Econometrica, 77(3), 953â€“
     973.
FIRPO, S., AND C. PINTO (2015): â€œIdenï¿½ï¬caï¿½on and esï¿½maï¿½on of distribuï¿½onal impacts of intervenï¿½ons using
     changes in inequality measuresâ€, Journal of Applied Econometrics 31(3): 457â€“486.
FIRPO, S., and G. RIDDER (2008). â€œBounds on funcï¿½onals of the distribuï¿½on of treatment eï¬€ectsâ€, Textos para
     DiscussÃ£o 201. SÃ£o Paulo, SP: Escola de Economia de SÃ£o Paulo.
FRÃ–LICH, M. (2006): â€œNon-parametric regression for binary dependent variablesâ€, Econometrics Journal 9(3),
     511â€“540.
FRÃ–LICH, M. (2007): â€œPropensity score matching without condiï¿½onal independence assumpï¿½onâ€”with an
     applicaï¿½on to the gender gap in the United Kingdomâ€, Econometrics Journal 10(2), 359â€“407.
FRÃ–LICH, M., AND B. MELLY (2013a): â€œIdenï¿½ï¬caï¿½on of treatment eï¬€ects on the treated with one-sided non-
     complianceâ€, Econometric Reviews 32(3), 384â€“414.
â”€â”€â”€â”€â”€ (2013b): â€œUncondiï¿½onal quanï¿½le treatment eï¬€ects under endogeneityâ€, Journal of Business & Economic
     Statistics 31(3), 346â€“357.
HECKMAN, J.J., AND B. HONORÃ‰ (1990): â€œThe empirical content of the Roy modelâ€, Econometrica 58(5), 1121â€“1149.
HECKMAN, J.J., J. SMITH AND N. CLEMENTS (1997): â€œMaking the most out of programme evaluaï¿½ons and social ex-
     periments: Accounï¿½ng for heterogeneity in programme impactsâ€, Review of Economic Studies 64(4), 487â€“
     535.
HECKMAN, J.J., AND E.J. VYTLACIL (1999): â€œLocal instrumental variables and latent variable models for idenï¿½fying
     and bounding treatment eï¬€ectsâ€, Proceedings of the National Academy of Sciences, vol. 96, 4730â€“4734.
â”€â”€â”€â”€â”€ (2005): â€œStructural equaï¿½ons, treatment eï¬€ects, and econometric policy evaluaï¿½onâ€, Econometrica
     73(3), 669â€“738.
â”€â”€â”€â”€â”€ (2007): â€œEconometric evaluaï¿½on of social programs, part II: Using the marginal treatment eï¬€ect to or-
     ganize alternaï¿½ve econometric esï¿½mators to evaluate social programs, and to forecast their eï¬€ects in new
     environmentsâ€, Handbook of Econometrics 6b, 4875â€“5143.
HIRANO, K., G.W. IMBENS AND G. RIDDER (2003): â€œEï¬ƒcient esï¿½maï¿½on of average treatment eï¬€ects using the esï¿½-
     mated propensity scoreâ€, Econometrica 71(4), 1161â€“1189.
HOROWITZ, J.L. (2001): â€œThe bootstrapâ€, Handbook of Econometrics 5, 3159â€“3228.
HOROWITZ, J.L., AND N.E. SAVIN (2001): â€œBinary response models: Logits, probits and semiparametricsâ€, Journal of
     Economic Perspectives 15(4), 43â€“56.
IMAI, K., AND M. RATKOVIC (2013): â€œEsï¿½maï¿½ng treatment eï¬€ect heterogeneity in randomized program evalua-
     ï¿½onâ€, Annals of Applied Statistics 7(1): 443â€“470.
IMBENS, G.W. (2015): â€œMatching methods in pracï¿½ce: Three Examplesâ€, Journal of Human Resources 50(2), 373â€“
     419.
IMBENS, G.W., AND C.F. MANSKI (2004): â€œConï¬dence intervals for parï¿½ally idenï¿½ï¬ed parametersâ€, Econometrica
     72(6), 1845â€“1857.
IMBENS, G.W AND D.B. RUBIN (1997): â€œEsï¿½maï¿½ng outcome distribuï¿½ons for compliers in instrumental variables
     modelsâ€, Review of Economic Studies 64(4), 555â€“574.
IMBENS, G.W AND J.M. WOOLDRIDGE (2009): â€œRecent developments in the econometrics of program evaluaï¿½onâ€,
     Journal of Economic Literature 47(1), 5â€“86.
JACOBSON, L.S., R.J. LALONDE AND D.G. SULLIVAN (1993): â€œEarnings losses of displaced workersâ€, American Econom-
     ic Review 83(4), 685â€“709.
JAYNES, E. (1957): â€œInformaï¿½on theory and staï¿½sï¿½cal mechanicsâ€, Physics Review 106(4), 620â€“630.
KLINE, P., AND C. WALTERS (2015): â€œEvaluaï¿½ng public programs with close subsï¿½tutes: The case of Head Startâ€,
     NBER Working Paper 21658.
KOENKER, R. (2005): Quantile regression. Cambridge, UK: Cambridge University Press.
KOENKER, R., AND G. BASSETT (1978): â€œRegression quanï¿½lesâ€, Econometrica 46(1), 33â€“50.
KOENKER, R., AND Z. XIAO (2002): â€œInference on the quanï¿½le regression processâ€, Econometrica 70(4), 1583â€“
     1612.
KOTLARSKI, I. (1967): â€œOn characterizing the gamma and the normal distribuï¿½onâ€, Paciï¬c Journal of Mathematics
     20(1), 69â€“76.
KOWALSKI, A.E. (2016): â€œDoing more when youâ€™re running LATE: Applying marginal treatment eï¬€ect methods to
     examine treatment eï¬€ect heterogeneity in experimentsâ€, NBER Working Paper Series 22363.
LECHNER, M. (1999): â€œEarnings and employment eï¬€ects of conï¿½nuous oï¬€-the-job training in East Germany aï¿½er
     uniï¬caï¿½onâ€, Journal of Business and Economic Statistics 17(1), 74â€“90.
LEE, S., AND A.M. SHAIKH (2014): â€œMulï¿½ple tesï¿½ng and heterogeneous treatment eï¬€ects: Re-evaluaï¿½ng the eï¬€ect
     of PROGRESA on school enrollmentâ€, Journal of Applied Econometrics 29(4), 612â€“626.
                                                                                                                   61
LIST, J.A., A.M. SHAIKH AND Y. XU (2016): â€œMulï¿½ple hypothesis tesï¿½ng in experimental economicsâ€, NBER Working
      Paper 21875.
MAKAROV, G. (1982): â€œEsï¿½mates for the distribuï¿½on funcï¿½on of a sum of two random variables when the mar-
      ginal distribuï¿½ons are ï¬xedâ€, Theory of Probability and its Applications 26(4), 803â€“806.
MALLOWS, C. (2007): â€œDeconvoluï¿½on by simulaï¿½onâ€, in R. Liu, W. Strawderman and C.H. Zhang (eds.), Complex
      Datasets and Inverse Problems: Tomography, Networks and Beyond, IMS Lecture Notes â€“ Monograph Se-
      ries, vol. 54, 1â€“11. New Brunswick, NJ: Rutgers University.
MANSKI, C.F. (2004): â€œStaï¿½sï¿½cal treatment rules for heterogeneous populaï¿½onsâ€, Econometrica 72(4), 1221â€“
      1246.
MCCONNELL, B., AND VERA-HERNÃNDEZ, M. (2015): â€œGoing beyond simple sample size calculaï¿½ons: A pracï¿½ï¿½onerâ€™s
      guideâ€, IFS Working Paper W15/17.
NEWEY, WHITNEY K., AND DANIEL L. MCFADDEN. (1994): â€œLarge Sample Esï¿½maï¿½on and Hypothesis Tesï¿½ng." In
      Handbook of Econometrics. Vol. 4, ed. Robert F. Engle and Daniel L. McFadden, Chapter 36, 2111-2245.
      Amsterdam:Elsevier.
Oâ€™MUIRCHEARTAIGH, C., AND L.V. HEDGES (2014): â€œGeneralizing from unrepresentaï¿½ve experiments: a straï¿½ï¬ed
      propensity score approachâ€, Applied Statistics, 63(2), 195â€“210.
PITT, M.M., M.R. ROSENZWEIG AND M.N. HASSAN (2012): â€œHuman capital investment and the gender division of
      labor in a brawn-based economyâ€, American Economic Review 102(7), 3531â€“3560.
OTSU, T., AND Y. RAI (forthcoming): â€œBootstrap inference of matching esï¿½mators for average treatment eï¬€ectsâ€,
      Journal of the American Statistical Association. DOI: 10.1080/01621459.2016.1231613.
RIDGEWAY, G., S.A. KOVALCHIK, B.A. GRIFFIN AND M.U. KABETO (2015): â€œPropensity score analysis with survey
      weighted dataâ€, Journal of Causal Inference 3(2), 237â€“249.
ROMANO, J.P., AND M. WOLF (2010): â€œBalanced control of generalized error ratesâ€, Annals of Statistics 38(1), 598â€“
      633.
ROTHE, C. (2012): â€œParï¿½al distribuï¿½onal policy eï¬€ectsâ€, Econometrica 80(5), 2269â€“2301.
SCHNENNACH, S. (2013): â€œConvoluï¿½on without independenceâ€, CEMMAP working paper CWP46/13.
SMITH, J. (2015): â€œThe important role of heterogeneity in social and biological modelsâ€, presentaï¿½on at the
      RCGD/IHPI Seminar.
STOYE, J. (2009): â€œMore on conï¬dence intervals for parï¿½ally idenï¿½ï¬ed parametersâ€, Econometrica 77(4), 1299-
      1315.
WAGER, S., AND S. ATHEY (2015): â€œEsï¿½maï¿½on and inference of heterogeneous treatment eï¬€ects using random
      forestsâ€, arXiv:1510.04342.
WASSERMAN, L., AND K. ROEDER (2009): â€œHigh-dimensional variable selecï¿½onâ€, Annals of Statistics 37(5A), 2178â€“
      2201.
WU, X., and J. PERLOFF (2006): â€œInformaï¿½on-theoreï¿½c deconvoluï¿½on approximaï¿½on of treatment eï¬€ect distri-
      buï¿½onâ€, unpublished manuscript. College Staï¿½on, TX: Texas A&M University.
ZHANG, Y. (2016): Three Essays on Extremal Quantiles, Ph.D. dissertaï¿½on. Durham, NC: Duke University. Availa-
      ble at: hdl.handle.net/10161/12160.


Appendix 1. Simulaï¿½on Details

Throughout the toolkit, we use results from simulaï¿½on exercises for illustraï¿½on. In this ap-
pendix, we describe the data generaï¿½ng processes used for each of these simulaï¿½ons.

Simulation 1

Simulaï¿½on 1 is our workhorse simulaï¿½on, because it can be used to generate cross-secï¿½onal
data with baseline outcome measures or panel data with an arbitrary number of periods.
   In this simulaï¿½on, individual í µí±–í µí±– â€™s outcome in period í µí± í µí±  is:

                                          í µí±Œí µí±Œí µí±–í µí±–í µí±–í µí±– = í µí»¼í µí»¼í µí±–í µí±– + í µí»¥í µí»¥í µí±–í µí±– í µí±…í µí±…í µí±–í µí±–í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±– .

Moreover, we assume
                                                                                                                    62
                                                  í µí»¼í µí»¼í µí±–í µí±–        0     0.5 0.5
                                                 ï¿½í µí»¥í µí»¥ ï¿½ ~í µí±í µí± ï¿½ï¿½ ï¿½ , ï¿½         ï¿½ï¿½,
                                                      í µí±–í µí±–       1.5 0.5 1.0

and í µí¼€í µí¼€í µí±–í µí±–í µí±–í µí±– ~í µí±í µí±(0, 1). We require exactly half of observaï¿½ons to be randomly selected for treat-
ment beginning in period í µí±†í µí±†/2. 74

Simulation 2

Simulaï¿½on 2 draws data from two data generaï¿½ng processes with idenï¿½cal average treat-
ment eï¬€ects, but very diï¬€erent levels of heterogeneity in treatment eï¬€ects. Speciï¬cally, we
assume the following data-generaï¿½ng process:

                                                           í µí±Œí µí±Œí µí±–í µí±–1 = í µí»¥í µí»¥1
                                                                           í µí±–í µí±– í µí±…í µí±…í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±– ,
                                                                  2        2
                                                           í µí±Œí µí±Œí µí±–í µí±– = í µí»¥í µí»¥í µí±–í µí±– í µí±…í µí±…í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±– .

For each individual, we draw a single í µí¼€í µí¼€í µí±–í µí±– and í µí±…í µí±…í µí±–í µí±– . We assume í µí¼€í µí¼€í µí±–í µí±– ~í µí±í µí±(0, 1). Furthermore, we
require exactly half of observaï¿½ons be selected for treatment by drawing a uniform random
variable for each individual and selecï¿½ng the treatment cutoï¬€ using the median value across
all draws. As for treatment eï¬€ects, we assume í µí»¥í µí»¥1                       2          2               2
                                                        í µí±–í µí±– ~í µí±í µí± (1, 0.5 ) and í µí»¥í µí»¥í µí±–í µí±– ~í µí±í µí± (1, 5 ).


Simulation 3

In Simulaï¿½on 3, potenï¿½al outcomes are:

                                                         í µí±Œí µí±Œ1 = 1 + í µí±í µí±í µí±‹í µí±‹1 + í µí¼€í µí¼€1 ,
                                                         í µí±Œí µí±Œ0 = 0.5í µí±‹í µí±‹1 + í µí¼€í µí¼€0 ,

where

                                                   í µí¼€í µí¼€1          0 1.0                             í µí¼í µí¼12
                                                  ï¿½í µí¼€í µí¼€ ï¿½ ~í µí±í µí± ï¿½ï¿½ ï¿½ , ï¿½                                   ï¿½ï¿½.
                                                       0          0 í µí¼í µí¼12                          0.5

Note that í µí±Œí µí±Œ1 and í µí±Œí µí±Œ0 are independent when í µí¼í µí¼12 = 0, whereas í µí»¥í µí»¥ and í µí±Œí µí±Œ0 are independent
when í µí¼í µí¼12 = 0.5.
   In addiï¿½on, we assume í µí±‹í µí±‹1 ~í µí±í µí±(1, 1). Treatment eï¬€ects are then:

                                        í µí»¥í µí»¥ = í µí±Œí µí±Œ1 âˆ’ í µí±Œí µí±Œ0 = 1 + (í µí±í µí± âˆ’ 0.5)í µí±‹í µí±‹1 + í µí¼€í µí¼€1 âˆ’ í µí¼€í µí¼€0 .

We do not condiï¿½on on í µí±‹í µí±‹1 in our simulaï¿½ons. Consequently, there is an omited variable
which is posiï¿½vely correlated with treatment eï¬€ects when í µí±í µí± > 0.5 and negaï¿½vely correlated
with treatment eï¬€ects when í µí±í µí± < 0.5. There is no omited variable when í µí±í µí± = 0.5.

Appendix 2. Esï¿½maï¿½ng Condiï¿½onal Probabiliï¿½es


74
     If í µí±†í µí±† is odd, we use âŒˆí µí±†í µí±†/2âŒ‰.
                                                                                                                 63
To construct the IPW and IV weights, we need condiï¿½onal probabiliï¿½es P(â‹… |í µí±‹í µí±‹). We might
know them a priori. If our instrument is treatment assignment and we only want to adjust
for straï¿½ï¬caï¿½on, for example, the randomizaï¿½on rules provide the stratum speciï¬c treat-
ment probabiliï¿½es. Otherwise, we need to esï¿½mate and predict P(â‹… |í µí±‹í µí±‹).
    There are many strategies to predict P(â‹… |í µí±‹í µí±‹). If the covariates are discrete, Abadie, An-
grist and Imbens (2002) recommend sorï¿½ng the data into cells and using the proporï¿½on of
treated observaï¿½ons within each cell. This method is nonparametric and eï¬ƒcient. For con-
ï¿½nuous covariates, Hirano, Imbens and Ridder (2003) suggest a ï¬‚exible logisï¿½c speciï¬caï¿½on,
including polynomials of covariates and interacï¿½on terms. The authors give condiï¿½ons under
which the resulï¿½ng esï¿½mator is nonparametric. The appendix of Imbens (2015) presents an
algorithm to select the higher-order terms. One can also use a LASSO procedure to select
controls: see Athey and Imbens (2015) and Belloni, Chernozhukov and Hansen (2014) for
references. Alternaï¿½ve semiparametric or nonparametric strategies are available. Because
the variance of binary outcomes is intrinsically bounded, these methods perform well. See
Horowiz and Savin (2001) and FrÃ¶lich (2006) for references.
    Both the IV and the IPW esï¿½mators are sensiï¿½ve to observaï¿½ons in the tails of P(â‹… |í µí±‹í µí±‹).
Unfortunately, it is diï¬ƒcult to predict this condiï¿½onal probability with much accuracy near
its boundaries. Crump et al. (2009) suggest trimming the sample and ignoring observaï¿½ons
for which P(â‹… |í µí±‹í µí±‹) is close to zero or one when esï¿½maï¿½ng quanï¿½les. If the rate of trimming
decreases with sample size, the resulï¿½ng esï¿½mator remains consistent. The authors suggest
using only observaï¿½ons with predicted probability between 0.1 and 0.9 as a rule of thumb.

Appendix 3. Recursively Solving for Higher Order Moments
The Binomial Theorem implies:

                                                               í µí°¾í µí°¾                                                           í µí°¾í µí°¾
                                                            í µí°¾í µí°¾                                                   í µí°¾í µí°¾
           í µí´¼í µí´¼[(í µí»¥í µí»¥í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±–   )í µí°¾í µí°¾ ]   = í µí´¼í µí´¼ ï¿½ï¿½ ï¿½ ï¿½ í µí»¥í µí»¥í µí°¾í µí°¾âˆ’í µí±˜í µí±˜
                                                                   í µí±–í µí±–      í µí¼€í µí¼€í µí±–í µí±–í µí±˜í µí±˜ ï¿½ = í µí´¼í µí´¼(í µí»¥í µí»¥í µí°¾í µí°¾                    í µí°¾í µí°¾âˆ’í µí±˜í µí±˜
                                                                                                       í µí±–í µí±– ) + ï¿½ ï¿½ ï¿½ í µí´¼í µí´¼ï¿½í µí»¥í µí»¥í µí±–í µí±–      ï¿½í µí´¼í µí´¼ï¿½í µí¼€í µí¼€í µí±–í µí±–í µí±˜í µí±˜ ï¿½.
                                                            í µí±˜í µí±˜                                                   í µí±˜í µí±˜
                                                             í µí±˜í µí±˜=1                                                         í µí±˜í µí±˜=1


For any í µí±˜í µí±˜, í µí´¼í µí´¼[(í µí»¥í µí»¥í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±– )í µí°¾í µí°¾ ] can be esï¿½mated from the treatment group residuals and each
í µí´¼í µí´¼ï¿½í µí¼€í µí¼€í µí±–í µí±–í µí±˜í µí±˜ ï¿½ can be esï¿½mated from the control group residuals. Therefore, this is a system of í µí°¾í µí°¾
independent equaï¿½ons and í µí°¾í µí°¾ unknowns that we can solve for í µí´¼í µí´¼(í µí»¥í µí»¥í µí°¾í µí°¾          í µí±–í µí±– ). This gives us K equa-
ï¿½ons for the ï¬rst í µí°¾í µí°¾ moments of the treatment eï¬€ect distribuï¿½on:
                                                                                                         í µí°¾í µí°¾
                                                                                                        í µí°¾í µí°¾
                                         í µí´¼í µí´¼ï¿½í µí»¥í µí»¥í µí±˜í µí±˜
                                                  í µí±–í µí±– ï¿½   = í µí´¼í µí´¼[(í µí»¥í µí»¥í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±–   )í µí°¾í µí°¾ ]   âˆ’ ï¿½ ï¿½ ï¿½ í µí´¼í µí´¼ï¿½í µí»¥í µí»¥í µí°¾í µí°¾âˆ’í µí±˜í µí±˜
                                                                                                                    í µí±–í µí±–      ï¿½í µí´¼í µí´¼ï¿½í µí¼€í µí¼€í µí±–í µí±–í µí±˜í µí±˜ ï¿½.
                                                                                                        í µí±˜í µí±˜
                                                                                                       í µí±˜í µí±˜=1

These moments can be esï¿½mated recursively using the sample counterparts to each term in
the above equaï¿½on. Speciï¬cally,
                                                                                                        í µí±í µí±1
                                                                                          1
                                                       ï¿½ [(í µí»¥í µí»¥í µí±–í µí±– + í µí¼€í µí¼€í µí±–í µí±– )í µí°¾í µí°¾ ] =
                                                       í µí´¼í µí´¼                                                             Ì‚ ï¿½í µí°¾í µí°¾ ,
                                                                                               ï¿½ï¿½í µí±Œí µí±Œ1í µí±–í µí±– âˆ’ í µí±‹í µí±‹í µí±–í µí±– í µí»½í µí»½
                                                                                         í µí±í µí±1
                                                                                                       í µí±–í µí±–=1
                                                                                                          í µí±í µí±0
                                                                                                1
                                                                         ï¿½ ï¿½í µí¼€í µí¼€í µí±–í µí±–í µí±˜í µí±˜ ï¿½ =
                                                                         í µí´¼í µí´¼                                                 Ì‚ ï¿½í µí±˜í µí±˜ .
                                                                                                     ï¿½ï¿½í µí±Œí µí±Œ0í µí±–í µí±– âˆ’ í µí±‹í µí±‹í µí±–í µí±– í µí»½í µí»½
                                                                                               í µí±í µí±0
                                                                                                       í µí±–í µí±–=1



                                                                                                                                                                 64
        Ì‚ is the OLS coeï¬ƒcient from a regression of í µí±Œí µí±Œ on í µí±‹í µí±‹ and í µí±í µí±1 and í µí±í µí±0 are the number of
where í µí»½í µí»½
treatment and control group observaï¿½ons, respecï¿½vely.




                                                                                                         65
Appendix 4. Addiï¿½onal Results from Applicaï¿½ons




                   Figure 12: Eï¬€ects on the CDF for Financial Education Program

             Table 9: Reweighted Treatment Eï¬€ects for Financial Education Program
                              Control-         Eï¬€ect esï¿½mate         Standard       Simultaneous
   Staï¿½sï¿½c                  group value      Value     Percent         error      conf. region (95%)
   Mean                        56.260       â€“â€Š3.859    1â€“â€Š6.886%      0.427       â€“â€Š2.636    â€“â€Š5.083
   Standard deviaï¿½on           14.768       â€“â€Š0.382    1â€“â€Š2.583%      0.187       â€“â€Š0.753    â€“â€Š0.012
   75/25 perc. raï¿½o            01.525       â€“â€Š0.106    1â€“â€Š6.904%      0.019       â€“â€Š0.157    â€“â€Š0.054
   10th percenï¿½le              33.047       â€“â€Š3.887    â€“â€Š10.706%      0.543       â€“â€Š2.311    â€“â€Š5.462
   25th percenï¿½le              44.134       â€“â€Š5.613    â€“â€Š12.795%      0.733       â€“â€Š3.564    â€“â€Š7.662
   50th percenï¿½le              56.438       â€“â€Š4.043    1â€“â€Š7.200%      0.512       â€“â€Š2.563    â€“â€Š5.524
   75th percenï¿½le              67.326       â€“â€Š3.228    1â€“â€Š4.808%      0.404       â€“â€Š2.023    â€“â€Š4.434
   90th percenï¿½le              75.894       â€“â€Š3.099    1â€“â€Š4.088%      0.404       â€“â€Š1.720    â€“â€Š4.480
   CDF at 40 points            00.164       â€“â€Š0.070    â€“â€Š40.897%      0.009       â€“â€Š0.098    â€“â€Š0.043
   CDF at 50 points            00.352       â€“â€Š0.103    â€“â€Š28.144%      0.013       â€“â€Š0.140    â€“â€Š0.066
   CDF at 60 points            00.581       â€“â€Š0.102    â€“â€Š17.232%      0.012       â€“â€Š0.137    â€“â€Š0.068
   CDF at 70 points            00.801       â€“â€Š0.066    1â€“â€Š8.188%      0.009       â€“â€Š0.093    â€“â€Š0.040
   CDF at 80 points            00.945       â€“â€Š0.031    1â€“â€Š3.315%      0.005       â€“â€Š0.045    â€“â€Š0.017
    Notes: Eï¬€ects based on inverse probability weighï¿½ng (Firpo and Pinto, 2016). Weights based on
    logisï¿½c regression of treatment on gender indicator and quadraï¿½c polynomial of baseline scores.
    Standard errors and conï¬dence region based on the bootstrap (ï¬ve thousand replicaï¿½ons) and
    clustered at the school level. The conï¬dence region controls the FWER (probability of at least one
    false rejecï¿½on across tests), following Romano and Wolf (2010).




                                                                                                         66
                Table 10: Conditional Quantile Eï¬€ects for Financial Education Program

                              Sample                            Percenï¿½le
        Subgroup
                                size       10th        25th        50th        75th        90th
Baseline score                             3.263      4.645       5.060       3.793       3.497
                        No     17960
  above median                            (0.460)     (0.664)    (0.635)      (0.554)     (0.615)
                                           8.875       4.953      2.992        2.853       3.157
                        Yes    17960
                                          (1.275)     (0.864)    (0.572)      (0.482)     (0.543)
Student has repeat-                        5.197       6.522      4.516        3.608       3.306
                        No     10949
  ed grade                                (0.716)     (0.867)    (0.670)      (0.642)     (0.691)
                                           3.791       5.592      5.568        4.372       3.261
                        Yes    14437
                                          (0.661)     (0.773)    (0.794)      (0.889)     (0.914)
                                           3.959      6.657       5.943       4.601       3.803
Student is female       No     16941
                                          (0.662)     (0.863)    (0.938)      (0.861)     (0.875)
                                           4.843       5.350      3.626        2.659       3.080
                        Yes    18720
                                          (0.870)     (0.842)    (0.634)      (0.684)     (0.631)
                                           4.872       5.906      4.088        3.342       3.232
Student works           No     10898
                                          (0.636)     (0.874)    (0.713)      (0.682)     (0.629)
                                           3.313       6.265      5.550        4.865       3.983
                        Yes    15612
                                          (0.740)     (0.868)    (0.922)      (0.912)     (0.871)
Student earns                              4.117       5.467      4.025        2.337       2.331
                        No     15713
income                                    (0.724)     (0.990)    (0.800)      (0.733)     (0.747)
                                           4.386       6.864      4.773        4.136       3.515
                        Yes    10812
                                          (0.648)     (0.936)    (0.709)      (0.692)     (0.583)
Family is on welfare                       5.145       7.522      5.356        4.081       3.548
                        No     10216
  (Bolsa FamÃ­lia)                         (0.704)     (0.985)    (0.757)      (0.751)     (0.679)
                                           3.618       5.152      3.559        2.628       2.245
                        Yes    15334
                                          (0.787)     (0.894)    (0.900)      (0.869)     (0.884)
Notes: The ï¬rst four speciï¬caï¿½ons include 848 schools. The last two include 851 schools. Bootstrap
standard errors in parentheses, based on ï¬ve thousand replicaï¿½ons and clustered at the school level.




                                                                                                       67
